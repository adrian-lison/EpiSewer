[{"path":[]},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/CONTRIBUTING.html","id":"r-files","dir":"","previous_headings":"Project organization","what":"R files","title":"Contributing","text":"R code files one three prefixes: model_: Code modeling module sewer_: Model-specific functions information utils_: General utility code, specific modeling","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 EpiSewer authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/detailed-example.html","id":"loading-the-package","dir":"Articles","previous_headings":"","what":"Loading the package","title":"Detailed example","text":"assume EpiSewer already successfully installed (see README: installing package).","code":"library(EpiSewer) library(data.table) library(ggplot2)"},{"path":"https://adrian-lison.github.io/EpiSewer/articles/detailed-example.html","id":"data","dir":"Articles","previous_headings":"","what":"Data","title":"Detailed example","text":"wastewater data Zurich, Switzerland, provided EAWAG (Swiss Federal Institute Aquatic Science Technology). introductory example, keep measurements made Mondays Thursdays test EpiSewer sparse data.","code":"data_zurich <- SARS_CoV_2_Zurich measurements_sparse <- data_zurich$measurements[,weekday := weekdays(data_zurich$measurements$date)][weekday %in% c(\"Monday\",\"Thursday\"),] head(measurements_sparse, 10) #>           date concentration  weekday #>         <Date>         <num>   <char> #>  1: 2022-01-03      455.7580   Monday #>  2: 2022-01-06      330.7298 Thursday #>  3: 2022-01-10      387.6885   Monday #>  4: 2022-01-13      791.1111 Thursday #>  5: 2022-01-17      551.7701   Monday #>  6: 2022-01-20      643.9910 Thursday #>  7: 2022-01-24      741.9150   Monday #>  8: 2022-01-27      770.1810 Thursday #>  9: 2022-01-31      627.1725   Monday #> 10: 2022-02-03      561.2913 Thursday"},{"path":"https://adrian-lison.github.io/EpiSewer/articles/detailed-example.html","id":"modeling","dir":"Articles","previous_headings":"","what":"Modeling","title":"Detailed example","text":"README, used shortcut collect observation data via sewer_data() assumptions via sewer_assumptions(). convenience functions make EpiSewer command concise. example however, explicitly supply data assumptions relevant modules components (see vignette(\"model-specification\") vignette).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/detailed-example.html","id":"measurements","dir":"Articles","previous_headings":"Modeling","what":"Measurements","title":"Detailed example","text":"start first module, observed measurements. module can specified follows: see, module defined using model_measurements() function. arguments function represent different module components. case, : concentrations component: defines pathogen concentrations wastewater noise component: defines measurement noise LOD component: defines limit detection wastewater samples used specific modeling function components. suffix function explains modeled: concentrations_observe: concentrations modeled observation data model can fitted. noise_estimate: degree measurement noise estimated data. LOD_none: model limit detection. also means zero measurements dropped. can also print module object see modeled: ‚ùó Note modeling functions arguments, EpiSewer use default settings specified. example, set custom prior measurement noise follows: ‚û°Ô∏è find options available given modeling function, check function documentation. move next module, remember can multiple modeling options component, EpiSewer offers one modeling function option. see available options, can use component_functions(): example, assume limit detection 2.56 gc/mL (based lab experiment EAWAG, lowest concentration still 95% replicates positive) follows: measurements based digital PCR (dPCR), can also model LOD explicit model dPCR noise. Note also adapt noise component accordingly.","code":"ww_measurements <- model_measurements(   concentrations = concentrations_observe(measurements = measurements_sparse),   noise = noise_estimate(),   LOD = LOD_none() ) ww_measurements #> measurements #>  |- concentrations_observe #>  |- noise_estimate #>  |- LOD_none ww_measurements2 <- model_measurements(   concentrations = concentrations_observe(measurements = measurements_sparse),   noise = noise_estimate(cv_prior_mu = 0.5, cv_prior_sigma = 0.1), # prior on coefficient of variation   LOD = LOD_none() ) component_functions(\"LOD\") #> [1] \"LOD_none()\"          \"LOD_assume()\"        \"LOD_estimate_dPCR()\" ww_measurements3 <- model_measurements(   concentrations = concentrations_observe(measurements = measurements_sparse),   noise = noise_estimate(cv_prior_mu = 0.5, cv_prior_sigma = 0.1), # prior on coefficient of variation   LOD = LOD_assume(limit = 2.56, prob = 0.95) ) ww_measurements4 <- model_measurements(   concentrations = concentrations_observe(measurements = measurements_sparse),   noise = noise_estimate_dPCR(), # also model dPCR noise   LOD = LOD_estimate_dPCR() )"},{"path":"https://adrian-lison.github.io/EpiSewer/articles/detailed-example.html","id":"sampling","dir":"Articles","previous_headings":"Modeling","what":"Sampling","title":"Detailed example","text":"Next sampling module. models process sampling wastewater: sampling module currently one component, allows model effects sample characteristics (like time sampling processing, can lead degradation) detectable pathogen concentrations. simple example, model effects.","code":"ww_sampling <- model_sampling(   sample_effects = sample_effects_none() )"},{"path":"https://adrian-lison.github.io/EpiSewer/articles/detailed-example.html","id":"sewage","dir":"Articles","previous_headings":"Modeling","what":"Sewage","title":"Detailed example","text":"sewage module describes aspects sewage system: includes two components: flows: Daily flow volumes sampling site. use measured flows treatment plant Zurich, specified using flows_observe(). residence_dist: Sewer residence time distribution pathogen particles. large sewage systems, particles may travel longer day depending shed wastewater. component allows model corresponding delay distribution. use modeling function residence_dist_assume() indicate make assumption residence time. case, assume particles arrive sampling site within day (indicated vector c(1), puts 100% probability residence time 0 days).","code":"ww_sewage <- model_sewage(   flows = flows_observe(flows = data_zurich$flows),   residence_dist = residence_dist_assume(residence_dist = c(1)) )"},{"path":"https://adrian-lison.github.io/EpiSewer/articles/detailed-example.html","id":"shedding","dir":"Articles","previous_headings":"Modeling","what":"Shedding","title":"Detailed example","text":"shedding module describes infected individuals shed pathogen particles wastewater: shedding module requires number assumptions (see explanations README): shedding_dist incubation_dist: use shedding load distribution (days since symptom onset) . also need assume incubation period distribution. load_per_case: load per case assumption calibrated based observed case data. README, supplied case data via sewer_data(). , now supply directly load_per_case_calibrate(). load_variation: EpiSewer offers option model individual-level variation shedding, recommended default.","code":"ww_shedding <- model_shedding(   shedding_dist = shedding_dist_assume(     get_discrete_gamma(gamma_shape = 0.929639, gamma_scale = 7.241397), shedding_reference = \"symptom_onset\"),   incubation_dist = incubation_dist_assume(get_discrete_gamma(gamma_shape = 8.5, gamma_scale = 0.4)),   load_per_case = load_per_case_calibrate(cases = data_zurich$cases),   load_variation = load_variation_estimate() )"},{"path":"https://adrian-lison.github.io/EpiSewer/articles/detailed-example.html","id":"infections","dir":"Articles","previous_headings":"Modeling","what":"Infections","title":"Detailed example","text":"infections module describes underlying process leading infected individuals: module following epidemiological components: generation_dist: use generation time distribution . R: effective reproduction number, main parameter interest. estimate via smoothing B-splines (R_estimate_splines()), smoothing approaches available (see component_functions(\"R\")). seeding: renewal model used EpiSewer requires seeding phase reproduction number modeled. thus let initial infections estimated using simple geometric random walk model. infection_noise: also model noise infection process, meaning EpiSewer fit stochastic infection model. makes sense cases.","code":"ww_infections <- model_infections(   generation_dist = generation_dist_assume(get_discrete_gamma_shifted(gamma_mean = 3, gamma_sd = 2.4)),   R = R_estimate_splines(),   seeding = seeding_estimate_rw(),   infection_noise = infection_noise_estimate() )"},{"path":"https://adrian-lison.github.io/EpiSewer/articles/detailed-example.html","id":"forecast","dir":"Articles","previous_headings":"Modeling","what":"Forecast","title":"Detailed example","text":"Last least, forecast module. module describes generative model defined modules used produce forecasts Rt, infections, concentrations quantities. default, README example, produce forecasts effectively setting forecast horizon zero. want produce forecasts, can define forecast horizon (e.g.¬†7 days) follows: forecast module currently single component define forecast horizon. future, may extended allow users customize forecasts obtained.","code":"ww_forecast <- model_forecast(   horizon = horizon_none() ) ww_forecast2 <- model_forecast(   horizon = horizon_assume(horizon = 7) )"},{"path":"https://adrian-lison.github.io/EpiSewer/articles/detailed-example.html","id":"side-notes","dir":"Articles","previous_headings":"Modeling","what":"Side notes","title":"Detailed example","text":"now specified six EpiSewer modules. seems like lot code, note majority component specifications optional sensible defaults. practice, need explicitly write components need certain assumptions want customize. present example, also (unnecessarily) specified EpiSewer defaults. example, infections module described simply written R, seeding, infection_noise component used defaults. default given generation time distribution, since pathogen-specific. üí° advantage coding component explicitly modeling decisions clearly documented.","code":"ww_infections <- model_infections(   generation_dist = generation_dist_assume(get_discrete_gamma_shifted(gamma_mean = 3, gamma_sd = 2.4)) )"},{"path":"https://adrian-lison.github.io/EpiSewer/articles/detailed-example.html","id":"settings","dir":"Articles","previous_headings":"","what":"Settings","title":"Detailed example","text":"starting estimation, let‚Äôs quick look settings model fitting post-processing. fit_opts settings describe model fitted. first argument, model tells EpiSewer find stan files model code. default EpiSewer package , can also tweak setting provide customized model files (see model_stan_opts() details). sampler argument specifies sampling algorithm used model fitting. Currently, sampling via stan‚Äôs MCMC algorithm supported. function sampler_stan_mcmc() allows pass various arguments stan, including number chains, iterations, much . results_opts argument specifies results return model fitting. specify fitted=TRUE, means whole fitted model object stored. Setting fitted=FALSE saves memory - certain things like detailed diagnostics extracting draws additional parameters possible. also specify parameters interest summarized 50% 95% credible intervals (addition mean median). Moreover, want explicitly store 50 posterior samples Rt infections time series (useful spaghetti plots etc.).","code":"ww_fit_opts <- set_fit_opts(   model = model_stan_opts(package = \"EpiSewer\"),   sampler = sampler_stan_mcmc(     iter_warmup = 500,     iter_sampling = 500,     chains = 4,     parallel_chains = 4, # run all chains in parallel     seed = 42   ) ) ww_results_opts <- set_results_opts(   fitted = TRUE,   summary_intervals = c(0.5, 0.95),   samples_ndraws = 50 )"},{"path":"https://adrian-lison.github.io/EpiSewer/articles/detailed-example.html","id":"estimation","dir":"Articles","previous_headings":"","what":"Estimation","title":"Detailed example","text":"Now everything need. fit model, simply pass EpiSewer modules settings defined EpiSewer() function. Note time don‚Äôt need data assumptions argument, provided data assumptions respective module components. model identical default model fitted README, don‚Äôt repeat results . Remember can print summary full modeling details job object:","code":"ww_result <- EpiSewer(   measurements = ww_measurements,   sampling = ww_sampling,   sewage = ww_sewage,   shedding = ww_shedding,   infections = ww_infections,   forecast = ww_forecast,   fit_opts = ww_fit_opts,   results_opts = ww_results_opts ) ww_result$job$model #> measurements #>  |- concentrations_observe #>  |- noise_estimate #>  |- LOD_none #>  #> sampling #>  |- sample_effects_none #>  #> sewage #>  |- flows_observe #>  |- residence_dist_assume #>  #> shedding #>  |- incubation_dist_assume #>  |- shedding_dist_assume #>  |- load_per_case_calibrate #>  |- load_variation_estimate #>  #> infections #>  |- generation_dist_assume #>  |- R_estimate_splines #>  |- seeding_estimate_rw #>  |- infection_noise_estimate (overdispersion = TRUE)"},{"path":"https://adrian-lison.github.io/EpiSewer/articles/detailed-example.html","id":"full-model","dir":"Articles","previous_headings":"","what":"Full model","title":"Detailed example","text":"convenience, provide full model using explicit component specifications one code block. can serve starting point adapt specification try different modeling options (check function documentation module functions, try component_functions() helper). Also, don‚Äôt forget modeling functions arguments customize priors modeling details. always, function documentation friend!","code":"measurements_sparse <- data_zurich$measurements[   , weekday := weekdays(data_zurich$measurements$date)   ][weekday %in% c(\"Monday\",\"Thursday\"),]  ww_measurements <- model_measurements(   concentrations = concentrations_observe(measurements = measurements_sparse),   noise = noise_estimate(),   LOD = LOD_none() )  ww_sampling <- model_sampling(   sample_effects = sample_effects_none() )  ww_sewage <- model_sewage(   flows = flows_observe(flows = data_zurich$flows),   residence_dist = residence_dist_assume(residence_dist = c(1)) )  ww_shedding <- model_shedding(   shedding_dist = shedding_dist_assume(get_discrete_gamma(gamma_shape = 0.929639, gamma_scale = 7.241397), shedding_reference = \"symptom_onset\"),   incubation_dist = incubation_dist_assume(get_discrete_gamma(gamma_shape = 8.5, gamma_scale = 0.4)),   load_per_case = load_per_case_calibrate(cases = data_zurich$cases),   load_variation = load_variation_estimate() )  ww_infections <- model_infections(   generation_dist = generation_dist_assume(get_discrete_gamma_shifted(gamma_mean = 3, gamma_sd = 2.4)),   R = R_estimate_splines(),   seeding = seeding_estimate_rw(),   infection_noise = infection_noise_estimate() )  ww_forecast <- model_forecast(   horizon = horizon_none() )  ww_fit_opts <- set_fit_opts(   model = model_stan_opts(package = \"EpiSewer\"),   sampler = sampler_stan_mcmc(     iter_warmup = 500,     iter_sampling = 500,     chains = 4,     parallel_chains = 4, # run all chains in parallel     seed = 42   ) )  ww_results_opts <- set_results_opts(   fitted = TRUE,   summary_intervals = c(0.5, 0.95),   samples_ndraws = 50 )  ww_result <- EpiSewer(   measurements = ww_measurements,   sampling = ww_sampling,   sewage = ww_sewage,   shedding = ww_shedding,   infections = ww_infections,   forecast = ww_forecast,   fit_opts = ww_fit_opts,   results_opts = ww_results_opts )"},{"path":"https://adrian-lison.github.io/EpiSewer/articles/load_per_case.html","id":"disclaimer-on-interpretation-of-estimated-infections","dir":"Articles","previous_headings":"","what":"Disclaimer on interpretation of estimated infections","title":"The ","text":"One important aspect keep mind interpreting number infections modeled EpiSewer modeling wastewater data, reference population infection dynamics often clear: population catchment identical population relevant infection process. example, catchment area sampled treatment plant covers certain region city, population relevant shedding might subset overall population relevant transmissions occur. population catchment may also vary time due every-day mobility special events. probably applies even catchments covering whole city sufficient mixing populations cities. Ultimately, means population modeled infection process might substantially larger catchment population. EpiSewer currently specific functionality represent difference (although planned future versions). also another reason number infections interpreted terms true absolute incidence prevalence (addition fact ultimately depends assumed load per case, difficult specify correctly).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/load_per_case.html","id":"calibration-to-minimum-number-of-infections","dir":"Articles","previous_headings":"","what":"Calibration to minimum number of infections","title":"The ","text":"default, EpiSewer calibrate load per case estimated number infections go considerably 10 infections per day. robust conservative default sense likely underestimates true number infections (see considerations ) - turns means uncertainty epidemiological parameters potentially large, small. can adapt default min_cases argument sewer_assumptions(): using load_per_case_calibrate() function: ‚ùó Note default deliberately min_cases=1. continuous approximations used stochastic infection model EpiSewer start break infections numbers become extremely small. can affect sampling speed accuracy estimates. Aside , also rather unlikely catchments detect genetic material pathogen shed single individual whole catchment.","code":"ww_assumptions <- sewer_assumptions(   min_cases = 30   # add further assumptions here ) load_per_case_calibrate(min_cases = 30) ## shedding ##  |- load_per_case_calibrate"},{"path":"https://adrian-lison.github.io/EpiSewer/articles/load_per_case.html","id":"calibration-to-case-data","dir":"Articles","previous_headings":"","what":"Calibration to case data","title":"The ","text":"also case data available, can provide EpiSewer via using load_per_case_calibrate() function: calibrate shedding load per case estimated number infections roughly matches observed number cases. want check manually, can use function suggest_load_per_case(). argument ascertainment_prop can used account underdetection infections. simplicity, assume ascertainment_prop=1, meaning 100% infections become confirmed cases (often realistic).","code":"ww_data <- sewer_data(   cases = SARS_CoV_2_Zurich$cases   # add further data here   ) load_per_case_calibrate(cases = SARS_CoV_2_Zurich$cases) ## shedding ##  |- load_per_case_calibrate suggest_load_per_case(   SARS_CoV_2_Zurich$measurements,   SARS_CoV_2_Zurich$cases,   SARS_CoV_2_Zurich$flows,   ascertainment_prop = 1 ) ## [1] 1.3e+11"},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"reproduction-number","dir":"Articles","previous_headings":"Infections module","what":"Reproduction number","title":"Model definition","text":"Variable: RtR_t","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"link-function","dir":"Articles","previous_headings":"Infections module > Reproduction number","what":"Link function","title":"Model definition","text":"model employs link function ensure Rt>0R_t>0 regardless smoothing approach used. obvious choice log link, however disadvantage implies asymmetric prior changes RtR_t (example, change Rt=2R_t=2 Rt=1R_t=1 much likely change Rt=1R_t=1 Rt=2R_t=2). EpiSewer therefore provides alternative link functions configured behave approximately like identity function around Rt=1R_t=1 ensure Rt>0R_t>0.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"option-1-inverse-softplus","dir":"Articles","previous_headings":"Infections module > Reproduction number > Link function","what":"Option 1: Inverse softplus","title":"Model definition","text":"link‚àí1(x)=softplusk(x)=log(1+ekx)k\\begin{equation} \\text{link}^{-1}(x) = \\text{softplus}_k(x) = \\frac{\\log(1+e^{kx})}{k} \\end{equation} sharpness parameter kk. default, choose k=4k=4, makes softplus function behave effectively like f(x)=xf(x)=x practically relevant values RtR_t ensuring Rt>0R_t>0.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"option-2-scaled-logit","dir":"Articles","previous_headings":"Infections module > Reproduction number > Link function","what":"Option 2: Scaled logit","title":"Model definition","text":"link‚àí1(x)=logisticc,,k(x)=c1+ae‚àíkx\\begin{equation} \\text{link}^{-1}(x) = \\text{logistic}_{c, , k}(x) = \\frac{c}{1 + \\, e^{-k \\, x}} \\end{equation} hyperparameters cc, aa, kk. , cc defines maximum possible RtR_t (default Rmax=6R_\\max=6). link function inspired epidemia package1, two hyperparameters aa kk, chosen logistic function equals 1 x=1x=1 also derivative 1. Thus, link function behaves roughly like identity f(x)=xf(x)=x around Rt=1R_t=1, makes definition adequate smoothing priors RtR_t easier.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"smoothing","dir":"Articles","previous_headings":"Infections module > Reproduction number","what":"Smoothing","title":"Model definition","text":"RtR_t modeled via time series smoothing spline prior ensure smoothness temporal autocorrelation RtR_t estimates.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"option-1-random-walk","dir":"Articles","previous_headings":"Infections module > Reproduction number > Smoothing","what":"Option 1: Random walk","title":"Model definition","text":"link(Rt)|Rt‚àí1‚àºN(link(Rt‚àí1),œÉlink(R)2)\\begin{equation} \\text{link}(R_t)\\,|\\,R_{t-1} \\sim N(\\text{link}(R_{t-1}),{\\sigma_{\\text{link}(R)}}^2) \\end{equation} normal prior intercept R1R_1 zero-truncated normal prior standard deviation œÉlink(R)\\sigma_{\\text{link}(R)} random walk.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"option-2-exponential-smoothing","dir":"Articles","previous_headings":"Infections module > Reproduction number > Smoothing","what":"Option 2: Exponential smoothing","title":"Model definition","text":"option uses innovations state space model additive errors implement exponential smoothing prior (Holt‚Äôs linear trend method dampening)2. , RtR_t modeled recursively link(Rt)=lt‚àí1+œï‚Ä≤bt‚àí1+œµtlt=lt‚àí1+œï‚Ä≤bt‚àí1+Œ±‚Ä≤œµtbt=œï‚Ä≤bt‚àí1+Œ≤‚Ä≤œµtœµt‚àºN(0,œÉlink(R)2),\\begin{align*}     \\text{link}(R_t) &= l_{t-1} + \\phi' \\, b_{t-1} + \\epsilon_t \\\\     l_t &= l_{t-1} + \\phi' \\, b_{t-1} + \\alpha' \\, \\epsilon_t \\\\     b_t &= \\phi' \\, b_{t-1} + \\beta' \\, \\epsilon_t \\\\     \\epsilon_t &\\sim N(0,{\\sigma_{\\text{link}(R)}}^2), \\end{align*} ltl_t level, btb_t trend, œµt\\epsilon_t additive error time tt, respectively. Moreover, Œ±‚Ä≤\\alpha' level smoothing parameter, Œ≤‚Ä≤\\beta' trend smoothing parameter, œï‚Ä≤\\phi' dampening parameter. use normal priors intercepts level l1l_1 trend b1b_1, zero-truncated normal prior variance œÉlink(R)2{\\sigma_{\\text{link}(R)}}^2 innovations, allowing estimated data. use Beta priors smoothing parameters Œ±‚Ä≤\\alpha' Œ≤‚Ä≤\\beta'. theory, dampening parameter œï‚Ä≤\\phi' can also estimated data, usually fixed due identifiability issues. default œï‚Ä≤=0.9\\phi'=0.9, .e.¬†strength trend assumed halve approximately every week predicting future.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"option-3-penalized-b-splines","dir":"Articles","previous_headings":"Infections module > Reproduction number > Smoothing","what":"Option 3: Penalized B-splines","title":"Model definition","text":"link(Rt)=ùêÅ[t,]\\begin{equation} \\text{link}(R_t) = \\boldsymbol{B}_{[t,\\,]} \\,  \\end{equation} ùêÅ[t,]\\boldsymbol{B}_{[t,\\,]} (default cubic) B-spline basis evaluated date index tt, =(a1,a2,‚Ä¶,adf)= (a_1, a_2, \\dots, a_\\text{df}) vector spline coefficients, df=number knots+spline degree\\text{df} = \\text{number knots} + \\text{spline degree} degrees freedom. use penalized B-splines, implemented regularizing spline coefficients via random walk3, .e. ai|ai‚àí1‚àºN(ai‚àí1,œÉa2Œ¥i)\\begin{equation} a_{}\\,|\\,a_{-1} \\sim N(a_{-1}, \\sigma_{}^2 \\, \\delta_i) \\end{equation} random walk variance œÉa2\\sigma_{}^2 scaled Œ¥i\\delta_i, distance knot ii knot ‚àí1i-1. allows provide (zero-truncated normal) prior œÉa\\sigma_{} independent distance knots. enforcing smoothness spline coefficients, risk overfitting splines greatly reduced. intercept a1a_1, normal prior reflecting expectation RtR_t beginning time series used. Knots placed uniformly according user-specified knot distance, however knot distance heuristically reduced dates close present (partially informed data) avoid erroneous extrapolation.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"infections","dir":"Articles","previous_headings":"Infections module","what":"Infections","title":"Model definition","text":"EpiSewer uses stochastic renewal model described earlier work45 model expected realized infections.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"expected-infections","dir":"Articles","previous_headings":"Infections module > Infections","what":"Expected infections","title":"Model definition","text":"Variable: Œπt\\iota_t","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"seeding","dir":"Articles","previous_headings":"Infections module > Infections > Expected infections","what":"Seeding","title":"Model definition","text":"require seeding phase start modeled time period, renewal model applied yet. use random walk log scale model expected number initial infections. log(Œπt)|Œπt‚àí1‚àºN(log(Œπt‚àí1),œÉlog(Œπ)2)|t‚â§G\\begin{equation} \\log(\\iota_t)|\\iota_{t-1} \\sim N(\\log(\\iota_{t-1}),{\\sigma_{\\log(\\iota)}}^2) \\,|\\, t \\leq G \\end{equation} normal prior intercept log(Œπ1)\\log(\\iota_1) zero-truncated normal prior standard deviation œÉlog(Œπ)\\sigma_{\\log(\\iota)} random walk.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"renewal-model","dir":"Articles","previous_headings":"Infections module > Infections > Expected infections","what":"Renewal model","title":"Model definition","text":"Œπt=E[]=Rt‚àës=1GœÑsgenIt‚àís|t>G\\begin{equation} \\iota_t = E[I_t] = R_t \\sum_{s=1}^G \\tau^\\text{gen}_s \\, I_{t-s} \\,|\\, t > G \\end{equation} ‚àísI_{t-s} number realized infections occurred ss days tt, œÑgen=(œÑ1gen,œÑ2gen,‚Ä¶,œÑGgen)\\tau^\\text{gen} = (\\tau^\\text{gen}_1, \\tau^\\text{gen}_2, \\dots, \\tau^\\text{gen}_G) discrete generation time distribution maximum generation time GG.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"realized-infections","dir":"Articles","previous_headings":"Infections module > Infections","what":"Realized infections","title":"Model definition","text":"Variable: ItI_t","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"option-1-poisson","dir":"Articles","previous_headings":"Infections module > Infections > Realized infections","what":"Option 1: Poisson","title":"Model definition","text":"|Œπt‚àºPoisson(Œπt)\\begin{equation} I_t|\\iota_t \\sim \\text{Poisson}(\\iota_t) \\end{equation} expected infections Œπt\\iota_t. stan implementation, approximated |Œπt‚àºN(Œπt,Œπt)I_t|\\iota_t \\sim N\\left(\\iota_t, \\iota_t\\right)","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"option-2-negative-binomial","dir":"Articles","previous_headings":"Infections module > Infections > Realized infections","what":"Option 2: Negative binomial","title":"Model definition","text":"|Œπt‚àºNegative binomial(Œº=Œπt,œÉ2=Œπt+Œπt2œï)\\begin{equation} I_t|\\iota_t \\sim \\text{Negative binomial}(\\mu = \\iota_t, \\sigma^2 = \\iota_t + \\frac{\\iota_t^2}{\\phi}) \\end{equation} expected infections Œπt\\iota_t inverse overdispersion parameter œï\\phi . Following 6, place zero-truncated normal prior œï\\phi Œæ=1œï\\xi = \\frac{1}{\\sqrt{\\phi}}. stan implementation, approximated |Œπt‚àºN(Œπt,Œπt+Œπt2œï)I_t|\\iota_t \\sim N\\left(\\iota_t, \\iota_t + \\frac{\\iota_t^2}{\\phi}\\right)","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"expected-symptom-onsets","dir":"Articles","previous_headings":"Shedding module","what":"Expected symptom onsets","title":"Model definition","text":"Variable: Œªt\\lambda_t Œªt=‚àës=0LIt‚àísœÑsinc\\begin{equation} \\lambda_t = \\sum_{s=0}^L I_{t-s}\\, \\tau^\\text{inc}_s \\end{equation} œÑinc=(œÑ0inc,œÑ1inc,‚Ä¶,œÑLinc)\\tau^\\text{inc} = (\\tau^\\text{inc}_0, \\tau^\\text{inc}_1, \\dots, \\tau^\\text{inc}_L) incubation period distribution maximum incubation period LL.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"total-load-shed-in-catchment","dir":"Articles","previous_headings":"Shedding module","what":"Total load shed in catchment","title":"Model definition","text":"Variable: œât\\omega_t","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"option-1-without-individual-level-variation","dir":"Articles","previous_headings":"Shedding module > Total load shed in catchment","what":"Option 1: Without individual-level variation","title":"Model definition","text":"œât=‚àës=0SŒªt‚àísŒºloadœÑsshed\\begin{equation} \\omega_t = \\sum_{s=0}^S \\lambda_{t-s}\\, \\mu^\\text{load}\\, \\tau^\\text{shed}_s \\end{equation} Œªt\\lambda_{t} expected number individuals symptom onset day tt, Œºload\\mu^\\text{load} average total shedding load per person, œÑshed=(œÑ0shed,œÑ1shed,‚Ä¶,œÑSshed)\\tau^\\text{shed} = (\\tau^\\text{shed}_0, \\tau^\\text{shed}_1, \\dots, \\tau^\\text{shed}_S) distribution shedding time, shedding SS days symptom onset.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"option-2-with-individual-level-variation","dir":"Articles","previous_headings":"Shedding module > Total load shed in catchment","what":"Option 2: With individual-level variation","title":"Model definition","text":"œât=‚àës=0SŒ∂t‚àísŒºloadœÑsshed\\begin{equation} \\omega_t = \\sum_{s=0}^S \\zeta_{t-s}\\, \\mu^\\text{load}\\, \\tau^\\text{shed}_s \\end{equation} (Œºload)(\\mu^\\text{load}) average total shedding load per person (œÑshed=(œÑ0shed,œÑ1shed,‚Ä¶,œÑSshed))(\\tau^\\text{shed} = (\\tau^\\text{shed}_0, \\tau^\\text{shed}_1, \\dots, \\tau^\\text{shed}_S)) distribution shedding time, shedding SS days symptom onset. now multiplied Œ∂t\\zeta_t, defined sum ..d. Gamma distributed individual relative shedding intensities mean 11 coefficient variation ŒΩŒ∂\\nu_\\zeta: Œ∂t‚àº‚àë=1ŒõtGamma(mean=1,cv=ŒΩŒ∂)=Gamma(Œ±=ŒõtŒΩŒ∂2,Œ≤=1ŒΩŒ∂2)\\begin{equation} \\zeta_t \\sim \\sum_{=1}^{\\Lambda_t} \\, \\text{Gamma}(\\text{mean} = 1, \\text{cv} = \\nu_\\zeta) = \\text{Gamma}(\\alpha = \\frac{\\Lambda_t}{\\nu_\\zeta^2}, \\beta = \\frac{1}{\\nu_\\zeta^2}) \\end{equation} Œõt\\Lambda_t realized number symptom onsets. , Œ∂t\\zeta_t describes number individuals symptom onset day tt, weighted shedding intensity, intensity <1<1 indicates -average shedding, intensity >1>1 indicates -average shedding. coefficient variation ŒΩŒ∂\\nu_\\zeta describes much shedding intensity varies individuals. approximate Œõt\\Lambda_t expectation Œªt=E[Œõt]\\lambda_t = E[\\Lambda_t], .e. Œ∂t‚àºGamma(Œ±=ŒªtŒΩŒ∂2,Œ≤=1ŒºloadŒΩŒ∂2),\\begin{equation} \\zeta_t \\sim \\text{Gamma}(\\alpha = \\frac{\\lambda_t}{\\nu_\\zeta^2}, \\beta = \\frac{1}{\\mu^\\text{load} \\nu_\\zeta^2}), \\end{equation} place zero-truncated normal prior ŒΩŒ∂\\nu_\\zeta. stan implementation, use normal approximation Gamma distribution Œ∂t\\zeta_t improve sampling efficiency. approximation highly accurate sufficiently large Œªt\\lambda_t, typically case.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"load-at-sampling-site","dir":"Articles","previous_headings":"Sewage module","what":"Load at sampling site","title":"Model definition","text":"Variable: œÄt\\pi_t œÄt=‚àëd=0Dœât‚àídœÑdres\\begin{equation} \\pi_t = \\sum_{d=0}^D \\omega_{t-d}\\, \\tau^\\text{res}_d \\end{equation} (œÑres=(œÑ0res,œÑ1res,‚Ä¶,œÑDres))(\\tau^\\text{res} = (\\tau^\\text{res}_0, \\tau^\\text{res}_1, \\dots, \\tau^\\text{res}_D)) sewer residence time distribution pathogen particles.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"concentration-at-sampling-site","dir":"Articles","previous_headings":"Sewage module","what":"Concentration at sampling site","title":"Model definition","text":"Variable: œát\\chi_t œát=œÄtflowt\\begin{equation} \\chi_t = \\frac{\\pi_t}{\\text{flow}_t} \\end{equation} flowt\\text{flow}_t measure total wastewater volume upstream sampling site day tt.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"concentration-in-single-day-samples-with-sample-effects","dir":"Articles","previous_headings":"Sampling module","what":"Concentration in single-day samples, with sample effects","title":"Model definition","text":"Variable: Œ∫t\\kappa_t Œ∫t=œát+ùêóŒ∑\\begin{equation} \\kappa_t = \\chi_t + \\boldsymbol{X} \\, \\eta \\end{equation} ùêó\\boldsymbol{X} T√óKT \\times K design matrix KK different covariates describing characteristics samples days 1 TT, Œ∑=(Œ∑1,Œ∑2,‚Ä¶,Œ∑K)\\eta = (\\eta_1, \\eta_2, \\dots, \\eta_K) vector coefficients estimate association sample covariates concentration. place independent normal priors Œ∑1,Œ∑2,‚Ä¶,Œ∑K\\eta_1, \\eta_2, \\dots, \\eta_K. Note days samples taken, corresponding row design matrix ùêó\\boldsymbol{X} can filled arbitrary values, since contribute likelihood.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"concentration-in-multi-day-composite-samples","dir":"Articles","previous_headings":"Sampling module","what":"Concentration in multi-day composite samples","title":"Model definition","text":"Variable: œÅt\\rho_t œÅt=1w‚àë=0w‚àí1Œ∫t‚àí\\begin{equation} \\rho_t = \\frac{1}{w} \\sum_{=0}^{w-1} \\kappa_{t-} \\end{equation} ww composite window size, .e.¬†number consecutive single-day samples equivolumetrically mixed composite sample. , tt day latest sample.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"analysed-concentration-before-replication-stage","dir":"Articles","previous_headings":"Measurements module","what":"Analysed concentration before replication stage","title":"Model definition","text":"Variable: Œ®t\\Psi_t model Œ®t\\Psi_t Log-Normal distributed unit-scale mean œÅt\\rho_t (sample concentration) unit-scale coefficient variation ŒΩœà\\nu_\\psi, .e. Œ®t‚àºLog-Normal(ŒºŒ®,œÉŒ®2)\\begin{equation} \\Psi_t \\sim \\text{Log-Normal}\\left(\\mu_\\Psi,\\, \\sigma_\\Psi^2\\right) \\end{equation} ŒºŒ®=log(œÅt)‚àí12œÉŒ®2\\mu_\\Psi = \\log(\\rho_t) - \\frac{1}{2}\\sigma_\\Psi^2 location œÉŒ®2=log(1+ŒΩŒ®2)\\sigma_\\Psi^2 = \\log(1 + \\nu_\\Psi^2) scale Log-Normal distribution. , ŒΩœà\\nu_\\psi measures unexplained variation concentrations replication stage (example, replication stage PCR quantification, ŒΩœà\\nu_\\psi measures variation PCR). place zero-truncated normal prior ŒΩœà\\nu_\\psi.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"limit-of-detection-lod","dir":"Articles","previous_headings":"Measurements module","what":"Limit of detection (LOD)","title":"Model definition","text":"implement hurdle model limit detection, probability zero measurement described exponentially decreasing function underlying concentration, .e.¬† P(Œ•t,=0|Œ®t=œàt)=e‚àíœàtcb\\begin{equation} P(\\Upsilon_{t,} = 0 | \\Psi_t = \\psi_t) = e^{-\\psi_t\\, c\\, b} \\end{equation} Œ•t,\\Upsilon_{t,} ithi^{\\text{th}} replicate concentration measurement (composite) sample day tt, bb cc parameters PCR. PCR parameters either estimated coefficient variation model (see , may require informative priors /replicate measurements), product cbc\\, b can back-calculated user provides LOD value established lab experiment. functional form LOD model based statistical properties digital PCR corresponds binomial likelihood zero successes. non-zero measurements, conversely P(Œ•t,>0|Œ®t=œàt)=1‚àíP(Œ•t=0|Œ®t=œàt)\\begin{equation} P(\\Upsilon_{t,} > 0 | \\Psi_t = \\psi_t) = 1 - P(\\Upsilon_t = 0 | \\Psi_t = \\psi_t) \\end{equation}","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"measured-concentration","dir":"Articles","previous_headings":"Measurements module","what":"Measured concentration","title":"Model definition","text":"Variable: Œ•t\\Upsilon_t Non-zero concentration measurements modeled truncated normal distributed, .e. Œ•t,|Œ•t,>0‚àºNormal+(ŒºŒ•t,œÉŒ•t2)\\begin{equation} \\Upsilon_{t,} \\,|\\, \\Upsilon_{t,} > 0 \\, \\sim \\text{Normal}^+\\left(\\mu_{\\Upsilon_{t}},\\, \\sigma_{\\Upsilon_{t}}^2\\right) \\end{equation} Œ•t,\\Upsilon_{t,} ithi^{\\text{th}} replicate concentration measurement (composite) sample day tt. , ŒºŒ•t=œàt\\mu_{\\Upsilon_{t}} = \\psi_t mean œÉŒ•t2=ŒºŒ•tŒΩŒ•(ŒºŒ•t)\\sigma_{\\Upsilon_{t}}^2 = \\mu_{\\Upsilon_{t}}\\, \\nu_\\Upsilon(\\mu_{\\Upsilon_{t}}) standard deviation truncated Normal distribution. Note EpiSewer also offers Log-Normal likelihood alternative, however based properties dPCR assays, truncated Normal better approximation true distribution measurements. Specifically, ŒΩŒ•(Œº)\\nu_\\Upsilon(\\mu) coefficient variation replication stage modeled function expected concentration Œº\\mu: ŒΩŒ•(Œº)=1bexp(Œºc)‚Äì1Œºc1+a2bŒºc\\begin{equation} \\nu_\\Upsilon(\\mu) = \\frac{1}{\\sqrt{b}}\\, \\frac{\\sqrt{exp(\\mu\\, c) ‚Äì 1}}{\\mu\\, c}\\, \\sqrt{1 + ^2\\, b\\, \\mu\\, c} \\end{equation} aa, bb cc parameters estimated. functional form derived statistical properties binomial-distributed positive partition counts dPCR reaction, =ŒΩprea=\\nu_{\\text{pre}} represents coefficient variation noise concentration dPCR reaction, bb represents average number partitions PCR reaction, cc represents dPCR conversion factor, partition volume scaled dilution wastewater PCR reaction. factor converts wastewater concentration expected number gene copies per partition. Note dilution includes extraction preparation steps. example, partition volume 4.5e-7 mL dilution wastewater 100:3 (.e.¬†100 gc/mL original wastewater sample correspond 3 gc/mL PCR reaction), overall scaling factor 4.5e-7 * 100 / 3 = 1.5e-5. place zero-truncated normal priors aa, bb, cc, respectively. replicates modeled replication stage PCR quantification, ŒΩŒ•\\nu_\\Upsilon measures noise PCR ŒΩœà\\nu_\\psi noise. case, aa typically small. contrast, replicates modeled, ŒΩŒ•\\nu_\\Upsilon measures total variation ŒΩœà\\nu_\\psi estimated. case, aa larger.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"estimation","dir":"Articles","previous_headings":"","what":"Estimation","title":"Model definition","text":"EpiSewer directly fitted observed concentration measurements yt,iy_{t,} (t‚â§Tt \\leq T index sample date ii index replicate ntn_t replicates total date index tt). Using Markov Chain Monte Carlo (MCMC), draw samples joint posterior distribution RtR_t parameters P(R{t|t‚â§T},‚Ä¶|y{t|t‚â§T},{|‚â§nt})‚àùP(y{t|t‚â§T},{|‚â§nt}|R{t|t‚â§T},‚Ä¶)P(‚Ä¶),\\begin{equation} P\\left(R_{\\{t | t \\leq T\\}}, \\dots \\;\\middle|\\; y_{\\{t | t \\leq T\\},\\{| \\leq n_t\\}}\\right) \\propto P\\left(y_{\\{t | t \\leq T\\},\\{| \\leq n_t\\}} \\;\\middle|\\; R_{\\{t | t \\leq T\\}}, \\dots\\right) \\, P\\left(\\dots \\right), \\end{equation} P(y{t|t‚â§T},{|‚â§nt}|R{t|t‚â§T},‚Ä¶)P\\left(y_{\\{t | t \\leq T\\},\\{| \\leq n_t\\}} \\;\\middle|\\; R_{\\{t | t \\leq T\\}}, \\dots\\right) likelihood defined 5 modules generative model (infection, shedding, sewage, sampling, measurement), P(‚Ä¶)P\\left(\\dots \\right) represents priors non-hierarchical parameters model (e.g.¬†intercepts variances random walks). Note many variables generative model (including RtR_t!) fact transformations variables therefore count model parameters strict sense.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-definition.html","id":"indexing-of-time","dir":"Articles","previous_headings":"","what":"Indexing of time","title":"Model definition","text":"ease notation, used unified time index t‚àà{1,2,‚Ä¶,T}t \\\\{1, 2, \\dots, T\\} variables. reality, model Œ•t,\\Upsilon_{t,} t=1t=1, need model RtR_t many variables also earlier time points t<1t<1 due various delays infections observations. model implementation, variable therefore time index, indices mapped accordingly.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-specification.html","id":"modules","dir":"Articles","previous_headings":"","what":"Modules","title":"Modeling in EpiSewer","text":"EpiSewer uses 5 different modules describe data generating process behind wastewater measurements: infections, shedding, sewage, sampling, measurements. 6th module specify forecast functionality. modules consists number module components, shown .  modules defined using corresponding module function, .e.¬†calling model_infections(), model_shedding(), model_sewage(), model_sampling(), model_measurements(), model_forecast().","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-specification.html","id":"modeling-functions","dir":"Articles","previous_headings":"","what":"Modeling functions","title":"Modeling in EpiSewer","text":"Components module can specified using suitable modeling functions. 5 types modeling functions: _observe: provide observation data component. example, can use concentrations_observe() observed concentration measurements want fit model . _assume: assume values component. example, can use generation_dist_assume() provide generation time distribution literature. _calibrate: similar _assume, instead directly specifying value assumption, calibrate assumption data. example, can use load_per_case_calibrate() calibrate shedding load per case case data (estimated infections roughly match observed case numbers). _estimate: estimate component parameter model. example, can use noise_estimate() don‚Äôt know much noise measurements want estimate data. _none: model component. example, can use sample_effects_none() don‚Äôt want model sample effects measurements. find modeling functions available given component, can consult documentation use helper component_functions():","code":"EpiSewer::component_functions(\"infection_noise\") #> [1] \"infection_noise_none()\"     \"infection_noise_estimate()\""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-specification.html","id":"multiple-modeling-options","dir":"Articles","previous_headings":"Modeling functions","what":"üí° Multiple modeling options","title":"Modeling in EpiSewer","text":"components multiple versions modeling function type. example, currently three approaches estimate reproduction number, namely R_estimate_splines() (smoothing splines), R_estimate_rw() (random walk), R_estimate_ets() (exponential smoothing), R_estimate_approx() (approximation renewal model).","code":"EpiSewer::component_functions(\"R\") #> [1] \"R_estimate_approx()\"  \"R_estimate_splines()\" \"R_estimate_rw()\"      #> [4] \"R_estimate_ets()\""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-specification.html","id":"modeling-restrictions","dir":"Articles","previous_headings":"Modeling functions","what":"‚ùó Modeling restrictions","title":"Modeling in EpiSewer","text":"components support modeling types. example, EpiSewer currently offers generation_dist_assume(), generation_dist_estimate, generation_dist_calibrate, generation_dist_observe. estimating generation time distribution data yet supported (may added future).","code":"EpiSewer::component_functions(\"generation_dist\") #> [1] \"generation_dist_assume()\""},{"path":"https://adrian-lison.github.io/EpiSewer/articles/model-specification.html","id":"data-and-assumptions","dir":"Articles","previous_headings":"","what":"Data and assumptions","title":"Modeling in EpiSewer","text":"sewer_data() sewer_assumptions() functions convenience functions allow collect observation data modeling assumptions one place. can improve overview allows run EpiSewer default settings without repeating component definitions: happens hood individual model components provided data assumptions need, search data assumption arguments passed EpiSewer() function. üí° always possible mix approaches specify data assumptions explicitly model component: Note data assumptions supplied via sewer_data()/sewer_assumptions() individual component, EpiSewer() compare arguments throw error differ.","code":"ww_data <- sewer_data(   measurements = SARS_CoV_2_Zurich$measurements,   flows = SARS_CoV_2_Zurich$flows,   cases = SARS_CoV_2_Zurich$cases # optional   )  ww_assumptions <- sewer_assumptions(   generation_dist = get_discrete_gamma_shifted(gamma_mean = 3, gamma_sd = 2.4),   shedding_dist = get_discrete_gamma(gamma_shape = 0.929639, gamma_scale = 7.241397),   shedding_reference = \"symptom_onset\",   incubation_dist = get_discrete_gamma(gamma_shape = 8.5, gamma_scale = 0.4), )  EpiSewer(   data = ww_data,   assumptions = ww_assumptions ) # Leave out flows from the data ww_data <- sewer_data(   measurements = SARS_CoV_2_Zurich$measurements,   #flows = SARS_CoV_2_Zurich$flows   cases = SARS_CoV_2_Zurich$cases )  # Leave out the generation time distribution ww_assumptions <- sewer_assumptions(   #generation_dist = get_discrete_gamma_shifted(gamma_mean = 3, gamma_sd = 2.4),   shedding_dist = get_discrete_gamma(gamma_shape = 0.929639, gamma_scale = 7.241397),   shedding_reference = \"symptom_onset\",   incubation_dist = get_discrete_gamma(gamma_shape = 8.5, gamma_scale = 0.4), )  # Provide flows directly to sewage module ww_sewage <- model_sewage(   flows = flows_observe(SARS_CoV_2_Zurich$flows) )  # Provide generation time distribution directly to infections module ww_infections <- model_infections(   generation_dist = generation_dist_assume(     get_discrete_gamma_shifted(gamma_mean = 3, gamma_sd = 2.4)   ) )  # Combine everything result <- EpiSewer(   data = ww_data,   assumptions = ww_assumptions,   sewage = ww_sewage,   infections = ww_infections )"},{"path":"https://adrian-lison.github.io/EpiSewer/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Adrian Lison. Author, maintainer.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lison (2024). EpiSewer: Estimate Epidemiological Parameters Wastewater Measurements. R package version 0.0.2, https://github.com/adrian-lison/EpiSewer, https://adrian-lison.github.io/EpiSewer/.","code":"@Manual{,   title = {EpiSewer: Estimate Epidemiological Parameters from Wastewater Measurements},   author = {Adrian Lison},   year = {2024},   note = {R package version 0.0.2, https://github.com/adrian-lison/EpiSewer},   url = {https://adrian-lison.github.io/EpiSewer/}, }"},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"about","dir":"","previous_headings":"","what":"About","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"EpiSewer R package provides Bayesian generative model estimate effective reproduction numbers epidemiological parameters concentration measurements wastewater treatment plant (sampling site) time. allows track transmission dynamics pathogen associated catchment population. EpiSewer model tailored specifics wastewater concentration measurements, offers comprehensive uncertainty quantification via MCMC sampling stan, provides easily configurable modeling components.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"model-highlights","dir":"","previous_headings":"","what":"Model highlights","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"Measurements ‚≠ê Non-daily / missing measurements ‚≠ê Multiple measurements (replicates) per sample ‚≠ê Multi-day composite samples ‚≠ê Accurate dPCR noise model ‚≠ê Limit detection (LOD) model Sampling ‚≠ê Sample batch effects (e.g.¬†weekday age--sample effects) Sewer ‚≠ê Flow normalization ‚≠ê Sewer residence time distributions Shedding ‚≠ê Incubation period shedding load distributions ‚≠ê Individual-level shedding load variation Infections ‚≠ê Stochastic infection model overdispersion ‚≠ê Flexible RtR_t smoothing (random walk, exponential smoothing, splines) ‚≠ê Transmission indicators: RtR_t, growth rate, doubling time, Forecast ‚≠ê Probabilistic forecasts RtR_t, infections, concentrations ","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"installing-the-package","dir":"","previous_headings":"","what":"Installing the package","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"development version EpiSewer can installed GitHub shown . Please note package still early development may subject breaking changes. EpiSewer also requires CmdStan installed system. can done using install_cmdstan() function cmdstanr. experience problems installing CmdStan, see cmdstanr vignette help. stan models used EpiSewer need compiled device. necessary - installing updating package - can done using sewer_compile() function. models successfully compiled, please ensure cmdstan properly set try updating newer version using cmdstanr::install_cmdstan(). problem persists, please run EpiSewer::sewer_compile(verbose = TRUE) post output new issue GitHub, along cmdstanr::cmdstan_version().","code":"remotes::install_github(\"adrian-lison/EpiSewer\", dependencies = TRUE) cmdstanr::check_cmdstan_toolchain() cmdstanr::install_cmdstan(cores = 2) # use more cores to speed up EpiSewer::sewer_compile()"},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"introduction","dir":"","previous_headings":"","what":"Introduction","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"quick introduction using EpiSewer package. learn modeling EpiSewer, see model specification detailed example vignettes package website.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"loading-the-package","dir":"","previous_headings":"Introduction","what":"Loading the package","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"EpiSewer comes data.table data manipulation ggplot2 plotting.","code":"library(EpiSewer) library(data.table) library(ggplot2)"},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"data-requirements","dir":"","previous_headings":"Introduction > Data","what":"Data requirements","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"example wastewater data Zurich, Switzerland. Data provided EAWAG (Swiss Federal Institute Aquatic Science Technology) public domain (CC 4.0 license). measurements: EpiSewer requires time series concentration measurements. Measurements ideally gc/mL (gc = gene copies). flows: Data daily wastewater volume flowing sampling site (mL/day). Flow data highly recommended, strictly necessary (see documentation flows_assume()). cases: Data confirmed cases catchment area. optional can help informing prior assumptions.","code":"data_zurich <- SARS_CoV_2_Zurich names(data_zurich) #> [1] \"measurements\" \"flows\"        \"cases\"        \"units\""},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"measurements","dir":"","previous_headings":"Introduction > Data > Data requirements","what":"Measurements","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"measurements data contains daily viral concentration measurements (gc/mL) SARS-CoV-2 N1 gene wastewater treatment plant Zurich. days missing measurements, problem: EpiSewer naturally accounts missing values estimation. show handling missing data clearly, make data artificially sparse keeping measurements made Mondays Thursdays. means two measurements per week.","code":"data_zurich$measurements #>            date concentration #>   1: 2022-01-01            NA #>   2: 2022-01-02            NA #>   3: 2022-01-03      455.7580 #>   4: 2022-01-04      747.8792 #>   5: 2022-01-05      573.7020 #>  ---                          #> 116: 2022-04-26      182.3664 #> 117: 2022-04-27      379.2421 #> 118: 2022-04-28      439.7427 #> 119: 2022-04-29      394.0033 #> 120: 2022-04-30      293.1242 measurements_sparse <- data_zurich$measurements[,weekday := weekdays(data_zurich$measurements$date)][weekday %in% c(\"Monday\",\"Thursday\"),] head(measurements_sparse, 10) #>           date concentration  weekday #>  1: 2022-01-03      455.7580   Monday #>  2: 2022-01-06      330.7298 Thursday #>  3: 2022-01-10      387.6885   Monday #>  4: 2022-01-13      791.1111 Thursday #>  5: 2022-01-17      551.7701   Monday #>  6: 2022-01-20      643.9910 Thursday #>  7: 2022-01-24      741.9150   Monday #>  8: 2022-01-27      770.1810 Thursday #>  9: 2022-01-31      627.1725   Monday #> 10: 2022-02-03      561.2913 Thursday"},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"flows","dir":"","previous_headings":"Introduction > Data > Data requirements","what":"Flows","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"flows data tracks daily flow (mL/day) treatment plant Zurich. flow data used normalize concentration measurements. helps account environmental factors rainfall. important flow uses volume unit concentration (mL cases). ‚ùó Note: ‚Äôs problem flow data dates measurements. However, measured date, must also flow value. flow information missing measured dates, please make sure impute using suitable method passing EpiSewer (drop dates).","code":"data_zurich$flows #>            date        flow #>   1: 2022-01-01 3.41163e+11 #>   2: 2022-01-02 3.41163e+11 #>   3: 2022-01-03 1.58972e+11 #>   4: 2022-01-04 1.60849e+11 #>   5: 2022-01-05 3.72301e+11 #>  ---                        #> 116: 2022-04-26 3.30659e+11 #> 117: 2022-04-27 2.06046e+11 #> 118: 2022-04-28 1.58373e+11 #> 119: 2022-04-29 1.52156e+11 #> 120: 2022-04-30 2.08685e+11"},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"cases","dir":"","previous_headings":"Introduction > Data > Data requirements","what":"Cases","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"Finally, case data available, can also pass EpiSewer. used calibrate model estimated number infections approximately matches observed number cases. don‚Äôt case data: don‚Äôt worry! general, assumed shedding load per case large effect effective reproduction number, EpiSewer use robust default. just keep mind absolute number infections estimated EpiSewer interpreted true incidence prevalence.","code":"data_zurich$cases #>            date     cases #>   1: 2022-01-01        NA #>   2: 2022-01-02        NA #>   3: 2022-01-03 1519.5313 #>   4: 2022-01-04 1727.3722 #>   5: 2022-01-05 1638.5321 #>  ---                      #> 116: 2022-04-26  211.9338 #> 117: 2022-04-27  214.9822 #> 118: 2022-04-28  206.2498 #> 119: 2022-04-29  151.9567 #> 120: 2022-04-30  134.8545"},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"gather-the-data","dir":"","previous_headings":"Introduction > Data","what":"Gather the data","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"combine measurements data flow data using helper function sewer_data(). use artificially sparse measurements (Mondays Thursdays). calibration purposes, also supply case data, explained .","code":"ww_data <- sewer_data(   measurements = measurements_sparse,   flows = data_zurich$flows,   cases = data_zurich$cases # cases are optional   )"},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"assumptions","dir":"","previous_headings":"Introduction","what":"Assumptions","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"order estimate effective reproduction number wastewater concentration measurements, make number assumptions. Generation time distribution: Distribution time primary infection resulting secondary infections Shedding load distribution: Distribution load shed average individual time. also specify distribution relative day symptom onset. Incubation period distribution: shedding load distribution days since symptom onset, also need make assumption time infection symptom onset. generation time, shedding load incubation period distribution disease-specific typically obtained literature. EpiSewer requires distributions discretized, offers specific functions obtain discretized versions popular continuous probability distributions. üí° Sometimes, shedding load distributions instead specified days since infection. case, can use shedding_reference = \"infection\" don‚Äôt need supply incubation period distribution.","code":"ww_assumptions <- sewer_assumptions(   generation_dist = get_discrete_gamma_shifted(gamma_mean = 3, gamma_sd = 2.4),   shedding_dist = get_discrete_gamma(gamma_shape = 0.929639, gamma_scale = 7.241397),   shedding_reference = \"symptom_onset\", # shedding load distribution is relative to symptom onset   incubation_dist = get_discrete_gamma(gamma_shape = 8.5, gamma_scale = 0.4) )"},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"estimation","dir":"","previous_headings":"Introduction","what":"Estimation","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"Now data necessary assumptions, can use EpiSewer estimate effective reproduction number. use default model settings provided EpiSewer. helper function set_fit_opts() specify sampling approach: apply Hamiltonian MCMC sampling via stan, using 4 chains 500 warmup 500 sampling iterations . Stan regularly provides updates progress sampler. overall runtime depend hardware resources, size data, complexity model used, well model actually fits data. MacBook Pro (2 GHz Quad-Core Intel Core i5) example takes 5 minutes run. üí° using shorthand version EpiSewer() function uses available default settings. find EpiSewer model can customized, see model specification detailed example vignettes.","code":"options(mc.cores = 4) # allow stan to use 4 cores, i.e. one for each chain ww_result <- EpiSewer(   data = ww_data,   assumptions = ww_assumptions,   fit_opts = set_fit_opts(sampler = sampler_stan_mcmc(     iter_warmup = 500, iter_sampling = 500, chains = 4, seed = 42     )) )"},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"plotting-the-results","dir":"","previous_headings":"Introduction","what":"Plotting the results","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"Great, sampling completed! Now can inspect results model. Plots convenient way get quick overview.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"model-fit","dir":"","previous_headings":"Introduction > Plotting the results","what":"Model fit","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"good practice first assess well model actually fitted data. , plot observed concentration measurements ones predicted model. inner outer ribbons show 50% 95% credible intervals. black dots show measurements actually observed artificially sparse data set (Mondays Thursdays). grey crosses show measurements available model. can see, model still achieved decent fit missing days.  default, function plot_concentration() shows absolute concentrations, strongly depend daily wastewater flow. Alternatively, can plot flow-normalized concentration setting normalized = TRUE. show hypothetical concentration flow median value. option, need provide flow data well (see ). can seen, normalization removes noise due daily variation flow. remaining uncertainty due measurement noise sources variation.","code":"plot_concentration(ww_result, measurements = data_zurich$measurements) plot_concentration(ww_result, measurements = data_zurich$measurements, flows = data_zurich$flows, normalized = TRUE)"},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"time-varying-effective-reproduction-number","dir":"","previous_headings":"Introduction > Plotting the results","what":"Time-varying effective reproduction number","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"Since model fit looked decent first glance, now inspect main parameter interest, effective reproduction number time. , ribbons show 50% 95% credible intervals. see even two measurements per week, get fairly clear signal R critical threshold 1.  Note estimates R go back past observations. due delay infection shedding, .e. concentration measurements observed today mostly signal infections past. also R estimates close present strongly uncertain. measurements observed present provide delayed signal transmission dynamics, recent R estimates informed little data.","code":"plot_R(ww_result)"},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"growth-report","dir":"","previous_headings":"Introduction > Plotting the results","what":"Growth report","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"can also display growth report shows probability infections growing prolonged period time. default, EpiSewer selects recent date reliable estimates possible reference. model fitted end seasonal wave Zurich, high posterior support infections currently growing prolonged period time. can also display growth report dates. Let‚Äôs example look report mid-February 2022. can see strong posterior support infections growing least week. time, seems rather unlikely already growing 3 weeks longer.  üí° EpiSewer also provides indicators transmission dynamics, see e.g.¬†plot_growth_rate() plot_doubling_time(). can however volatile sometimes difficult interpret.","code":"plot_growth_report(ww_result) plot_growth_report(ww_result, date = \"2022-02-19\")"},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"latent-parameters","dir":"","previous_headings":"Introduction > Plotting the results","what":"Latent parameters","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"can also inspect internal parameters model. may give us better understanding model fit may help diagnose certain problems. First, plot estimated load time. expected total load arrived sampling side given day. can see roughly order 1e14 3e14. Next, plot estimated number infections time. time series follows similar trend load. Compared load, peak infections seems bit spiked, also bit earlier. infected individuals begin shedding infection shed longer period time (defined incubation period shedding load distribution). makes load slightly delayed blurred signal infections.  Note supplied case data, estimated infections rougly match case numbers (plotted blue ). Nevertheless, infections plot shown used diagnostic purposes, example ensure trend looks sensible scale infections unrealistic (millions infections 0.01 infections per day). Please interpret estimated number infections terms true absolute incidence prevalence.  can also compare prior posterior distribution certain parameters model see much informed data. example, can inspect coefficient variation (CV) observation noise: can see, prior (grey) posterior (blue) differ substantially, indicating parameter well informed data.","code":"plot_load(ww_result) plot_infections(ww_result) plot_infections(ww_result) + geom_step(data = data_zurich$cases, aes(x = date, y = cases), color = \"#000080\") plot_prior_posterior(ww_result, \"measurement_noise_cv\")"},{"path":"https://adrian-lison.github.io/EpiSewer/index.html","id":"more-details","dir":"","previous_headings":"Introduction","what":"More details","title":"Estimate Epidemiological Parameters from Wastewater Measurements","text":"can inspect results object. three attributes: job attribute stores information job defined via EpiSewer. contains data used, alongside meta-information, settings sampler. calling run(ww_result$job), job can run . particular, can print concise summary modeling details (EpiSewer defaults case): ‚û°Ô∏è Check model specification detailed example vignettes better understand modeling details customize EpiSewer model. summary attribute stores summarized results important parameters model. example, can access exact estimates reproduction number. fitted attribute provides access details fitted stan model (see cmdstanr details). example, can use show sampler diagnostics chain: Finally, checksums attribute gives us several checksums uniquely identify job run. can used check whether two job results used different models, input data, fitting options, inits. checksums identical (seed NULL), results also identical.","code":"names(ww_result) #> [1] \"job\"         \"stan_model\"  \"checksums\"   \"summary\"     \"fitted\"      #> [6] \"diagnostics\" \"runtime\" names(ww_result$job) #>  [1] \"job_name\"      \"jobarray_size\" \"data\"          \"model\"         #>  [5] \"init\"          \"fit_opts\"      \"results_opts\"  \"priors_text\"   #>  [9] \"metainfo\"      \"overwrite\" ww_result$job$model #> measurements #>  |- concentrations_observe #>  |- noise_estimate #>  |- LOD_none #>  #> sampling #>  |- sample_effects_none #>  #> sewage #>  |- flows_observe #>  |- residence_dist_assume #>  #> shedding #>  |- incubation_dist_assume #>  |- shedding_dist_assume (shedding_reference = symptom_onset) #>  |- load_per_case_calibrate #>  |- load_variation_estimate #>  #> infections #>  |- generation_dist_assume #>  |- R_estimate_splines #>  |- seeding_estimate_rw #>  |- infection_noise_estimate (overdispersion = TRUE) names(ww_result$summary) #>  [1] \"samples\"                  \"R\"                        #>  [3] \"expected_infections\"      \"infections\"               #>  [5] \"growth_rate\"              \"doubling_time\"            #>  [7] \"days_growing\"             \"expected_load\"            #>  [9] \"expected_concentration\"   \"concentration\"            #> [11] \"normalized_concentration\" head(ww_result$summary$R, 5) #>          date     mean   median lower_0.95 lower_0.5 upper_0.5 upper_0.95 #> 1: 2021-12-03 1.042238 1.044795  0.7012397 0.9294330  1.157058   1.365061 #> 2: 2021-12-04 1.043177 1.044975  0.7155260 0.9338175  1.155830   1.355124 #> 3: 2021-12-05 1.044297 1.045450  0.7303710 0.9367903  1.154685   1.346828 #> 4: 2021-12-06 1.045626 1.045795  0.7430955 0.9419335  1.152473   1.342926 #> 5: 2021-12-07 1.047189 1.046505  0.7521539 0.9480593  1.147990   1.336999 #>        type seeding #> 1: estimate    TRUE #> 2: estimate    TRUE #> 3: estimate    TRUE #> 4: estimate    TRUE #> 5: estimate    TRUE ww_result$fitted$diagnostic_summary() #> $num_divergent #> [1] 0 0 0 0 #>  #> $num_max_treedepth #> [1] 0 0 0 0 #>  #> $ebfmi #> [1] 0.9014503 0.9680378 0.9334176 0.9486877 ww_result$checksums #> $model #> [1] \"6346549bd7c2ac9a9d200503d7356a29\" #>  #> $input #> [1] \"c6dad2f8ed2b6fdaf952926f3eb3e97d\" #>  #> $fit_opts #> [1] \"5309bbbc3cd1cc109eac60d2fc82de45\" #>  #> $results_opts #> [1] \"e92f83d0ca5d22b3bb5849d62c5412ee\" #>  #> $init #> [1] \"82126b86311c9716bda5d21c04c52142\""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/EpiSewer.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate epidemiological parameters from wastewater measurements ‚Äî EpiSewer","title":"Estimate epidemiological parameters from wastewater measurements ‚Äî EpiSewer","text":"EpiSewer estimates effective reproduction number Rt parameters interest wastewater measurements time. function combines data, assumptions modeling details fit Bayesian hierarchical model measurements. resulting posterior estimates Rt parameters can plotted analyzed. inputs function can specified using various helper functions (see ). best define inputs advance separate variables pass EpiSewer.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/EpiSewer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate epidemiological parameters from wastewater measurements ‚Äî EpiSewer","text":"","code":"EpiSewer(   data = sewer_data(),   assumptions = sewer_assumptions(),   measurements = model_measurements(),   sampling = model_sampling(),   sewage = model_sewage(),   shedding = model_shedding(),   infections = model_infections(),   forecast = model_forecast(),   fit_opts = set_fit_opts(),   results_opts = set_results_opts(),   run_fit = TRUE )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/EpiSewer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate epidemiological parameters from wastewater measurements ‚Äî EpiSewer","text":"data Observations concentration measurements flows, specified via sewer_data(). data can also directly supplied relevant model components, case data can left empty. assumptions Assumptions infections, shedding, sewage system, specified via sewer_assumptions(). assumptions can also directly supplied relevant model components, case assumptions can left empty. measurements measurements module, see model_measurements(). sampling sampling module, see model_sampling(). sewage sewage module, see model_sewage(). shedding shedding module, see model_shedding(). infections infections module, see model_infections(). fit_opts Settings model fitting, see set_fit_opts(). results_opts Settings results returned, see set_results_opts(). run_fit TRUE (default), model fitted immediately. FALSE, EpiSewerJob object returned without fitting model (can fitted later even different machine).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/EpiSewer.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate epidemiological parameters from wastewater measurements ‚Äî EpiSewer","text":"model fitting successful, list following elements returned: job: EpiSewerJob run summary: summary parameter estimates interest fitted: fitted model (results_opts(fitted = TRUE)) model fitting fails, list following elements returned: error: information errors warnings thrown sampler_output: potential outputs printed sampler","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/EpiSewerJob.html","id":null,"dir":"Reference","previous_headings":"","what":"Constructor for EpiSewerJob objects ‚Äî EpiSewerJob","title":"Constructor for EpiSewerJob objects ‚Äî EpiSewerJob","text":"Constructor EpiSewerJob objects","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/EpiSewerJob.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Constructor for EpiSewerJob objects ‚Äî EpiSewerJob","text":"","code":"EpiSewerJob(   job_name,   modeldata,   fit_opts,   results_opts,   jobarray_size = 1,   overwrite = TRUE,   results_exclude = c() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_assume.html","id":null,"dir":"Reference","previous_headings":"","what":"Assume a limit of detection ‚Äî LOD_assume","title":"Assume a limit of detection ‚Äî LOD_assume","text":"Pathogen concentrations certain threshold may detectable thus erroneously measured 0. option adjusts known limit detection includes zero measurements likelihood.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_assume.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assume a limit of detection ‚Äî LOD_assume","text":"","code":"LOD_assume(   limit = NULL,   prob = 0.95,   LOD_type = \"exponential\",   drop_prob = 1e-10,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_assume.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assume a limit of detection ‚Äî LOD_assume","text":"limit Limit detection. concentration pathogen detected sufficient probability, .e. measurement may zero although pathogen present sample. prob desired probability detection limit refer ? Default 95% (0.95): means provided limit smallest concentration pathogen can still detected 95% probability. LOD_type type LOD model used. Currently, \"exponential\" supported. models exponentially decreasing probability zero measurements / non-detection function concentration. exponential model can derived statistical properties dPCR, also work well quantification methods qPCR. drop_prob Probability non-detection likelihood contributions observed concentrations dropped LOD model. avoids numerical issues LOD model high concentrations (small non-detection probabilities) can otherwise affect sampling speed. Since likelihood contributions virtually zero almost samples anyway, parameter estimates practically affected. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_assume.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assume a limit of detection ‚Äî LOD_assume","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_assume.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assume a limit of detection ‚Äî LOD_assume","text":"limit detection modeled using hurdle model. effect, zero measurements provide signal concentration respective sample likely limit detection, know exact concentration . limit detection specific quantification approach protocol. usually established dedicated lab experiment (serial dilution experiment). assumed experiment cover large fraction preprocessing noise find optimal configuration exponential model. used together noise_estimate_dPCR(), EpiSewer also model effect pre-PCR noise LOD. means modeled LOD slightly higher specified limit, depending estimated pre-PCR noise.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_estimate_dPCR.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate a limit of detection model for digital PCR data ‚Äî LOD_estimate_dPCR","title":"Estimate a limit of detection model for digital PCR data ‚Äî LOD_estimate_dPCR","text":"Pathogen concentrations certain threshold may detectable thus erroneously measured 0. option adjusts limit detection based statistical properties digital PCR (dPCR) includes zero measurements likelihood. effect, zero measurements provide signal concentration respective sample likely limit detection, know exact concentration .","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_estimate_dPCR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate a limit of detection model for digital PCR data ‚Äî LOD_estimate_dPCR","text":"","code":"LOD_estimate_dPCR(drop_prob = 1e-10, modeldata = modeldata_init())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_estimate_dPCR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate a limit of detection model for digital PCR data ‚Äî LOD_estimate_dPCR","text":"drop_prob Probability non-detection likelihood contributions observed concentrations dropped LOD model. avoids numerical issues LOD model high concentrations (small non-detection probabilities) can otherwise affect sampling speed. Since likelihood contributions virtually zero almost samples anyway, parameter estimates practically affected. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_estimate_dPCR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate a limit of detection model for digital PCR data ‚Äî LOD_estimate_dPCR","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_estimate_dPCR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate a limit of detection model for digital PCR data ‚Äî LOD_estimate_dPCR","text":"limit detection modeled using hurdle model. model uses number partitions dPCR reaction conversion factor defined estimated noise_estimate_dPCR(). can therefore used together noise = noise_estimate_dPCR() model_measurements().","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_none.html","id":null,"dir":"Reference","previous_headings":"","what":"Do not model a limit of detection ‚Äî LOD_none","title":"Do not model a limit of detection ‚Äî LOD_none","text":"option drops zero measurements likelihood explicitly model limit detection.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_none.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Do not model a limit of detection ‚Äî LOD_none","text":"","code":"LOD_none(modeldata = modeldata_init())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_none.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Do not model a limit of detection ‚Äî LOD_none","text":"modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_none.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Do not model a limit of detection ‚Äî LOD_none","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/LOD_none.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Do not model a limit of detection ‚Äî LOD_none","text":"Dropping zero measurements implicitly assumes level concentration can theoretically lead zero measurement. Since corresponding observations dropped, discard information, bias estimates.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_approx.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Rt using an approximation of the generative renewal model ‚Äî R_estimate_approx","title":"Estimate Rt using an approximation of the generative renewal model ‚Äî R_estimate_approx","text":"option estimates effective reproduction number Rt using approximation generative renewal model. can considerably faster fully generative options, often less exact. recommended check results method fully generative version like R_estimate_splines() using real-time R estimation. See details explanation method limitations.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_approx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Rt using an approximation of the generative renewal model ‚Äî R_estimate_approx","text":"","code":"R_estimate_approx(   inf_sd_prior_mu = 0.05,   inf_sd_prior_sigma = 0.025,   inf_smooth = 0.75,   inf_trend_smooth = 0.75,   inf_trend_dampen = 0.9,   knot_distance = 7,   spline_degree = 3,   R_window = 1,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_approx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Rt using an approximation of the generative renewal model ‚Äî R_estimate_approx","text":"inf_sd_prior_mu Prior (mean) standard deviation daily changes infections. Infection numbers modeled log scale, thus standard deviation can roughly interpreted terms percentage changes. higher standard deviation lead volatile infections uncertainty R estimates. default (inf_sd_prior_mu = 0.05) allows daily growth/decline rates +-10%. suggest decrease certain modeled scenario lower maximum growth/decline rates, increase expect extreme scenario. Note smoothness infection curve also influenced exponential smoothing parameters (inf_smooth, inf_trend_smooth). Still, inf_sd_prior_mu primary hyperparameter adjust think estimated infection trajectory volatile / flexible enough. inf_sd_prior_sigma Prior (standard deviation) standard deviation daily changes infections. reflects uncertainty around inf_sd_prior_mu. default (inf_sd_prior_mu=0.025) allows standard deviation roughly 0.5 higher lower inf_sd_prior_mu. default setting inf_sd_prior_mu = 0.05, means growth/decline rates +-20% still supported prior. inf_smooth Smoothing parameter (alpha) infections. infection time series smoothed based earlier time steps, exponentially decaying weights, controlled alpha parameter. default 0.5, smaller values lead stronger smoothing, larger values less smoothing. inf_trend_smooth Trend smoothing parameter (beta) infections. exponential trend infections also smoothed based trend earlier time steps, exponentially decaying weights, controlled beta parameter. Default 0.5, smaller values lead stronger smoothing trend (useful longer generation times), larger values less smoothing trend (useful shorter generation times). inf_trend_dampen Trend dampening parameter (phi) infections. exponential trend infections dampened time (exponential growth continue ever). mainly influences trend towards present. default value (0.9), trend roughly half strong two weeks. Note increasing phi close 1 can reduce sampling speed. knot_distance infection time series smoothed using penalized B-splines. distance spline breakpoints (knots) 7 days default. Placing knots apart increases smoothness infection time series can speed model fitting. Placing knots closer increases volatility infections. Note however uncertainty R estimates produced R_estimate_approx() also sensitive smoothness infection time series, .e. changing knot distance can make R estimates appear less uncertain. effect however rather small since regularization spline coefficients adjusts knot distance. spline_degree Degree spline polynomials (default 3 cubic splines). R_window Smoothing window size R estimates. Default 1 (.e. smoothing). provided compatibility EpiEstim method Cori et al., assumes R stays constant certain time window. However, can artificially reduce uncertainty R estimates therefore generally recommended. also means R estimated present smoothing window must centered. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_approx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Rt using an approximation of the generative renewal model ‚Äî R_estimate_approx","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_approx.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Rt using an approximation of the generative renewal model ‚Äî R_estimate_approx","text":"method uses approximation renewal model estimate effective reproduction number. Instead generating infections renewal process, infection time series estimated using non-parametric smoothing prior mimics characteristics renewal process. Rt computed infection time series applying classical renewal equation. still gives Bayesian estimates Rt infection time series, less exact fully generative model. smooth infection time series, penalized B-splines similar ones R_estimate_splines() used, applied expected number infections log scale, Rt. spline coefficients smoothed using exponential smoothing prior trend component. trend component important reflects default assumption constant transmission dynamics leads exponential growth infections. ensures consistent results R_estimate_approx() also towards present. method can also model infection noise specified infection_noise_estimate(). account autocorrelation infection noise, correction applies renewal model specifically noise component used. correction accurate R close 1 less accurate far 1. main limitation R_estimate_approx() priors hyperparameters less interpretable thus difficult specify. particular assumed generation time distribution used R estimation inform smoothness expected infection time series. Instead, smoothness determined spline settings exponential smoothing parameters, difficult translate generation time assumption. best approach therefore compare estimates R_estimate_approx() another method like R_estimate_splines() pathogen interest carefully adjust smoothing hyperparameters needed.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_ets.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Rt via exponential smoothing ‚Äî R_estimate_ets","title":"Estimate Rt via exponential smoothing ‚Äî R_estimate_ets","text":"option estimates effective reproduction number time using exponential smoothing. implements Holt's linear trend method dampening innovations state space model level, trend, dampening component.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_ets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Rt via exponential smoothing ‚Äî R_estimate_ets","text":"","code":"R_estimate_ets(   level_prior_mu = 1,   level_prior_sigma = 0.8,   trend_prior_mu = 0,   trend_prior_sigma = 0.1,   sd_prior_mu = 0,   sd_prior_sigma = 0.1,   sd_changepoint_dist = 7 * 26,   sd_changepoint_sd = 0.025,   link = \"inv_softplus\",   R_max = 6,   smooth_prior_mu = 0.5,   smooth_prior_sigma = 0.05,   trend_smooth_prior_mu = 0.5,   trend_smooth_prior_sigma = 0.05,   dampen_prior_mu = 0.9,   dampen_prior_sigma = 0,   differenced = FALSE,   noncentered = TRUE,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_ets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Rt via exponential smoothing ‚Äî R_estimate_ets","text":"level_prior_mu Prior (mean) initial level Rt. level_prior_sigma Prior (standard deviation) initial level Rt. trend_prior_mu Prior (mean) initial trend Rt. trend_prior_sigma Prior (standard deviation) initial trend Rt. sd_prior_mu Prior (mean) standard deviation innovations. sd_prior_sigma Prior (standard deviation) standard deviation innovations. Please note consistency overall prior standard deviation innovations standard deviation sd_prior_sigma + sd_changepoint_sd even changepoints modeled (see ). sd_changepoint_dist variability Rt can change time, e.g. height epidemic wave, countermeasures may lead much faster changes Rt observable times. potential variability accounted using change points placed regular intervals. standard deviation state space model innovations evolves linearly change points. default change point distance 26 weeks (182 days). Short changepoint distances (e.g. 4 weeks less) must chosen care, can make Rt time series flexible. set zero, change points modeled. sd_changepoint_sd parameter controls variability change points. change points modeled, EpiSewer estimate baseline standard deviation (see sd_prior_mu sd_prior_sigma), model change point values independently distributed mean equal baseline standard deviation sd_changepoint_sd. link Link function. Currently supported inv_softplus (default) scaled_logit. links configured behave approximately like identity function around R=1, become increasingly non-linear (case scaled_logit also ) R=1. R_max link=scaled_logit used, maximum reproduction number must assumed. higher realistic R value modeled pathogen. Default 6. smooth_prior_mu Prior (mean) smoothing parameter. Must 0 1. smooth_prior_sigma Prior (standard deviation) smoothing parameter. set zero, smoothing parameter fixed smooth_prior_mu estimated. positive, beta prior corresponding mean standard deviation used. trend_smooth_prior_mu Prior (mean) trend smoothing parameter. Must 0 1. trend_smooth_prior_sigma Prior (standard deviation) trend smoothing parameter. set zero, trend smoothing parameter fixed trend_smooth_prior_mu estimated. positive, beta prior corresponding mean standard deviation used. dampen_prior_mu Prior (mean) dampening parameter. Must 0 1. dampen_prior_sigma Prior (standard deviation) dampening parameter. set zero, dampening parameter fixed dampen_prior_mu estimated. positive, beta prior corresponding mean standard deviation used. differenced FALSE (default), exponential smoothing applied absolute Rt time series. TRUE, instead applied differenced time series. makes level become trend, trend become curvature. noncentered TRUE (default), non-centered parameterization used model innovations state space process (better sampling efficiency). modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_ets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Rt via exponential smoothing ‚Äî R_estimate_ets","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_ets.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Rt via exponential smoothing ‚Äî R_estimate_ets","text":"innovations state space model consists three components: level, trend, dampening component. level smoothed based levels earlier time steps, exponentially decaying weights, controlled smoothing parameter (often called alpha). Note smaller values alpha indicate stronger smoothing. particular, alpha = 1 means last level used. trend smoothed based trends earlier time steps, exponentially decaying weights, controlled trend smoothing parameter (often called beta). Note smaller values beta indicate stronger smoothing. particular, beta = 1 means last trend used. dampening determines long previous trend continues future levels stationary time series. strength dampening controlled dampening parameter (often called phi). Note smaller values phi indicate stronger dampening. particular, phi = 1 means dampening. Values phi = 0.8 seldom practice dampening becomes strong. Often, alpha, beta, phi jointly unidentifiable. may therefore necessary fix least one parameters (typically phi) supply strong priors. Note smoothness retrospective Rt estimates often influenced prior standard deviation innovations smoothing trend smoothing parameters. smoothing parameters mostly influence estimates close present / date estimation, limited data signal available. , standard deviation innovations influences uncertain Rt estimates close present. priors component following functional form: initial level Rt: Normal initial trend Rt: Normal standard deviation innovations: Truncated normal smoothing parameter: Beta trend smoothing parameter: Beta dampening parameter: Beta","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_rw.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Rt via a random walk ‚Äî R_estimate_rw","title":"Estimate Rt via a random walk ‚Äî R_estimate_rw","text":"option estimates effective reproduction number time using random walk.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_rw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Rt via a random walk ‚Äî R_estimate_rw","text":"","code":"R_estimate_rw(   intercept_prior_mu = 1,   intercept_prior_sigma = 0.8,   sd_prior_mu = 0,   sd_prior_sigma = 0.1,   sd_changepoint_dist = 7 * 26,   sd_changepoint_sd = 0.025,   link = \"inv_softplus\",   R_max = 6,   differenced = FALSE,   noncentered = TRUE,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_rw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Rt via a random walk ‚Äî R_estimate_rw","text":"intercept_prior_mu Prior (mean) intercept random walk. intercept_prior_sigma Prior (standard deviation) intercept random walk. sd_prior_mu Prior (mean) standard deviation random walk. sd_prior_sigma Prior (standard deviation) standard deviation random walk. sd_changepoint_dist variability Rt can change time, e.g. height epidemic wave, countermeasures may lead much faster changes Rt observable times. potential variability accounted using change points placed regular intervals. standard deviation random walk evolves linearly change points. default change point distance 26 weeks (182 days). Short changepoint distances (e.g. 4 weeks less) must chosen care, can make Rt time series flexible. set zero, change points modeled. sd_changepoint_sd parameter controls variability change points. change points modeled, EpiSewer estimate baseline standard deviation (see sd_prior_mu sd_prior_sigma), model change point values independently distributed mean equal baseline standard deviation sd_changepoint_sd. link Link function. Currently supported inv_softplus (default) scaled_logit. links configured behave approximately like identity function around R=1, become increasingly non-linear (case scaled_logit also ) R=1. R_max link=scaled_logit used, maximum reproduction number must assumed. higher realistic R value modeled pathogen. Default 6. differenced FALSE (default), random walk applied absolute Rt time series. TRUE, instead applied differenced time series, .e. now trend modeled random walk. noncentered TRUE (default), non-centered parameterization used model innovations random walk (better sampling efficiency). modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_rw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Rt via a random walk ‚Äî R_estimate_rw","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_rw.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Rt via a random walk ‚Äî R_estimate_rw","text":"smoothness Rt estimates influenced prior standard deviation random walk. also influences uncertainty Rt estimates towards present / date estimation, limited data signal available. prior intercept random walk reflect expectation Rt beginning time series. estimating start epidemic, might want use prior mean > 1 intercept. priors component following functional form: intercept random walk: Normal standard deviation random walk: Truncated normal","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_splines.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Rt via smoothing splines ‚Äî R_estimate_splines","title":"Estimate Rt via smoothing splines ‚Äî R_estimate_splines","text":"option estimates effective reproduction number using penalized B-splines.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_splines.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Rt via smoothing splines ‚Äî R_estimate_splines","text":"","code":"R_estimate_splines(   knot_distance = 7,   spline_degree = 3,   coef_intercept_prior_mu = 1,   coef_intercept_prior_sigma = 0.8,   coef_sd_prior_mu = 0,   coef_sd_prior_sigma = 0.2,   coef_sd_changepoint_dist = 7 * 26,   coef_sd_changepoint_sd = 0.05,   link = \"inv_softplus\",   R_max = 6,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_splines.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Rt via smoothing splines ‚Äî R_estimate_splines","text":"knot_distance Distance spline breakpoints (knots) days (default 7, .e. one knot week). Placing knots apart increases smoothness Rt estimates can speed model fitting. Rt time series remains surprisingly flexible even larger knot distances, placing knots far apart can lead inaccurate estimates. spline_degree Degree spline polynomials (default 3 cubic splines). coef_intercept_prior_mu Prior (mean) intercept random walk spline coefficients. coef_intercept_prior_sigma Prior (standard deviation) intercept random walk spline coefficients. coef_sd_prior_mu Prior (mean) daily standard deviation random walk spline coefficients (see details). coef_sd_prior_sigma Prior (standard deviation) daily standard deviation random walk spline coefficients. Please note consistency overall prior daily standard deviation random walk standard deviation coef_sd_prior_sigma + coef_sd_changepoint_sd even changepoints modeled (see ). coef_sd_changepoint_dist variability Rt can change time, e.g. height epidemic wave, countermeasures may lead much faster changes Rt observable times. potential variability accounted using change points placed regular intervals. standard deviation random walk spline coefficients evolves linearly change points. default change point distance 26 weeks (182 days). Short changepoint distances (e.g. 4 weeks less) must chosen care, can make Rt time series flexible. set zero, change points modeled. coef_sd_changepoint_sd parameter controls variability change points. change points modeled, EpiSewer estimate baseline standard deviation (see coef_sd_prior_mu coef_sd_prior_sigma), model change point values independently distributed mean equal baseline standard deviation coef_sd_changepoint_sd. link Link function. Currently supported inv_softplus (default) scaled_logit. links configured behave approximately like identity function around R=1, become increasingly non-linear (case scaled_logit also ) R=1. R_max link=scaled_logit used, maximum reproduction number must assumed. higher realistic R value modeled pathogen. Default 6. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_splines.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Rt via smoothing splines ‚Äî R_estimate_splines","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/R_estimate_splines.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Rt via smoothing splines ‚Äî R_estimate_splines","text":"EpiSewer uses random walk B-spline coefficients regularization. allows use small knot distances without obtaining extremely wiggly Rt estimates. prior random walk intercept reflect expectation Rt beginning time series. estimating start epidemic, might want use prior mean larger 1 intercept. prior daily standard deviation interpreted terms daily additive changes (least true around Rt=1, becomes less true Rt approaches 0 upper bound defined link function). example, prior mean=0 sd=0.2 allows daily standard deviation 0 0.4. daily standard deviation 0.4 turn roughly allows spline coefficients change ¬±0.8 (using 2 sigma rule) day. daily standard deviation summed days two knots get actual standard deviation coefficients. way, prior independent chosen knot_distance. example, knot_distance 7 days, constant daily standard deviation 0.4 estimated, coefficients two adjacent splines can differ 0.8*sqrt(knot_distance), .e. ¬±2.1. Note however difference directly translate change Rt ¬±2.1, Rt always weighted sum several basis functions given point. may therefore change much gradually, depending distances knots. smoothness Rt estimates influenced knot distance daily standard deviation random walk coefficients. latter also influences uncertainty Rt estimates towards present / date estimation, limited data signal available. Absent sufficient data signal, Rt estimates tend stay current level (corresponds assuming unchanged transmission dynamics). priors component following functional form: intercept random walk spline coefficients: Normal standard deviation random walk spline coefficients: Truncated normal","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/abort_f.html","id":null,"dir":"Reference","previous_headings":"","what":"Semantic sugar to wrap an abort statement in a function ‚Äî abort_f","title":"Semantic sugar to wrap an abort statement in a function ‚Äî abort_f","text":"can used provide abort statements direct argument tryCatch without wrapping function call","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/abort_f.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Semantic sugar to wrap an abort statement in a function ‚Äî abort_f","text":"","code":"abort_f(...)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/add_R_variability.html","id":null,"dir":"Reference","previous_headings":"","what":"Add change point model for the variability of Rt ‚Äî add_R_variability","title":"Add change point model for the variability of Rt ‚Äî add_R_variability","text":"Add change point model variability Rt","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/add_R_variability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add change point model for the variability of Rt ‚Äî add_R_variability","text":"","code":"add_R_variability(   length_R,   h,   length_seeding,   length_partial,   changepoint_dist,   modeldata )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/add_R_variability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add change point model for the variability of Rt ‚Äî add_R_variability","text":"length_R Length modeled Rt time series changepoint_dist many days change points apart? zero, change points modeled (fixed R variability). modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/add_R_variability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add change point model for the variability of Rt ‚Äî add_R_variability","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/add_R_variability.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Add change point model for the variability of Rt ‚Äî add_R_variability","text":"change points placed going backwards end time series, .e. last day, changepoint_dist days , . distance first second change point start time series (partly falls seeding phase) varies half double changepoint_dist.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/check_provided.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if all required data and assumptions have been provided. ‚Äî check_provided","title":"Check if all required data and assumptions have been provided. ‚Äî check_provided","text":"Check required data assumptions provided.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/check_provided.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if all required data and assumptions have been provided. ‚Äî check_provided","text":"","code":"check_provided(   f_env = list(),   data = list(),   assumptions = list(),   required_data = c(),   required_assumptions = c() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/check_provided.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if all required data and assumptions have been provided. ‚Äî check_provided","text":"f_env environment checked data list data assumptions list assumptions required_data character vector names required data. Different options one item can provided using \"|\" separator. EpiSewer check least one options present. required_assumptions character vector names required assumptions. Different options one item can provided using \"|\" separator. EpiSewer check least one options present.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/check_provided.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if all required data and assumptions have been provided. ‚Äî check_provided","text":"TRUE required data assumptions present f_env.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/cli_help.html","id":null,"dir":"Reference","previous_headings":"","what":"Print link to help page of function in CLI ‚Äî cli_help","title":"Print link to help page of function in CLI ‚Äî cli_help","text":"Print link help page function CLI","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/cli_help.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print link to help page of function in CLI ‚Äî cli_help","text":"","code":"cli_help(function_name, label = NULL)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/cli_help.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print link to help page of function in CLI ‚Äî cli_help","text":"function_name Name function label Optional label link, NULL (default), function name used label","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/cli_help.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print link to help page of function in CLI ‚Äî cli_help","text":"string link help page function","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/compareNA.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare entries of two vectors with potentially missing values ‚Äî compareNA","title":"Compare entries of two vectors with potentially missing values ‚Äî compareNA","text":"Compare entries two vectors potentially missing values","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/compareNA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare entries of two vectors with potentially missing values ‚Äî compareNA","text":"","code":"compareNA(v1, v2)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/compareNA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare entries of two vectors with potentially missing values ‚Äî compareNA","text":"v1 First vector v2 Second vector, length first one","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/compareNA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare entries of two vectors with potentially missing values ‚Äî compareNA","text":"boolean vector element-wise comparisons. Comparisons including NAs coded FALSE.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/component_functions.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a list of modeling functions for a component ‚Äî component_functions","title":"Get a list of modeling functions for a component ‚Äî component_functions","text":"function returns list available modeling functions given component.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/component_functions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a list of modeling functions for a component ‚Äî component_functions","text":"","code":"component_functions(component)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/component_functions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a list of modeling functions for a component ‚Äî component_functions","text":"component character vector name component","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/component_functions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a list of modeling functions for a component ‚Äî component_functions","text":"character vector available modeling functions component.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/component_functions_.html","id":null,"dir":"Reference","previous_headings":"","what":"Get modeling functions for a component (internal function) ‚Äî component_functions_","title":"Get modeling functions for a component (internal function) ‚Äî component_functions_","text":"Get available modeling functions given component. Argument defaults helpers returned comma-separated list roxygen function links.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/component_functions_.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get modeling functions for a component (internal function) ‚Äî component_functions_","text":"","code":"component_functions_(   component,   collapse = \"\\n\",   prefix = \"- [\",   suffix = \"()]\" )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/component_functions_.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get modeling functions for a component (internal function) ‚Äî component_functions_","text":"component character vector name component collapse character used collapse helpers one string. Default NULL (collapse). prefix prefix add function name suffix suffix add function name","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/component_functions_.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get modeling functions for a component (internal function) ‚Äî component_functions_","text":"character vector available modeling functions component. collapse NULL, helper functions collapsed single string.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/concentrations_observe.html","id":null,"dir":"Reference","previous_headings":"","what":"Observe concentration measurements ‚Äî concentrations_observe","title":"Observe concentration measurements ‚Äî concentrations_observe","text":"option fits EpiSewer model pathogen concentrations measured wastewater samples. suitable different quantification methods qPCR dPCR. measured concentrations modeled via Log-Normal likelihood.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/concentrations_observe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Observe concentration measurements ‚Äî concentrations_observe","text":"","code":"concentrations_observe(   measurements = NULL,   composite_window = 1,   distribution = \"gamma\",   date_col = \"date\",   concentration_col = \"concentration\",   replicate_col = NULL,   n_averaged = 1,   n_averaged_col = NULL,   total_partitions_col = NULL,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/concentrations_observe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Observe concentration measurements ‚Äî concentrations_observe","text":"measurements data.frame row representing one measurement. Must least column dates column concentration measurements. composite_window many days measured sample collected? 1 (default), samples represent single days. larger 1, samples assumed equivolumetric composites several dates. case, supplied dates represent last day included sample. distribution Parametric distribution concentration measurements. Currently supported \"gamma\" (default recommended), \"log-normal\", \"truncated normal\", \"normal\". \"truncated normal\" \"normal\" options recommended use practice. date_col Name column containing dates. concentration_col Name column containing measured concentrations. replicate_col Name column containing replicate ID measurement. used identify multiple measurements made sample date. NULL one measurement per date made. n_averaged number replicates measurements averaged. typically used alternative providing several replicates per sample (.e. concentration provided measurements data.frame arithmetic mean several replicates). Can either single number (assumed number averaged replicates observation) vector (one value observation). n_averaged_col Name column measurements data.frame containing number replicates measurements averaged. alternative specifying n_averaged. total_partitions_col Name column measurements data.frame containing total number partitions (e.g. droplets ddPCR) dPCR reaction measurement. applies concentration measurements obtain via dPCR. Can used noise_estimate_dPCR() LOD_estimate_dPCR() modeling components. Note really total number partitions, just number positive partitions. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/concentrations_observe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Observe concentration measurements ‚Äî concentrations_observe","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/copy_env.html","id":null,"dir":"Reference","previous_headings":"","what":"Copy an environment ‚Äî copy_env","title":"Copy an environment ‚Äî copy_env","text":"Copy environment","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/copy_env.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copy an environment ‚Äî copy_env","text":"","code":"copy_env(env, exclude = c())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/copy_env.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copy an environment ‚Äî copy_env","text":"env environment copied exclude Character vector names excluded copy","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/copy_env.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copy an environment ‚Äî copy_env","text":"copy environment","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/copy_env.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Copy an environment ‚Äî copy_env","text":"new environment calling environment copy_env parent. ensure functions namespace accessible.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/dist_mean.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the mean of a discrete distribution ‚Äî dist_mean","title":"Get the mean of a discrete distribution ‚Äî dist_mean","text":"Get mean discrete distribution","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/dist_mean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the mean of a discrete distribution ‚Äî dist_mean","text":"","code":"dist_mean(dist, include_zero = TRUE)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/dist_mean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the mean of a discrete distribution ‚Äî dist_mean","text":"dist Discrete distribution represented numeric vector include_zero TRUE (default), vector index starts zero. Otherwise, starts 1.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/dist_mean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the mean of a discrete distribution ‚Äî dist_mean","text":"Mean discrete distribution","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/fence.html","id":null,"dir":"Reference","previous_headings":"","what":"Clip values of a vector between a lower and an upper bound ‚Äî fence","title":"Clip values of a vector between a lower and an upper bound ‚Äî fence","text":"Clip values vector lower upper bound","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/fence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clip values of a vector between a lower and an upper bound ‚Äî fence","text":"","code":"fence(vec, LB = -Inf, UB = Inf)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/fence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clip values of a vector between a lower and an upper bound ‚Äî fence","text":"vec vector values clipped LB Lower bound UB Upper bound","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/fence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clip values of a vector between a lower and an upper bound ‚Äî fence","text":"vector clipped/fenced values","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/flows_assume.html","id":null,"dir":"Reference","previous_headings":"","what":"Assume a constant wastewater flow ‚Äî flows_assume","title":"Assume a constant wastewater flow ‚Äî flows_assume","text":"option assumes constant flow wastewater sampling site. Can used approximation regular flow measurements available.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/flows_assume.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assume a constant wastewater flow ‚Äî flows_assume","text":"","code":"flows_assume(flow_constant, modeldata = modeldata_init())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/flows_assume.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assume a constant wastewater flow ‚Äî flows_assume","text":"flow_constant Daily wastewater flow volume, assumed days. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/flows_assume.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assume a constant wastewater flow ‚Äî flows_assume","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/flows_assume.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assume a constant wastewater flow ‚Äî flows_assume","text":"flow volume unit concentration measurements, e.g. concentrations measured gc/mL, flow mL well. Note flow unknown therefore arbitrary value (e.g. flow_constant=1) assumed, must also accounted assumed load_per_case. purpose, function suggest_load_per_case() offers flow_constant argument.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/flows_observe.html","id":null,"dir":"Reference","previous_headings":"","what":"Observe wastewater flows ‚Äî flows_observe","title":"Observe wastewater flows ‚Äî flows_observe","text":"option accounts daily wastewater flow volumes measured sampling site. flow can change due rainfall industrial discharge, directly influences pathogen concentrations wastewater.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/flows_observe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Observe wastewater flows ‚Äî flows_observe","text":"","code":"flows_observe(   flows = NULL,   date_col = \"date\",   flow_col = \"flow\",   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/flows_observe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Observe wastewater flows ‚Äî flows_observe","text":"flows data.frame row representing one day. Must least column dates column flow measurements. date_col Name column containing dates. flow_col Name column containing flows. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/flows_observe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Observe wastewater flows ‚Äî flows_observe","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/flows_observe.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Observe wastewater flows ‚Äî flows_observe","text":"flow volume unit concentration measurements, e.g. concentrations measured gc/mL, flow mL well.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/generation_dist_assume.html","id":null,"dir":"Reference","previous_headings":"","what":"Assume a generation time distribution ‚Äî generation_dist_assume","title":"Assume a generation time distribution ‚Äî generation_dist_assume","text":"option assumes fixed generation time distribution renewal model EpiSewer.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/generation_dist_assume.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assume a generation time distribution ‚Äî generation_dist_assume","text":"","code":"generation_dist_assume(generation_dist = NULL, modeldata = modeldata_init())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/generation_dist_assume.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assume a generation time distribution ‚Äî generation_dist_assume","text":"generation_dist numeric vector representing discrete generation time distribution, starting probability generation time 1 day, 2 days, 3 days, (generation time 0 days excluded). modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/generation_dist_assume.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assume a generation time distribution ‚Äî generation_dist_assume","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/generation_dist_assume.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assume a generation time distribution ‚Äî generation_dist_assume","text":"generation time distribution refers intrinsic distribution time infection primary case infection secondary cases. disease-specific typically obtained literature.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_checksum_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Computes a checksum of a stanmodel, i.e. of the code from its main stan file and all included stan files ‚Äî get_checksum_model","title":"Computes a checksum of a stanmodel, i.e. of the code from its main stan file and all included stan files ‚Äî get_checksum_model","text":"Computes checksum stanmodel, .e. code main stan file included stan files","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_checksum_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computes a checksum of a stanmodel, i.e. of the code from its main stan file and all included stan files ‚Äî get_checksum_model","text":"","code":"get_checksum_model(stanmodel, only_functions = FALSE)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_checksums.html","id":null,"dir":"Reference","previous_headings":"","what":"Get checksums that uniquely identify an EpiSewer job. ‚Äî get_checksums","title":"Get checksums that uniquely identify an EpiSewer job. ‚Äî get_checksums","text":"Get checksums uniquely identify EpiSewer job.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_checksums.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get checksums that uniquely identify an EpiSewer job. ‚Äî get_checksums","text":"","code":"get_checksums(job, stanmodel_instance = NULL)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_checksums.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get checksums that uniquely identify an EpiSewer job. ‚Äî get_checksums","text":"job EpiSewer job object. stanmodel_instance stanmodel instance.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_checksums.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get checksums that uniquely identify an EpiSewer job. ‚Äî get_checksums","text":"list checksums identifying model, input, inits, fit_opts results_opts.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_discrete_gamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Get PMF of a discretized Gamma distribution ‚Äî get_discrete_gamma","title":"Get PMF of a discretized Gamma distribution ‚Äî get_discrete_gamma","text":"function accepts different parameterizations specify discretized Gamma distribution.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_discrete_gamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get PMF of a discretized Gamma distribution ‚Äî get_discrete_gamma","text":"","code":"get_discrete_gamma(   gamma_shape,   gamma_rate,   gamma_scale,   gamma_mean,   gamma_sd,   gamma_cv,   maxX = NULL,   include_zero = TRUE,   print_params = FALSE )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_discrete_gamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get PMF of a discretized Gamma distribution ‚Äî get_discrete_gamma","text":"gamma_shape Shape parameter Gamma distribution. gamma_rate Rate parameter Gamma distribution. gamma_scale Scale parameter Gamma distribution. Can specified instead rate. effect rate specified. gamma_mean Alternative parameterization: Mean Gamma distribution. gamma_sd Alternative parameterization: Standard deviation Gamma distribution. gamma_cv Alternative parameterization: Coefficient variation Gamma distribution. maxX Right truncation point. probability mass beyond maxX assigned maxX. NULL (default), automatically chosen last bin less 0.5% probability mass. include_zero distribution explicitly cover X=0, X=1 include probability mass X=0 ? print_params shape rate parameters printed?","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_discrete_gamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get PMF of a discretized Gamma distribution ‚Äî get_discrete_gamma","text":"numeric vector representing PMF discretized Gamma distribution.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_discrete_gamma_shifted.html","id":null,"dir":"Reference","previous_headings":"","what":"Get PMF of a discretized shifted Gamma distribution ‚Äî get_discrete_gamma_shifted","title":"Get PMF of a discretized shifted Gamma distribution ‚Äî get_discrete_gamma_shifted","text":"function specifies discretized shifted Gamma distribution (shifted minimum 1) using mean standard deviation parameterization. shift makes distribution attractive modeling generation time distributions, often assumed zero probability mass generation time zero (incompatible renewal equation).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_discrete_gamma_shifted.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get PMF of a discretized shifted Gamma distribution ‚Äî get_discrete_gamma_shifted","text":"","code":"get_discrete_gamma_shifted(gamma_mean, gamma_sd, maxX = NULL)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_discrete_gamma_shifted.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get PMF of a discretized shifted Gamma distribution ‚Äî get_discrete_gamma_shifted","text":"gamma_mean Mean shifted Gamma distribution. gamma_sd Standard deviation shifted Gamma distribution. maxX Right truncation point. probability mass beyond maxX assigned maxX.  NULL (default), automatically chosen last bin approximately less 0.5% probability mass.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_discrete_gamma_shifted.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get PMF of a discretized shifted Gamma distribution ‚Äî get_discrete_gamma_shifted","text":"numeric vector representing PMF discretized shifted Gamma distribution.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_discrete_gamma_shifted.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get PMF of a discretized shifted Gamma distribution ‚Äî get_discrete_gamma_shifted","text":"code adapted EpiEstim, credit Anne Cori (.cori@imperial.ac.uk).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_discrete_lognormal.html","id":null,"dir":"Reference","previous_headings":"","what":"Get PMF of a discretized lognormal distribution ‚Äî get_discrete_lognormal","title":"Get PMF of a discretized lognormal distribution ‚Äî get_discrete_lognormal","text":"function accepts log-scale unit-scale parameters specify discretized lognormal distribution.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_discrete_lognormal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get PMF of a discretized lognormal distribution ‚Äî get_discrete_lognormal","text":"","code":"get_discrete_lognormal(   meanlog,   sdlog,   unit_mean = NULL,   unit_sd = NULL,   unit_cv = NULL,   maxX = NULL,   include_zero = TRUE,   print_params = FALSE )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_discrete_lognormal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get PMF of a discretized lognormal distribution ‚Äî get_discrete_lognormal","text":"meanlog Log scale mean (location lognormal). sdlog Log scale standard deviation (scale lognormal). unit_mean Alternative parameterization: unit/natural scale mean. unit_sd Alternative parameterization: unit/natural scale sd. unit_cv Alternative parameterization: unit/natural scale coefficient variation. maxX Right truncation point. probability mass beyond maxX assigned maxX. NULL (default), automatically chosen last bin less 0.5% probability mass. include_zero distribution explicitly cover X=0, X=1 include probability mass X=0 ? print_params log-level parameters printed?","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_discrete_lognormal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get PMF of a discretized lognormal distribution ‚Äî get_discrete_lognormal","text":"numeric vector representing PMF discretized lognormal.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_gamma_mean_alternative.html","id":null,"dir":"Reference","previous_headings":"","what":"Get mean of a Gamma distribution given its shape and scale ‚Äî get_gamma_mean_alternative","title":"Get mean of a Gamma distribution given its shape and scale ‚Äî get_gamma_mean_alternative","text":"Get mean Gamma distribution given shape scale","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_gamma_mean_alternative.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get mean of a Gamma distribution given its shape and scale ‚Äî get_gamma_mean_alternative","text":"","code":"get_gamma_mean_alternative(gamma_shape, gamma_scale)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_gamma_rate_alternative.html","id":null,"dir":"Reference","previous_headings":"","what":"Get rate of a Gamma distribution given its mean and sd ‚Äî get_gamma_rate_alternative","title":"Get rate of a Gamma distribution given its mean and sd ‚Äî get_gamma_rate_alternative","text":"Get rate Gamma distribution given mean sd","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_gamma_rate_alternative.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get rate of a Gamma distribution given its mean and sd ‚Äî get_gamma_rate_alternative","text":"","code":"get_gamma_rate_alternative(gamma_mean, gamma_sd)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_gamma_scale_alternative.html","id":null,"dir":"Reference","previous_headings":"","what":"Get scale of a Gamma distribution given its mean and sd ‚Äî get_gamma_scale_alternative","title":"Get scale of a Gamma distribution given its mean and sd ‚Äî get_gamma_scale_alternative","text":"Get scale Gamma distribution given mean sd","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_gamma_scale_alternative.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get scale of a Gamma distribution given its mean and sd ‚Äî get_gamma_scale_alternative","text":"","code":"get_gamma_scale_alternative(gamma_mean, gamma_sd)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_gamma_sd_alternative.html","id":null,"dir":"Reference","previous_headings":"","what":"Get sd of a Gamma distribution given its shape and scale ‚Äî get_gamma_sd_alternative","title":"Get sd of a Gamma distribution given its shape and scale ‚Äî get_gamma_sd_alternative","text":"Get sd Gamma distribution given shape scale","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_gamma_sd_alternative.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get sd of a Gamma distribution given its shape and scale ‚Äî get_gamma_sd_alternative","text":"","code":"get_gamma_sd_alternative(gamma_shape, gamma_scale)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_gamma_shape_alternative.html","id":null,"dir":"Reference","previous_headings":"","what":"Get shape of a Gamma distribution given its mean and sd ‚Äî get_gamma_shape_alternative","title":"Get shape of a Gamma distribution given its mean and sd ‚Äî get_gamma_shape_alternative","text":"Get shape Gamma distribution given mean sd","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_gamma_shape_alternative.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get shape of a Gamma distribution given its mean and sd ‚Äî get_gamma_shape_alternative","text":"","code":"get_gamma_shape_alternative(gamma_mean, gamma_sd)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_infection_curve_crude.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute crude estimate of infections by date of infections ‚Äî get_infection_curve_crude","title":"Compute crude estimate of infections by date of infections ‚Äî get_infection_curve_crude","text":"function smoothed measured loads using loess smoother log scale shifts backward mean total delay obtain crude estimate loads date infection. useful different calibration purposes, determining suitable load_per_case assumption.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_infection_curve_crude.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute crude estimate of infections by date of infections ‚Äî get_infection_curve_crude","text":"","code":"get_infection_curve_crude(load_curve_crude, load_per_case)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_infection_curve_crude.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute crude estimate of infections by date of infections ‚Äî get_infection_curve_crude","text":"load_curve_crude data.frame columns date_index, date, load produced get_load_curve_crude(). load_per_case Load per case gene copies.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_infection_curve_crude.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute crude estimate of infections by date of infections ‚Äî get_infection_curve_crude","text":"data.frame columns date_index, date, load.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_load_curve_crude.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute crude estimate of load by date of infections ‚Äî get_load_curve_crude","title":"Compute crude estimate of load by date of infections ‚Äî get_load_curve_crude","text":"function smoothes measured loads using loess smoother log scale shifts backward mean total delay obtain crude estimate loads date infection. useful different calibration purposes, determining suitable load_per_case assumption.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_load_curve_crude.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute crude estimate of load by date of infections ‚Äî get_load_curve_crude","text":"","code":"get_load_curve_crude(   measured_concentrations,   measure_to_sample,   sample_to_date,   flow,   total_delay_dist,   max_shift = NULL,   T_start_date,   impute_zero = NA,   impute_zero_runs = FALSE,   interpolate = TRUE,   loess_window = 56,   plot_smoothed_curve = FALSE )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_load_curve_crude.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute crude estimate of load by date of infections ‚Äî get_load_curve_crude","text":"max_shift far past time series expanded? NULL (default), expands mean total delay. max_shift supplied larger mean total delay, LOESS extrapolation used. impute_zero zero measurements imputed? NA (default), removed. imputation value measured concentration. Imputed loads calculated impute_zero * flow. impute_zero_runs runs zero measurements imputed accounting many measurements row zero? based posterior expectation concentration number zero measurements. effect, imputed concentration get smaller smaller run zeros. interpolate log-linear interpolation missing dates performed? makes loess smoothing window consistent. loess_window Length loess smoothing window days. converted span parameter. plot_smoothed_curve smoothed curve plotted inspection purposes?","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_load_curve_crude.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute crude estimate of load by date of infections ‚Äî get_load_curve_crude","text":"data.frame columns date_index, date, load.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_lognormal_mu_alternative.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute mu parameter of Log-Normal from other quantities. ‚Äî get_lognormal_mu_alternative","title":"Compute mu parameter of Log-Normal from other quantities. ‚Äî get_lognormal_mu_alternative","text":"Compute mu parameter Log-Normal quantities.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_lognormal_mu_alternative.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute mu parameter of Log-Normal from other quantities. ‚Äî get_lognormal_mu_alternative","text":"","code":"get_lognormal_mu_alternative(   unit_mean = NULL,   unit_sd = NULL,   unit_q5 = NULL,   unit_q95 = NULL )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_lognormal_mu_alternative.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute mu parameter of Log-Normal from other quantities. ‚Äî get_lognormal_mu_alternative","text":"unit_q5 5% quantile distribution. unit_q95 95% quantile distribution.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_lognormal_mu_alternative.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute mu parameter of Log-Normal from other quantities. ‚Äî get_lognormal_mu_alternative","text":"Mu parameter Log-Normal distribution.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_lognormal_mu_alternative.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute mu parameter of Log-Normal from other quantities. ‚Äî get_lognormal_mu_alternative","text":"Currently, conversion quantiles supported, alternatives may added.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_lognormal_sigma_alternative.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute sigma parameter of Log-Normal from other quantities. ‚Äî get_lognormal_sigma_alternative","title":"Compute sigma parameter of Log-Normal from other quantities. ‚Äî get_lognormal_sigma_alternative","text":"Compute sigma parameter Log-Normal quantities.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_lognormal_sigma_alternative.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute sigma parameter of Log-Normal from other quantities. ‚Äî get_lognormal_sigma_alternative","text":"","code":"get_lognormal_sigma_alternative(   mu,   unit_mean = NULL,   unit_sd = NULL,   unit_q5 = NULL,   unit_q95 = NULL )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_lognormal_sigma_alternative.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute sigma parameter of Log-Normal from other quantities. ‚Äî get_lognormal_sigma_alternative","text":"mu Mu parameter Log-Normal distribution. unit_q5 5% quantile distribution. unit_q95 95% quantile distribution.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_lognormal_sigma_alternative.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute sigma parameter of Log-Normal from other quantities. ‚Äî get_lognormal_sigma_alternative","text":"Sigma parameter Log-Normal distribution.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_lognormal_sigma_alternative.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute sigma parameter of Log-Normal from other quantities. ‚Äî get_lognormal_sigma_alternative","text":"Currently, conversion mu + quantile supported, alternatives may added.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_regression_linear_trend.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain regression vector to estimate a linear trend ‚Äî get_regression_linear_trend","title":"Obtain regression vector to estimate a linear trend ‚Äî get_regression_linear_trend","text":"function provides solution vector (weighted) linear regression one independent variable x, x may represent points time series.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_regression_linear_trend.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain regression vector to estimate a linear trend ‚Äî get_regression_linear_trend","text":"","code":"get_regression_linear_trend(x, weights = rep(1/length(x), length(x)))"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_regression_linear_trend.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain regression vector to estimate a linear trend ‚Äî get_regression_linear_trend","text":"x vector observations single independent variable (example points time). weights Optional, vector weights observation.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_regression_linear_trend.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain regression vector to estimate a linear trend ‚Äî get_regression_linear_trend","text":"vector contains relevant row regression solution matrix represents trend coefficient. multiplying vector observed time series values y, directly get (weighted least squares) estimate trend. #@examples #x = 1:6 #y = x4 + rnorm(6, 0, 0.1) #w <- c(0.1, 0.1, 0.1, 0.2, 0.2, 0.3) # weights #trend_reg <- get_regression_linear_trend(x, weights = w) #.vector(trend_reg %% y) # gives trend estimate #summary(lm(y ~ x, weights = w))$coefficients\"x\",\"Estimate\" # ","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_stan_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Load stan model ‚Äî get_stan_model","title":"Load stan model ‚Äî get_stan_model","text":"Loads specific stan model model fitting EpiSewer.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_stan_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load stan model ‚Äî get_stan_model","text":"","code":"get_stan_model(   model_metainfo = NULL,   model_filename = NULL,   model_folder = \"stan\",   profile = TRUE,   threads = FALSE,   force_recompile = FALSE,   package = \"EpiSewer\" )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_stan_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load stan model ‚Äî get_stan_model","text":"model_metainfo list containing meta information specified model fitted. required stan model automatically inferred model_metainfo. model_filename File name specific stan model load. alternative supplying model_metainfo. model_folder Path folder containing stan models EpiSewer. profile profiling run model fitting? Default TRUE. FALSE, remove profiling statements model fitting. can decrease runtime cases. threads multihreading enabled? Default FALSE, EpiSewer currently support within-chain parallelism. force_recompile FALSE (default), model recompiled changes model code detected. However, change detection fully reliable, sometimes necessary force recompilation made changes stan code. package Name package search stan files (defaults EpiSewer). NULL, search normal working directory.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/get_stan_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load stan model ‚Äî get_stan_model","text":"list containing model definition link compiled stan model.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/horizon_assume.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify the forecast horizon ‚Äî horizon_assume","title":"Specify the forecast horizon ‚Äî horizon_assume","text":"option specifies fixed forecast horizon days. EpiSewer produce concentration predictions forecasts latent variables Rt, infections load end forecast horizon.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/horizon_assume.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify the forecast horizon ‚Äî horizon_assume","text":"","code":"horizon_assume(horizon, modeldata = modeldata_init())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/horizon_assume.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify the forecast horizon ‚Äî horizon_assume","text":"horizon forecast horizon days. 0, forecasts produced. Note functionality intended short-term forecasts. Projections longer horizons can highly inaccurate. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/horizon_assume.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify the forecast horizon ‚Äî horizon_assume","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/horizon_assume.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify the forecast horizon ‚Äî horizon_assume","text":"Forecasts account estimated variation transmission dynamics time therefore become uncertain longer forecast horizons. However, important keep mind expectation model project current transmission dynamics continue unchanged (exception R_estimate_ets, can project current linear trend Rt). assumption can violated various factors depletion susceptible individuals, changes behavior, public health interventions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/horizon_none.html","id":null,"dir":"Reference","previous_headings":"","what":"Do not produce forecasts ‚Äî horizon_none","title":"Do not produce forecasts ‚Äî horizon_none","text":"option specifies forecasts made. estimates concentration predictions last observed date produced.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/horizon_none.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Do not produce forecasts ‚Äî horizon_none","text":"","code":"horizon_none(modeldata = modeldata_init())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/horizon_none.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Do not produce forecasts ‚Äî horizon_none","text":"modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/horizon_none.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Do not produce forecasts ‚Äî horizon_none","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/incubation_dist_assume.html","id":null,"dir":"Reference","previous_headings":"","what":"Assume an incubation period distribution ‚Äî incubation_dist_assume","title":"Assume an incubation period distribution ‚Äî incubation_dist_assume","text":"option assumes fixed incubation period distribution shedding model EpiSewer.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/incubation_dist_assume.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assume an incubation period distribution ‚Äî incubation_dist_assume","text":"","code":"incubation_dist_assume(incubation_dist = NULL, modeldata = modeldata_init())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/incubation_dist_assume.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assume an incubation period distribution ‚Äî incubation_dist_assume","text":"incubation_dist numeric vector representing discrete incubation period distribution, starting probability incubation period 0 days, 1 day, 2 days, . modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/incubation_dist_assume.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assume an incubation period distribution ‚Äî incubation_dist_assume","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/incubation_dist_assume.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assume an incubation period distribution ‚Äî incubation_dist_assume","text":"incubation period time infection symptom onset. assumption used shedding_reference=\"symptom_onset\", .e. support shedding load distributions referenced days since symptom onset.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/infection_noise_estimate.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate infection noise ‚Äî infection_noise_estimate","title":"Estimate infection noise ‚Äî infection_noise_estimate","text":"option estimates noise infection process, .e. implements stochastic renewal model. allows variation number new infections generated time step, can often speed model fitting.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/infection_noise_estimate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate infection noise ‚Äî infection_noise_estimate","text":"","code":"infection_noise_estimate(   overdispersion = TRUE,   overdispersion_prior_mu = 0.1,   overdispersion_prior_sigma = 0,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/infection_noise_estimate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate infection noise ‚Äî infection_noise_estimate","text":"overdispersion TRUE (default), new infections modeled Negative Binomial distributed. FALSE, new infections modeled Poisson distributed. overdispersion_prior_mu Prior (mean) overdispersion parameter Negative Binomial. default 0.1 corresponds 10% overdispersion. also limit coefficient variation (CV) infections infection incidence becomes large. overdispersion_prior_sigma Prior (standard deviation) overdispersion parameter Negative Binomial. set zero (default), overdispersion fixed prior mean estimated. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/infection_noise_estimate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate infection noise ‚Äî infection_noise_estimate","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/infection_noise_estimate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate infection noise ‚Äî infection_noise_estimate","text":"level overdispersion often unidentifiable single time series measurements. overdispersion fixed default. complicated reasons, MCMC sampling high infection numbers faster certain degree overdispersion. Thus, modeling large waves, assuming overdispersion can also make sense computational reasons. effects estimated transmission dynamics often minimal. priors component following functional form: overdispersion parameter Negative Binomial: Truncated normal","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/infection_noise_none.html","id":null,"dir":"Reference","previous_headings":"","what":"Do not model infection noise ‚Äî infection_noise_none","title":"Do not model infection noise ‚Äî infection_noise_none","text":"option model noise infection process instead implements deterministic renewal model.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/infection_noise_none.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Do not model infection noise ‚Äî infection_noise_none","text":"","code":"infection_noise_none(modeldata = modeldata_init())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/infection_noise_none.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Do not model infection noise ‚Äî infection_noise_none","text":"modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/infection_noise_none.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Do not model infection noise ‚Äî infection_noise_none","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/init_from_location_scale_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Provide initialization value for a parameter based on the supplied prior with location and scale ‚Äî init_from_location_scale_prior","title":"Provide initialization value for a parameter based on the supplied prior with location and scale ‚Äî init_from_location_scale_prior","text":"Initialization using prior often better initializing zero (parameter strictly positive, zero possible ). function provides init value location prior plus 1/4 scale. ensure positive init even mean zero (useful truncated normal priors example.)","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/init_from_location_scale_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Provide initialization value for a parameter based on the supplied prior with location and scale ‚Äî init_from_location_scale_prior","text":"","code":"init_from_location_scale_prior(prior)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/init_from_location_scale_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Provide initialization value for a parameter based on the supplied prior with location and scale ‚Äî init_from_location_scale_prior","text":"prior Prior parameter provided set_prior(). location scale prior (first element location, second element scale).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/init_from_location_scale_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Provide initialization value for a parameter based on the supplied prior with location and scale ‚Äî init_from_location_scale_prior","text":"Location prior plus 1/4 scale.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/init_from_location_scale_prior.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Provide initialization value for a parameter based on the supplied prior with location and scale ‚Äî init_from_location_scale_prior","text":"provided prior zero variance, assumed parameter sampled empty init returned.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_per_case_assume.html","id":null,"dir":"Reference","previous_headings":"","what":"Assume the average load per case ‚Äî load_per_case_assume","title":"Assume the average load per case ‚Äî load_per_case_assume","text":"option assumes average total shedding load per case. EpiSewer model, serves scaling factor describing many pathogen particles shed average infected individual overall much detectable sampling site. depends biological factors well specific sewage system.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_per_case_assume.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assume the average load per case ‚Äî load_per_case_assume","text":"","code":"load_per_case_assume(load_per_case = NULL, modeldata = modeldata_init())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_per_case_assume.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assume the average load per case ‚Äî load_per_case_assume","text":"load_per_case assumed average total shedding load per case. Must unit numerator concentration unit. example, concentration measured gc/mL (gc = gene copies), load_per_case also gc. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_per_case_assume.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assume the average load per case ‚Äî load_per_case_assume","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_per_case_calibrate.html","id":null,"dir":"Reference","previous_headings":"","what":"Calibrate the average load per case using case count data ‚Äî load_per_case_calibrate","title":"Calibrate the average load per case using case count data ‚Äî load_per_case_calibrate","text":"option calibrates average total shedding load per case based relationship measured concentrations case counts. goal obtain load_per_case right order magnitude - sufficient accurate prevalence estimation wastewater, fully sufficient monitoring trends estimating Rt.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_per_case_calibrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calibrate the average load per case using case count data ‚Äî load_per_case_calibrate","text":"","code":"load_per_case_calibrate(   cases = NULL,   min_cases = NULL,   ascertainment_prop = 1,   measurement_shift = seq(-7, 7),   shift_weights = 1/(abs(measurement_shift) + 1),   date_col = \"date\",   case_col = \"cases\",   signif_fig = 2,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_per_case_calibrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calibrate the average load per case using case count data ‚Äî load_per_case_calibrate","text":"cases data.frame case numbers row representing one day. Must least column dates column case numbers. min_cases alternative supplying data.frame cases. min_cases specified, load_per_case calibrated based smallest observed load wastewater. EpiSewer uses min_cases = 10 default case data supplied (see sewer_assumptions()). ascertainment_prop Proportion cases get detected / reported. Can used account underreporting infections. Default ascertainment_prop=1, meaning 100% infections become confirmed cases. measurement_shift specific timing wastewater concentrations case numbers depends reporting delays shedding profiles typically uncertain. argument allows shift concentration case number time series relative average several potential lags/leads, specified integer vector. default measurement_shift = seq(-7,7), .e. shift concentrations one week case numbers. shift_weights Weights shifted comparisons. Must numeric vector length measurement_shift. NULL (default), weights chosen approximately inversely proportional shift distance. date_col Name date column provided cases data.frame. case_col Name column containing case numbers. signif_fig Significant figures round . Since heuristic provides crude estimates -interpreted, result gets rounded (also increases stability fitting model different points time). Default rounding 2 significant figures. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_per_case_calibrate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calibrate the average load per case using case count data ‚Äî load_per_case_calibrate","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_per_case_calibrate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calibrate the average load per case using case count data ‚Äî load_per_case_calibrate","text":"EpiSewer, load_per_case serves scaling factor describing many pathogen particles shed average infected individual overall much detectable sampling site. depends biological factors well specific sewage system laboratory quantification. therefore almost always necessary assume load per case based comparison measured concentrations/loads case numbers. data.frame cases supplied via cases argument, average load per case determined fitting linear regression model loads (computed using concentrations flows) dependent variable case numbers independent variable. explicitly account shedding profiles reporting delays, measurement_shift argument allows average set relative shifts two time series.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_variation_estimate.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate individual-level load variation ‚Äî load_variation_estimate","title":"Estimate individual-level load variation ‚Äî load_variation_estimate","text":"option accounts variation total shedding load per case modeling individual shedding loads Gamma distributed mean equal average load_per_case coefficient variation estimated.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_variation_estimate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate individual-level load variation ‚Äî load_variation_estimate","text":"","code":"load_variation_estimate(   cv_prior_mu = 1,   cv_prior_sigma = 0,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_variation_estimate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate individual-level load variation ‚Äî load_variation_estimate","text":"cv_prior_mu Mean truncated normal prior coefficient individual-level variation. Default CV 1, means approximately 60% individuals shed less mean, approximately 10% individuals shed less 10% mean. cv_prior_sigma Standard deviation truncated normal prior coefficient individual-level variation. set zero, coefficient variation fixed mean. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_variation_estimate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate individual-level load variation ‚Äî load_variation_estimate","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_variation_estimate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate individual-level load variation ‚Äî load_variation_estimate","text":"Note measurement noise individual-level load variation might jointly identifiable. coefficient variation individual-level load fixed default. Also note accuracy variation model depends estimated number cases right scale (turn depends assumed load_per_case roughly correct). variation model, population-level coefficient variation (CV) shedding loads proportional individual-level CV divided square root number cases. example assumed load_per_case small, number cases overestimated, effects two directions: individual-level CV overestimated (especially prior individual-level CV weak) population-level CV underestimated (especially prior individual-level CV strong)","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_variation_none.html","id":null,"dir":"Reference","previous_headings":"","what":"Do not model individual-level load variation ‚Äî load_variation_none","title":"Do not model individual-level load variation ‚Äî load_variation_none","text":"option assumes variation total load shed per case, .e. individual shedding load fixed average shedding load.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_variation_none.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Do not model individual-level load variation ‚Äî load_variation_none","text":"","code":"load_variation_none(modeldata = modeldata_init())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_variation_none.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Do not model individual-level load variation ‚Äî load_variation_none","text":"modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/load_variation_none.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Do not model individual-level load variation ‚Äî load_variation_none","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/mark_outlier_spikes_median.html","id":null,"dir":"Reference","previous_headings":"","what":"Mark outlier spikes in a measurement time series ‚Äî mark_outlier_spikes_median","title":"Mark outlier spikes in a measurement time series ‚Äî mark_outlier_spikes_median","text":"Uses simple heuristic detect positive outliers (.e. unusually high spikes) time series. approach compare measurement median measurements small centered window. measurements considerably lower current measurement, median also much lower. used criterion determine outliers.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/mark_outlier_spikes_median.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mark outlier spikes in a measurement time series ‚Äî mark_outlier_spikes_median","text":"","code":"mark_outlier_spikes_median(   df,   measurement_col,   date_col = date,   window = 5,   threshold_factor = 5,   mad_window = 14,   mad_lower_quantile = 0.05 )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/mark_outlier_spikes_median.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mark outlier spikes in a measurement time series ‚Äî mark_outlier_spikes_median","text":"df data.frame containing time series measurements. measurement_col name column measurements. Use dplyr-style env-variables, characters. date_col name column corresponding dates. Use dplyr-style env-variables, characters. window size centered window computing median. threshold_factor Beyond many median absolute deviations median measurement marked outlier? mad_window size right-aligned, one-day-lagged window mean absolute deviation. longer window median. mad_lower_quantile quantile lower bound expected noise ? used avoid false positives concentration levels low.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/mark_outlier_spikes_median.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mark outlier spikes in a measurement time series ‚Äî mark_outlier_spikes_median","text":"provided data.frame, additional logical column is_outlier.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/mark_outlier_spikes_median.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mark outlier spikes in a measurement time series ‚Äî mark_outlier_spikes_median","text":"determine much deviation median significant, moving median absolute deviation (robust estimate standard deviation much noise expect) measurements used. seems robust just multiplying median factor determine threshold. moving MAD lagged one day current value included. Moreover, note window moving median centered, last window_size/2 dates spike detection. method also allows multiple measurements per day (replicates), replicate evaluated individually. However, currently give weight days replicates, .e. ignores potential differences measurement uncertainty.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_forecast.html","id":null,"dir":"Reference","previous_headings":"","what":"Forecasting module ‚Äî model_forecast","title":"Forecasting module ‚Äî model_forecast","text":"module function used specify components forecast module EpiSewer. component can specified using one several helper functions (see available options ). See documentation individual helper functions adjust various settings.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_forecast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Forecasting module ‚Äî model_forecast","text":"","code":"model_forecast(horizon = horizon_none())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_forecast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Forecasting module ‚Äî model_forecast","text":"horizon forecast horizon. many days future EpiSewer forecast? Note functionality intended short-term forecasts. Projections longer horizons can highly inaccurate. Available options: - horizon_none() horizon_assume()","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_forecast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Forecasting module ‚Äî model_forecast","text":"modeldata object containing data specifications forecast module.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_forecast.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Forecasting module ‚Äî model_forecast","text":"Forecasts account estimated variation transmission dynamics time therefore become uncertain longer forecast horizons. However, important keep mind expectation model project current transmission dynamics continue unchanged (exception R_estimate_ets, can project current linear trend Rt). assumption can violated various factors depletion susceptible individuals, changes behavior, public health interventions.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_infections.html","id":null,"dir":"Reference","previous_headings":"","what":"Model the infection process ‚Äî model_infections","title":"Model the infection process ‚Äî model_infections","text":"module function used specify components infections module EpiSewer. component can specified using one several helper functions (see available options ). See documentation individual helper functions adjust model priors settings.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_infections.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model the infection process ‚Äî model_infections","text":"","code":"model_infections(   generation_dist = generation_dist_assume(),   R = R_estimate_splines(),   seeding = seeding_estimate_rw(),   infection_noise = infection_noise_estimate() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_infections.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model the infection process ‚Äî model_infections","text":"generation_dist Generation time distribution. intrinsic distribution time infection primary case infection secondary cases. Modeling options: generation_dist_assume() R Effective reproduction number time. main parameter interest estimated EpiSewer. R smoothed using time series smoothing prior. Currently supported : random walk (rw), exponential smoothing (ets), smoothing splines. Modeling options: R_estimate_splines() R_estimate_ets() R_estimate_approx() R_estimate_rw() seeding Seeding initial infections. renewal model used EpiSewer requires seeding phase length maximum generation time. initial infections, simple seeding model instead renewal model must used. Modeling options: seeding_estimate_constant() seeding_estimate_rw() infection_noise Noise infection process. EpiSewer implements stochastic infection model, .e. allows variation number new infections generated time step. accounts stochastic uncertainty infection process often speeds model fitting. Modeling options: infection_noise_none() infection_noise_estimate()","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_infections.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Model the infection process ‚Äî model_infections","text":"modeldata object containing data specifications infections module.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_measurements.html","id":null,"dir":"Reference","previous_headings":"","what":"Model the measurement process ‚Äî model_measurements","title":"Model the measurement process ‚Äî model_measurements","text":"module function used specify components measurements module EpiSewer. component can specified using one several helper functions (see available options ). See documentation individual helper functions adjust model priors settings.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_measurements.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model the measurement process ‚Äî model_measurements","text":"","code":"model_measurements(   concentrations = concentrations_observe(),   noise = noise_estimate(),   LOD = LOD_none() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_measurements.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model the measurement process ‚Äî model_measurements","text":"concentrations Concentration measurements wastewater samples. Modeling options: concentrations_observe() noise Measurement noise due unexplained variation sampling lab analysis. Modeling options: noise_estimate() noise_estimate_dPCR() noise_estimate_constant_var() LOD Limit detection. Concentrations certain threshold may detectable thus erroneously measured 0. EpiSewer can adjust limit detection using hurdle model. Modeling options: LOD_none() LOD_assume() LOD_estimate_dPCR()","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_measurements.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Model the measurement process ‚Äî model_measurements","text":"modeldata object containing data specifications measurements module.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_sampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Model the sampling process ‚Äî model_sampling","title":"Model the sampling process ‚Äî model_sampling","text":"module function used specify components sampling module EpiSewer. component can specified using one several helper functions (see available options ). See documentation individual helper functions adjust model priors settings.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_sampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model the sampling process ‚Äî model_sampling","text":"","code":"model_sampling(sample_effects = sample_effects_none())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_sampling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model the sampling process ‚Äî model_sampling","text":"sample_effects Sample (batch) effects. pathogen concentration sample may influenced sampling-related external factors, example time sampling shipping lab (age--sample effect), different sampling storage methods. EpiSewer allows estimate effects using covariates describe differences samples. Modeling options: sample_effects_none() sample_effects_estimate_weekday() sample_effects_estimate_matrix()","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_sampling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Model the sampling process ‚Äî model_sampling","text":"modeldata object containing data specifications sampling module.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_sewage.html","id":null,"dir":"Reference","previous_headings":"","what":"Model the sewage process ‚Äî model_sewage","title":"Model the sewage process ‚Äî model_sewage","text":"module function used specify components sewage module EpiSewer. component can specified using one several helper functions (see available options ). See documentation individual helper functions adjust model priors settings.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_sewage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model the sewage process ‚Äî model_sewage","text":"","code":"model_sewage(flows = flows_observe(), residence_dist = residence_dist_assume())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_sewage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model the sewage process ‚Äî model_sewage","text":"flows Daily flow volumes sampling site. flow can change due rainfall industrial discharge, directly influences pathogen concentrations wastewater. Modeling options: flows_observe() flows_assume() residence_dist Sewer residence time distribution pathogen particles. default, EpiSewer assumes particles arrive sampling site within day shedding. However, larger sewage systems, particles may travel longer day depending shed wastewater. Modeling options: residence_dist_assume()","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_sewage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Model the sewage process ‚Äî model_sewage","text":"modeldata object containing data specifications sewage module.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_shedding.html","id":null,"dir":"Reference","previous_headings":"","what":"Model the shedding process ‚Äî model_shedding","title":"Model the shedding process ‚Äî model_shedding","text":"module function used specify components shedding module EpiSewer. component can specified using one several helper functions (see available options ). See documentation individual helper functions adjust model priors settings.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_shedding.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model the shedding process ‚Äî model_shedding","text":"","code":"model_shedding(   incubation_dist = incubation_dist_assume(),   shedding_dist = shedding_dist_assume(),   load_per_case = load_per_case_calibrate(),   load_variation = load_variation_estimate() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_shedding.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model the shedding process ‚Äî model_shedding","text":"incubation_dist Incubation period distribution. EpiSewer uses proxy time infection start shedding, shedding load distributions literature often given symptom onset onwards. assumed shedding load distribution instead starts time infection, incubation period fixed 0 days. Modeling options: incubation_dist_assume() shedding_dist Shedding load distribution. Describes total load shed individual distributed time (therefore sums 1). Modeling options: shedding_dist_assume() load_per_case Average total load per case. scaling factor describes many pathogen particles shed average infected individual overall much detectable sampling site. depends biological factors well specific sewage system. Modeling options: load_per_case_assume() load_variation Individual-level shedding load variation. strength shedding may vary individuals. Modeling variation can better account uncertainty especially low incidence. Modeling options: load_variation_none() load_variation_estimate()","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_shedding.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Model the shedding process ‚Äî model_shedding","text":"modeldata object containing data specifications shedding module.","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_stan_opts.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify details of the stan model ‚Äî model_stan_opts","title":"Specify details of the stan model ‚Äî model_stan_opts","text":"Specify details stan model","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_stan_opts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify details of the stan model ‚Äî model_stan_opts","text":"","code":"model_stan_opts(   model_filename = NULL,   model_folder = \"stan\",   profile = TRUE,   threads = FALSE,   force_recompile = FALSE,   package = \"EpiSewer\" )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_stan_opts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify details of the stan model ‚Äî model_stan_opts","text":"model_filename Name stan model file. NULL (default), name model file automatically inferred based model specification. model_folder (Relative) path folder containing stan model. profile profiling run model fitting? Default TRUE. FALSE, remove profiling statements model fitting. can decrease runtime cases. threads multihreading enabled? Default FALSE, EpiSewer currently support within-chain parallelism. force_recompile recompilation forced model fitting? FALSE (default), model recompiled changes model code detected. However, change detection fully reliable, sometimes necessary force recompilation made changes stan code. package Name package search stan files (defaults EpiSewer). NULL, search normal working directory, allowing users provide customized model files.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/model_stan_opts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify details of the stan model ‚Äî model_stan_opts","text":"list details stan model","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/modeldata_check.html","id":null,"dir":"Reference","previous_headings":"","what":"Check modeldata object for required variables ‚Äî modeldata_check","title":"Check modeldata object for required variables ‚Äî modeldata_check","text":"modeldata_check accepts various additional arguments turned sophisticated error message missing variables","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/modeldata_check.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check modeldata object for required variables ‚Äî modeldata_check","text":"","code":"modeldata_check(   modeldata,   required,   required_values = NULL,   descriptions = modeldata_descriptions(),   run_before = modeldata_var_requirements(),   advice = NULL,   throw_error = TRUE,   calling_env = rlang::caller_env() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/modeldata_check.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check modeldata object for required variables ‚Äî modeldata_check","text":"modeldata list data variables (including priors) passed stan, alongside additional meta information descriptions. required Character vector required variables descriptions Optional, list names corresponding required variables, values corresponding additional descriptions variables run_before Optional, either character vector, list names corresponding required variables, values corresponding functions add variables modeldata. advice Additional message advice solve error. throw_error error thrown (verbatim error message), TRUE/FALSE returned. Default TRUE.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/modeldata_check.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check modeldata object for required variables ‚Äî modeldata_check","text":"throw_error TRUE, nothing returned, otherwise logical returned (TRUE required variables present)","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/modeldata_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct an unspecified EpiSewer model ‚Äî modeldata_init","title":"Construct an unspecified EpiSewer model ‚Äî modeldata_init","text":"Construct unspecified EpiSewer model","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/modeldata_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct an unspecified EpiSewer model ‚Äî modeldata_init","text":"","code":"modeldata_init()"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/modeldata_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct an unspecified EpiSewer model ‚Äî modeldata_init","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/modeldata_update_metainfo.html","id":null,"dir":"Reference","previous_headings":"","what":"Update meta information in modeldata based on available variables ‚Äî modeldata_update_metainfo","title":"Update meta information in modeldata based on available variables ‚Äî modeldata_update_metainfo","text":"update function meta information depends modeldata several functions. also functions add meta information directly, particular meta information solely inferred modeldata. function designed calling never harm modeldata object throw errors something missing modeldata object.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/modeldata_update_metainfo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update meta information in modeldata based on available variables ‚Äî modeldata_update_metainfo","text":"","code":"modeldata_update_metainfo(modeldata)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/modeldata_validate.html","id":null,"dir":"Reference","previous_headings":"","what":"Ensure that modeldata contains all necessary variables ‚Äî modeldata_validate","title":"Ensure that modeldata contains all necessary variables ‚Äî modeldata_validate","text":"Throws error necessary variables missing, replaces optional variables defaults indicating absence stan model.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/modeldata_validate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ensure that modeldata contains all necessary variables ‚Äî modeldata_validate","text":"","code":"modeldata_validate(   modeldata,   data = list(),   assumptions = list(),   defaults = modeldata_defaults() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/modeldata_validate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ensure that modeldata contains all necessary variables ‚Äî modeldata_validate","text":"modeldata list data variables (including priors) passed stan, alongside additional meta information descriptions. data list observation data provided sewer_data(). assumptions list assumptions provided sewer_assumptions(). defaults list default values used modeldata variables supplied modeldata. example, numeric(0) often supplied optional parameters.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/modeldata_validate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ensure that modeldata contains all necessary variables ‚Äî modeldata_validate","text":"error thrown due missing mandatory variables, modeldata object returned , optional variables replaced zero-length dimension defaults stan.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/modeldata_validate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Ensure that modeldata contains all necessary variables ‚Äî modeldata_validate","text":"reason defaults inserted missing optional variables stan explicitly allow default variables, specified little hack using zero-length dimensions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate measurement noise ‚Äî noise_estimate","title":"Estimate measurement noise ‚Äî noise_estimate","text":"option estimates unexplained variation wastewater measurements using constant coefficient variation model. multiple measurements (replicates) per sample provided, EpiSewer can also explicitly model variation replication stage. non-constant coefficient variation model, see noise_estimate_dPCR().","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate measurement noise ‚Äî noise_estimate","text":"","code":"noise_estimate(   replicates = FALSE,   cv_prior_mu = 0,   cv_prior_sigma = 1,   pre_replicate_cv_prior_mu = 0,   pre_replicate_cv_prior_sigma = 1,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate measurement noise ‚Äî noise_estimate","text":"replicates replicates used explicitly model variation replication stage? cv_prior_mu Prior (mean) coefficient variation concentration measurements. Note replicates=TRUE, CV replication stage (see details explanation). cv_prior_sigma Prior (standard deviation) coefficient variation concentration measurements. pre_replicate_cv_prior_mu Prior (mean) coefficient variation concentrations replication stage. pre_replicate_cv_prior_sigma Prior (standard deviation) coefficient variation concentrations replication stage. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate measurement noise ‚Äî noise_estimate","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate measurement noise ‚Äî noise_estimate","text":"replicates=TRUE, two coefficients variation estimated: CV replication stage (see pre_replicate_cv_prior_mu) CV replication stage (see cv_prior_mu) meaning CV estimates depends type replicates. replicates biological replicates (.e. independently processed), cv estimates noise preprocessing PCR, pre_replicate_cv estimates noise anything preprocessing (e.g. sampling noise unexplained variation). contrast, replicates technical replicates (.e. several PCR runs preprocessed sample), cv estimates PCR noise, pre_replicate_cv estimates noise (including preprocessing noise.) priors component following functional form: coefficient variation concentration measurements (cv): Truncated normal coefficient variation concentration replication stage (pre_replicate_cv): Truncated normal","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate_.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate measurement noise (internal helper function) ‚Äî noise_estimate_","title":"Estimate measurement noise (internal helper function) ‚Äî noise_estimate_","text":"option estimates unexplained variation wastewater measurements. multiple measurements (replicates) per sample provided, EpiSewer can also explicitly model variation replication stage. helper function called noise_estimate() noise_estimate_dPCR(). noise_estimate() constant coefficient variation model, noise_estimate_dPCR() noise model specialized digital PCR (cv_type = \"dPCR\"), may however also work quantification methods qPCR.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate_.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate measurement noise (internal helper function) ‚Äî noise_estimate_","text":"","code":"noise_estimate_(   replicates = FALSE,   cv_prior_mu = 0,   cv_prior_sigma = 1,   cv_type = \"constant\",   total_partitions_prior_mu = NULL,   total_partitions_prior_sigma = NULL,   total_partitions_observe = NULL,   partition_variation_prior_mu = NULL,   partition_variation_prior_sigma = NULL,   volume_scaled_prior_mu = NULL,   volume_scaled_prior_sigma = NULL,   pre_replicate_cv_prior_mu = 0,   pre_replicate_cv_prior_sigma = 1,   prePCR_noise_type = \"log-normal\",   use_taylor_approx = TRUE,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate_.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate measurement noise (internal helper function) ‚Äî noise_estimate_","text":"replicates replicates used explicitly model variation replication stage? cv_prior_mu Prior (mean) coefficient variation concentration measurements. Note replicates=TRUE, CV replication stage (see details explanation). cv_prior_sigma Prior (standard deviation) coefficient variation concentration measurements. cv_type One \"constant\" (default), \"constant_var\", \"dPCR\". \"constant\", coefficient variation estimated constant/single parameter observations. \"dPCR\", coefficient variation modeled function expected concentration according statistical properties dPCR. particular, model predicts higher coefficient variation smaller concentrations, often leads better model fit. \"constant_var\", coefficient variation variance measurements modeled constant. usually misspecification supported comparison purposes. total_partitions_prior_mu Prior (mean) total number partitions dPCR reaction. total_partitions_prior_sigma Prior (standard deviation) total number partitions dPCR reaction. set zero, total number partitions fixed prior mean estimated. total_partitions_observe TRUE, total number partitions taken supplied measurements data.frame. requires argument total_partitions_col specified concentrations_observe(). partition_variation_prior_mu Prior (mean) coefficient variation total number partitions dPCR reaction. Usually, maximum number partitions possible given dPCR chip reached, .e. certain number partitions lost. loss varies PCR runs, modeled log-normal distributed EpiSewer. partition_variation_prior_sigma Prior (standard deviation) coefficient variation total number partitions dPCR reaction. set zero, partition variation fixed prior mean estimated. volume_scaled_prior_mu Prior (mean) conversion factor (partition volume scaled dilution wastewater assay) dPCR reaction. See details explanation. volume_scaled_prior_sigma Prior (standard deviation) conversion factor (partition volume scaled dilution wastewater assay) dPCR reaction. set zero, conversion factor fixed prior mean estimated. pre_replicate_cv_prior_mu Prior (mean) coefficient variation concentrations replication stage. pre_replicate_cv_prior_sigma Prior (standard deviation) coefficient variation concentrations replication stage. prePCR_noise_type parametric distribution assume noise PCR assay. Currently supported \"log-normal\" \"gamma\". choice parametric distribution typically makes relevant difference noise model, can make relevant difference LOD model LOD_estimate_dPCR() used. use_taylor_approx TRUE (default), Taylor expansion approximation used estimate CV measurements pre-PCR noise. approximation accurate, unless concentrations extremely high (high quality measurements dPCR anyway questionable). modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate_.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate measurement noise (internal helper function) ‚Äî noise_estimate_","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate_constant_var.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate measurement noise with constant variance ‚Äî noise_estimate_constant_var","title":"Estimate measurement noise with constant variance ‚Äî noise_estimate_constant_var","text":"option estimates unexplained variation wastewater measurements using constant variance model. usually misspecification supported comparison purposes. constant coefficient variation model, see noise_estimate(), non-constant coefficient variation model, see noise_estimate_dPCR(). multiple measurements (replicates) per sample provided, EpiSewer can also explicitly model variation replication stage.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate_constant_var.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate measurement noise with constant variance ‚Äî noise_estimate_constant_var","text":"","code":"noise_estimate_constant_var(   replicates = FALSE,   cv_prior_mu = 0,   cv_prior_sigma = 1,   pre_replicate_cv_prior_mu = 0,   pre_replicate_cv_prior_sigma = 1,   warn = TRUE,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate_constant_var.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate measurement noise with constant variance ‚Äî noise_estimate_constant_var","text":"replicates replicates used explicitly model variation replication stage? cv_prior_mu Prior (mean) coefficient variation concentration measurements. Note replicates=TRUE, CV replication stage (see details explanation). cv_prior_sigma Prior (standard deviation) coefficient variation concentration measurements. pre_replicate_cv_prior_mu Prior (mean) coefficient variation concentrations replication stage. pre_replicate_cv_prior_sigma Prior (standard deviation) coefficient variation concentrations replication stage. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate_constant_var.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate measurement noise with constant variance ‚Äî noise_estimate_constant_var","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate_constant_var.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate measurement noise with constant variance ‚Äî noise_estimate_constant_var","text":"Note although model keeps variance constant, prior measurement noise still terms (average) coefficient variation (CV). makes prior specification easier since CV unitless. priors component following functional form: coefficient variation concentration measurements: Truncated normal coefficient variation concentration replication stage: Truncated normal","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate_dPCR.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate measurement noise for digital PCR data ‚Äî noise_estimate_dPCR","title":"Estimate measurement noise for digital PCR data ‚Äî noise_estimate_dPCR","text":"option estimates unexplained variation wastewater measurements using coefficient variation model specialized digital PCR (e.g. digital droplet PCR). Specifically, coefficient variation modeled function expected concentration according statistical properties dPCR. model predicts higher coefficient variation smaller concentrations, often leads better model fit, even measurements quantification methods qPCR. multiple measurements (replicates) per sample provided, EpiSewer can also explicitly model variation replication stage.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate_dPCR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate measurement noise for digital PCR data ‚Äî noise_estimate_dPCR","text":"","code":"noise_estimate_dPCR(   replicates = FALSE,   cv_prior_mu = 0,   cv_prior_sigma = 1,   total_partitions_prior_mu = 20000,   total_partitions_prior_sigma = 5000,   total_partitions_observe = FALSE,   partition_variation_prior_mu = 0,   partition_variation_prior_sigma = 0.05,   volume_scaled_prior_mu = 1e-05,   volume_scaled_prior_sigma = 4e-05,   pre_replicate_cv_prior_mu = 0,   pre_replicate_cv_prior_sigma = 1,   prePCR_noise_type = \"log-normal\",   use_taylor_approx = TRUE,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate_dPCR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate measurement noise for digital PCR data ‚Äî noise_estimate_dPCR","text":"replicates replicates used explicitly model variation replication stage? cv_prior_mu Prior (mean) coefficient variation concentration measurements. Note contrast using noise_estimate(), include technical noise digital PCR. dPCR noise explicitly modeled (using number partitions conversion factor). Moreover, replicates=TRUE, CV replication stage (see details explanation). cv_prior_sigma Prior (standard deviation) coefficient variation concentration measurements. total_partitions_prior_mu Prior (mean) total number partitions dPCR reaction. total_partitions_prior_sigma Prior (standard deviation) total number partitions dPCR reaction. set zero, total number partitions fixed prior mean estimated. total_partitions_observe TRUE, total number partitions taken supplied measurements data.frame. requires argument total_partitions_col specified concentrations_observe(). partition_variation_prior_mu Prior (mean) coefficient variation total number partitions dPCR reaction. Usually, maximum number partitions possible given dPCR chip reached, .e. certain number partitions lost. loss varies PCR runs, modeled log-normal distributed EpiSewer. partition_variation_prior_sigma Prior (standard deviation) coefficient variation total number partitions dPCR reaction. set zero, partition variation fixed prior mean estimated. volume_scaled_prior_mu Prior (mean) conversion factor (partition volume scaled dilution wastewater assay) dPCR reaction. See details explanation. volume_scaled_prior_sigma Prior (standard deviation) conversion factor (partition volume scaled dilution wastewater assay) dPCR reaction. set zero, conversion factor fixed prior mean estimated. pre_replicate_cv_prior_mu Prior (mean) coefficient variation concentrations replication stage. pre_replicate_cv_prior_sigma Prior (standard deviation) coefficient variation concentrations replication stage. prePCR_noise_type parametric distribution assume noise PCR assay. Currently supported \"log-normal\" \"gamma\". choice parametric distribution typically makes relevant difference noise model, can make relevant difference LOD model LOD_estimate_dPCR() used. use_taylor_approx TRUE (default), Taylor expansion approximation used estimate CV measurements pre-PCR noise. approximation accurate, unless concentrations extremely high (high quality measurements dPCR anyway questionable). modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate_dPCR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate measurement noise for digital PCR data ‚Äî noise_estimate_dPCR","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/noise_estimate_dPCR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate measurement noise for digital PCR data ‚Äî noise_estimate_dPCR","text":"conversion factor (see volume_scaled_prior_mu, volume_scaled_prior_sigma) partition volume scaled dilution wastewater assay. dilution accounts extraction preparation steps. example, partition volume 4.5e-7 mL dilution wastewater 100:3 (.e. 100 gc/mL original wastewater sample correspond 3 gc/mL PCR reaction), overall conversion factor 4.5e-7 * 100 / 3 = 1.5e-5. replicates=TRUE, two coefficients variation estimated: CV replication stage (see pre_replicate_cv_prior_mu) CV replication stage (see cv_prior_mu) meaning CV estimates depends type replicates. replicates biological replicates (.e. independently processed), cv estimates noise preprocessing PCR, pre_replicate_cv estimates noise anything preprocessing (e.g. sampling noise unexplained variation). contrast, replicates technical replicates (.e. several PCR runs preprocessed sample), cv estimates unexplained PCR noise (close zero), pre_replicate_cv estimates noise (including preprocessing noise.) priors component following functional form: coefficient variation concentration measurements (cv): Truncated normal mean number partitions dPCR: Truncated normal coefficient variation number partitions dPCR: Truncated normal conversion factor dPCR: Truncated normal coefficient variation concentration replication stage (pre_replicate_cv): Truncated normal","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/partitions_observe.html","id":null,"dir":"Reference","previous_headings":"","what":"Observe positive dPCR partition counts ‚Äî partitions_observe","title":"Observe positive dPCR partition counts ‚Äî partitions_observe","text":"option fits EpiSewer model positive partition counts digital PCR (dPCR), e.g. positive droplets ddPCR, pathogen target interest. allows use dPCR-specific likelihood using Poisson distribution. generic likelihood, see concentrations_observe().","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/partitions_observe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Observe positive dPCR partition counts ‚Äî partitions_observe","text":"","code":"partitions_observe(   data,   composite_window = 1,   date_col = \"date\",   positive_partitions_col = \"positive_partitions\",   total_partitions_col = \"total_partitions\",   replicate_col = NULL,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/partitions_observe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Observe positive dPCR partition counts ‚Äî partitions_observe","text":"modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/partitions_observe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Observe positive dPCR partition counts ‚Äî partitions_observe","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/place_knots.html","id":null,"dir":"Reference","previous_headings":"","what":"Places knots for fitting B-splines to a time series ‚Äî place_knots","title":"Places knots for fitting B-splines to a time series ‚Äî place_knots","text":"Places knots fitting B-splines time series","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/place_knots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Places knots for fitting B-splines to a time series ‚Äî place_knots","text":"","code":"place_knots(ts_length, knot_distance, partial_window = 30)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/place_knots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Places knots for fitting B-splines to a time series ‚Äî place_knots","text":"ts_length Length time series knot_distance Normal distance knots partial_window Window partial data towards present knot distances shorter. avoid erroneous extrapolation splines towards present.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/place_knots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Places knots for fitting B-splines to a time series ‚Äî place_knots","text":"vector knot positions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_LOD.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot limit of detection ‚Äî plot_LOD","title":"Plot limit of detection ‚Äî plot_LOD","text":"Helper function visualize assumed limit detection.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_LOD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot limit of detection ‚Äî plot_LOD","text":"","code":"plot_LOD(modeldata)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_LOD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot limit of detection ‚Äî plot_LOD","text":"modeldata modeldata object returned LOD_assume().","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_LOD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot limit of detection ‚Äî plot_LOD","text":"plot showing probability non-detection (.e. zero measurement) different concentrations assumed LOD. Can manipulated using ggplot2 functions adjust themes scales, add geoms.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_LOD.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot limit of detection ‚Äî plot_LOD","text":"function can also applied modeldata objects passed several modeling functions, long LOD_assume() applied point.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_LOD.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot limit of detection ‚Äî plot_LOD","text":"","code":"modeldata <- LOD_assume(limit = 2.56, prob = 0.95) plot_LOD(modeldata)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_R.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the effective reproduction number ‚Äî plot_R","title":"Plot the effective reproduction number ‚Äî plot_R","text":"Plots effective reproduction number time one several fitted EpiSewer models.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_R.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the effective reproduction number ‚Äî plot_R","text":"","code":"plot_R(   results,   draws = FALSE,   ndraws = NULL,   median = FALSE,   seeding = FALSE,   forecast = TRUE,   forecast_horizon = NULL,   date_margin_left = 0,   date_margin_right = 0,   facet_models = FALSE,   facet_direction = \"rows\",   base_model = \"\",   model_levels = NULL,   intervals = c(0.5, 0.95) )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_R.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the effective reproduction number ‚Äî plot_R","text":"results Results object returned EpiSewer() model fitting. Can also named list results different model runs, case results plotted together distinguished colors. draws FALSE (default), 50% 95% Bayesian credible intervals shown. TRUE, exemplary posterior samples shown \"spaghetti plot\" style. ndraws Number different samples show draws=TRUE. median estimated median shown, credible intervals? Default FALSE avoid -interpretation median. seeding Rt seeding phase shown well? Default FALSE. forecast forecasted Rt values shown? Default true. requires model fitted forecast horizon, see model_forecast(). forecast_horizon many days future forecasts plotted? Note restricted forecast horizon specified model fitting, see horizon_assume(). date_margin_left many days past plot expanded? Can also negative cut earliest dates. date_margin_right many days future plot expanded? Can also negative cut latest dates. facet_models plot faceted model? Default FALSE. facet_direction facetting done? Either different \"rows\" (default) different \"columns\". base_model Name base model (named list provided results) compared models. model plotted black part legend. model_levels character vector names models included. colors legend ordered according order model_levels.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_R.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the effective reproduction number ‚Äî plot_R","text":"ggplot object showing time series estimated Rt, either credible intervals \"spaghetti plot\". Can manipulated using ggplot2 functions adjust themes scales, add geoms.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_concentration.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot predicted concentration ‚Äî plot_concentration","title":"Plot predicted concentration ‚Äî plot_concentration","text":"Plots measured /predicted concentrations time. predicted concentrations taken fitted EpiSewer model.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_concentration.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot predicted concentration ‚Äî plot_concentration","text":"","code":"plot_concentration(   results = NULL,   measurements = NULL,   flows = NULL,   include_noise = TRUE,   normalized = FALSE,   median = FALSE,   mark_outliers = FALSE,   forecast = TRUE,   forecast_horizon = NULL,   date_margin_left = 0,   date_margin_right = 1,   facet_models = FALSE,   facet_direction = \"rows\",   base_model = \"\",   model_levels = NULL,   concentration_col = \"concentration\",   flow_col = \"flow\",   date_col = \"date\",   outlier_col = \"is_outlier\",   type = \"time\",   intervals = c(0.5, 0.95) )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_concentration.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot predicted concentration ‚Äî plot_concentration","text":"results Results object returned EpiSewer() model fitting. Can also named list results different model runs, case results plotted together distinguished colors. measurements data.frame observed measurements, plotted alongside predicted values (useful assess model fit). Can also used results = NULL, case observed measurements plotted. flows data.frame observed flows. normalized = TRUE, used normalize estimated observed concentrations median flow. include_noise TRUE (default), concentrations including measurement noise shown. FALSE, expected concentrations shown. normalized TRUE, estimated observed concentrations normalized median flow. Thereby, noise concentrations due variation flow essentially removed. especially useful assessing forecasting performance future flow values known model fitting. median estimated median shown, credible intervals? Default FALSE avoid -interpretation median. mark_outliers TRUE, outliers measurements highlighted red. See also argument outlier_col . forecast forecasted concentrations shown? Default true. requires model fitted forecast horizon, see model_forecast(). concentrations depend flow volume, accurate concentration forecasts possible flow values beyond estimation date provided. typically possible estimating retrospectively. flow values beyond estimation date available, forecasted concentrations based median flow volume. forecast_horizon many days future forecasts plotted? Note restricted forecast horizon specified model fitting, see horizon_assume(). date_margin_left many days past plot expanded? Can also negative cut earliest dates. date_margin_right many days future plot expanded? Can also negative cut latest dates. default, 1 improve visibility latest date. facet_models plot faceted model? Default FALSE. facet_direction facetting done? Either different \"rows\" (default) different \"columns\". base_model Name base model (named list provided results) compared models. model plotted black part legend. model_levels character vector names models included. colors legend ordered according order model_levels. concentration_col Name column measurements data.frame contains measured concentration plotted. date_col Name date column measurements data.frame. outlier_col Name logical column measurements data.frame identifies outlier measurements (example added mark_outlier_spikes_median()). type \"time\" (default), concentration time series plotted. \"pp_check\", observations ordered concentration plotted predicted concentration (useful posterior predictive checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_concentration.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot predicted concentration ‚Äî plot_concentration","text":"ggplot object showing predicted observed concentrations time. Can manipulated using ggplot2 functions adjust themes scales, add geoms.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_concentration.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot predicted concentration ‚Äî plot_concentration","text":"plotting posterior predictive check (type=\"pp_check\"), observed concentration shown together 95% Credible Interval posterior predictive distribution observation. observations ordered concentration, helps visualize bias variance predictions function concentration.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_doubling_time.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the epidemic doubling time ‚Äî plot_doubling_time","title":"Plot the epidemic doubling time ‚Äî plot_doubling_time","text":"Plots estimated time-varying doubling time fitted EpiSewer model.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_doubling_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the epidemic doubling time ‚Äî plot_doubling_time","text":"","code":"plot_doubling_time(   results,   median = FALSE,   seeding = FALSE,   forecast = TRUE,   forecast_horizon = NULL,   date_margin_left = 0,   date_margin_right = 0,   facet_models = FALSE,   facet_direction = \"rows\",   base_model = \"\",   model_levels = NULL,   intervals = c(0.5, 0.95) )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_doubling_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the epidemic doubling time ‚Äî plot_doubling_time","text":"results Results object returned EpiSewer() model fitting. Can also named list results different model runs, case results plotted together distinguished colors. median estimated median shown, credible intervals? Default FALSE avoid -interpretation median. seeding infections seeding phase shown well? Default FALSE. forecast forecasted doubling times shown? Default true. requires model fitted forecast horizon, see model_forecast(). forecast_horizon many days future forecasts plotted? Note restricted forecast horizon specified model fitting, see horizon_assume(). date_margin_left many days past plot expanded? Can also negative cut earliest dates. date_margin_right many days future plot expanded? Can also negative cut latest dates. facet_models plot faceted model? Default FALSE. facet_direction facetting done? Either different \"rows\" (default) different \"columns\". base_model Name base model (named list provided results) compared models. model plotted black part legend. model_levels character vector names models included. colors legend ordered according order model_levels.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_doubling_time.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the epidemic doubling time ‚Äî plot_doubling_time","text":"ggplot object showing estimated time-varying doubling time. Can manipulated using ggplot2 functions adjust themes scales, add geoms.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_growth_rate.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the epidemic growth rate ‚Äî plot_growth_rate","title":"Plot the epidemic growth rate ‚Äî plot_growth_rate","text":"Plots estimated growth rate time fitted EpiSewer model.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_growth_rate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the epidemic growth rate ‚Äî plot_growth_rate","text":"","code":"plot_growth_rate(   results,   median = FALSE,   seeding = FALSE,   forecast = TRUE,   forecast_horizon = NULL,   date_margin_left = 0,   date_margin_right = 0,   facet_models = FALSE,   facet_direction = \"rows\",   base_model = \"\",   model_levels = NULL,   intervals = c(0.5, 0.95) )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_growth_rate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the epidemic growth rate ‚Äî plot_growth_rate","text":"results Results object returned EpiSewer() model fitting. Can also named list results different model runs, case results plotted together distinguished colors. median estimated median shown, credible intervals? Default FALSE avoid -interpretation median. seeding infections seeding phase shown well? Default FALSE. forecast forecasted growth rates shown? Default true. requires model fitted forecast horizon, see model_forecast(). forecast_horizon many days future forecasts plotted? Note restricted forecast horizon specified model fitting, see horizon_assume(). date_margin_left many days past plot expanded? Can also negative cut earliest dates. date_margin_right many days future plot expanded? Can also negative cut latest dates. facet_models plot faceted model? Default FALSE. facet_direction facetting done? Either different \"rows\" (default) different \"columns\". base_model Name base model (named list provided results) compared models. model plotted black part legend. model_levels character vector names models included. colors legend ordered according order model_levels.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_growth_rate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the epidemic growth rate ‚Äî plot_growth_rate","text":"ggplot object showing estimated growth rate time. Can manipulated using ggplot2 functions adjust themes scales, add geoms.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_growth_report.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a growth report ‚Äî plot_growth_report","title":"Plot a growth report ‚Äî plot_growth_report","text":"given date, growth report shows probability infections growing constantly least 3, 7, 14, 21, 28 days, respectively. report uses diverging bar plot scaled \"unlikely\" (0% posterior probability) \"likely\" (100% posterior probability).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_growth_report.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a growth report ‚Äî plot_growth_report","text":"","code":"plot_growth_report(result, date = NULL, partial_prob = 0.8)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_growth_report.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a growth report ‚Äî plot_growth_report","text":"result Results object returned EpiSewer() model fitting. contrast plotting functions, list multiple result objects, growth report plots always single model fit. date date growth report plotted. NULL, recent date reliable report can provided automatically selected, see partial_prob. Note date backward looking. example, date=\"2022-03-01\", get probability growing last 3, 7, 14, 21, 28 days date. partial_prob select recent reliable date, subtract certain quantile shedding load distribution current date. example, partial_prob=0.8 (default), select date 80% shedding load individuals infected date shed.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_growth_report.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a growth report ‚Äî plot_growth_report","text":"growth report plot showing probability infections growing without interruption least 3, 7, 14, 21, 28 days, respectively. Can manipulated using ggplot2 functions adjust themes scales, add geoms.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_infections.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot infections ‚Äî plot_infections","title":"Plot infections ‚Äî plot_infections","text":"Plots estimated number infections time one several fitted EpiSewer models.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_infections.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot infections ‚Äî plot_infections","text":"","code":"plot_infections(   results,   draws = FALSE,   ndraws = NULL,   median = FALSE,   seeding = FALSE,   forecast = TRUE,   forecast_horizon = NULL,   date_margin_left = 0,   date_margin_right = 0,   facet_models = FALSE,   facet_direction = \"rows\",   base_model = \"\",   model_levels = NULL,   intervals = c(0.5, 0.95) )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_infections.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot infections ‚Äî plot_infections","text":"results Results object returned EpiSewer() model fitting. Can also named list results different model runs, case results plotted together distinguished colors. draws FALSE (default), 50% 95% Bayesian credible intervals shown. TRUE, exemplary posterior samples shown \"spaghetti plot\" style. ndraws Number different samples show draws=TRUE. median estimated median shown, credible intervals? Default FALSE avoid -interpretation median. seeding infections seeding phase shown well? Default FALSE. forecast forecasted infections shown? Default true. requires model fitted forecast horizon, see model_forecast(). forecast_horizon many days future forecasts plotted? Note restricted forecast horizon specified model fitting, see horizon_assume(). date_margin_left many days past plot expanded? Can also negative cut earliest dates. date_margin_right many days future plot expanded? Can also negative cut latest dates. facet_models plot faceted model? Default FALSE. facet_direction facetting done? Either different \"rows\" (default) different \"columns\". base_model Name base model (named list provided results) compared models. model plotted black part legend. model_levels character vector names models included. colors legend ordered according order model_levels.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_infections.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot infections ‚Äî plot_infections","text":"ggplot object showing time series estimated infections, either credible intervals \"spaghetti plot\". Can manipulated using ggplot2 functions adjust themes scales, add geoms.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_load.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the estimated load ‚Äî plot_load","title":"Plot the estimated load ‚Äî plot_load","text":"Plots estimated load wastewater time fitted EpiSewer model.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_load.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the estimated load ‚Äî plot_load","text":"","code":"plot_load(   results,   median = FALSE,   forecast = TRUE,   forecast_horizon = NULL,   date_margin_left = 0,   date_margin_right = 0,   facet_models = FALSE,   facet_direction = \"rows\",   base_model = \"\",   model_levels = NULL,   intervals = c(0.5, 0.95) )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_load.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the estimated load ‚Äî plot_load","text":"results Results object returned EpiSewer() model fitting. Can also named list results different model runs, case results plotted together distinguished colors. median estimated median shown, credible intervals? Default FALSE avoid -interpretation median. forecast forecasted loads shown? Default true. requires model fitted forecast horizon, see model_forecast(). forecast_horizon many days future forecasts plotted? Note restricted forecast horizon specified model fitting, see horizon_assume(). date_margin_left many days past plot expanded? Can also negative cut earliest dates. date_margin_right many days future plot expanded? Can also negative cut latest dates. facet_models plot faceted model? Default FALSE. facet_direction facetting done? Either different \"rows\" (default) different \"columns\". base_model Name base model (named list provided results) compared models. model plotted black part legend. model_levels character vector names models included. colors legend ordered according order model_levels.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_load.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the estimated load ‚Äî plot_load","text":"ggplot object showing estimated load time. Can manipulated using ggplot2 functions adjust themes scales, add geoms.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_prior_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Visually compare prior and posterior of a model parameter ‚Äî plot_prior_posterior","title":"Visually compare prior and posterior of a model parameter ‚Äî plot_prior_posterior","text":"Visually compare prior posterior model parameter","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_prior_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visually compare prior and posterior of a model parameter ‚Äî plot_prior_posterior","text":"","code":"plot_prior_posterior(result, param_name)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_prior_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visually compare prior and posterior of a model parameter ‚Äî plot_prior_posterior","text":"result Results object returned EpiSewer() model fitting. contrast plotting functions, list multiple result objects, prior-posterior plots multiple results simultaneously currently supported. param_name Name single parameter plotted. can either raw name parameter stan model, can semantic name single parameter dictionary (see details). Note must single parameter, parameter array. Also, original parameters (transformed parameters) prior can specified EpiSewer supported.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_prior_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visually compare prior and posterior of a model parameter ‚Äî plot_prior_posterior","text":"plot showing density prior (grey) posterior (blue) respective parameter. Can manipulated using ggplot2 functions adjust themes scales, add geoms.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_prior_posterior.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Visually compare prior and posterior of a model parameter ‚Äî plot_prior_posterior","text":"following parameters can visualized (model): measurement_noise_cv (nu_upsilon_a): Coefficient variation (measurement noise) dPCR_total_partitions (nu_upsilon_b_mu): Average total number partitions dPCR dPCR_partition_variation (nu_upsilon_b_cv): Partition number variation dPCR dPCR_conversion_factor (nu_upsilon_c): Conversion factor dPCR pre_replicate_cv (nu_psi): Coefficient variation (pre-PCR noise) load_variation_cv (nu_zeta): Individual-level coefficient load variation infection_overdispersion (I_xi): Overdispersion infections seeding_intercept (iota_log_seed_intercept): Initial number infections","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_sample_effects.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot estimated sample effects ‚Äî plot_sample_effects","title":"Plot estimated sample effects ‚Äî plot_sample_effects","text":"Plots estimated effect sizes sample covariates 95% credible intervals. works EpiSewer model included sample covariates, see e.g. sample_effects_estimate_matrix().","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_sample_effects.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot estimated sample effects ‚Äî plot_sample_effects","text":"","code":"plot_sample_effects(   results,   facet_models = FALSE,   facet_direction = \"rows\",   model_levels = NULL )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_sample_effects.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot estimated sample effects ‚Äî plot_sample_effects","text":"results Results object returned EpiSewer() model fitting. Can also named list results different model runs, case results plotted together distinguished colors. facet_models plot faceted model? Default FALSE. facet_direction facetting done? Either different \"rows\" (default) different \"columns\". model_levels character vector names models included. colors legend ordered according order model_levels.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/plot_sample_effects.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot estimated sample effects ‚Äî plot_sample_effects","text":"ggplot object showing estimated effect sizes. Can manipulated using ggplot2 functions adjust themes scales, add geoms.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.EpiSewerJob.html","id":null,"dir":"Reference","previous_headings":"","what":"Print an EpiSewerJob. ‚Äî print.EpiSewerJob","title":"Print an EpiSewerJob. ‚Äî print.EpiSewerJob","text":"Print EpiSewerJob.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.EpiSewerJob.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print an EpiSewerJob. ‚Äî print.EpiSewerJob","text":"","code":"# S3 method for class 'EpiSewerJob' print(x)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.EpiSewerJobResult.html","id":null,"dir":"Reference","previous_headings":"","what":"Print an EpiSewerJobResult. ‚Äî print.EpiSewerJobResult","title":"Print an EpiSewerJobResult. ‚Äî print.EpiSewerJobResult","text":"Print EpiSewerJobResult.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.EpiSewerJobResult.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print an EpiSewerJobResult. ‚Äî print.EpiSewerJobResult","text":"","code":"# S3 method for class 'EpiSewerJobResult' print(x)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.modeldata.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a modeldata object ‚Äî print.modeldata","title":"Print a modeldata object ‚Äî print.modeldata","text":"Print modeldata object","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.modeldata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a modeldata object ‚Äî print.modeldata","text":"","code":"# S3 method for class 'modeldata' print(x, type = \"structure\")"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.modeldata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a modeldata object ‚Äî print.modeldata","text":"type \"structure\", model structure printed. \"data\", modeldata content (data, inits, metainfo) printed.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.modelstructure.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a modelstructure object ‚Äî print.modelstructure","title":"Print a modelstructure object ‚Äî print.modelstructure","text":"Print modelstructure object","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.modelstructure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a modelstructure object ‚Äî print.modelstructure","text":"","code":"# S3 method for class 'modelstructure' print(.str)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.tbc.html","id":null,"dir":"Reference","previous_headings":"","what":"Print to-be-computed object ‚Äî print.tbc","title":"Print to-be-computed object ‚Äî print.tbc","text":"Print --computed object","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.tbc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print to-be-computed object ‚Äî print.tbc","text":"","code":"# S3 method for class 'tbc' print(x)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.tbe.html","id":null,"dir":"Reference","previous_headings":"","what":"Print to-be-evaluated object ‚Äî print.tbe","title":"Print to-be-evaluated object ‚Äî print.tbe","text":"Print --evaluated object","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.tbe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print to-be-evaluated object ‚Äî print.tbe","text":"","code":"# S3 method for class 'tbe' print(x)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.tbp.html","id":null,"dir":"Reference","previous_headings":"","what":"Print to-be-provided object ‚Äî print.tbp","title":"Print to-be-provided object ‚Äî print.tbp","text":"Print --provided object","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/print.tbp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print to-be-provided object ‚Äî print.tbp","text":"","code":"# S3 method for class 'tbp' print(x)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/rep_each_v.html","id":null,"dir":"Reference","previous_headings":"","what":"Vectorized version of rep with each argument, each can be a vector ‚Äî rep_each_v","title":"Vectorized version of rep with each argument, each can be a vector ‚Äî rep_each_v","text":"Vectorized version rep argument, can vector","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/rep_each_v.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Vectorized version of rep with each argument, each can be a vector ‚Äî rep_each_v","text":"","code":"rep_each_v(x, each)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/residence_dist_assume.html","id":null,"dir":"Reference","previous_headings":"","what":"Assume a sewer residence time distribution ‚Äî residence_dist_assume","title":"Assume a sewer residence time distribution ‚Äî residence_dist_assume","text":"option assumes fixed residence time distribution pathogen particles. default, EpiSewer assumes particles arrive sampling site within day shedding. However, larger sewage systems, particles may travel longer day depending shed wastewater.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/residence_dist_assume.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assume a sewer residence time distribution ‚Äî residence_dist_assume","text":"","code":"residence_dist_assume(residence_dist = NULL, modeldata = modeldata_init())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/residence_dist_assume.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assume a sewer residence time distribution ‚Äî residence_dist_assume","text":"residence_dist numeric vector representing discrete residence time distribution, elements describing share load takes 0 days, 1 day, 2 days, arrive sampling site. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/residence_dist_assume.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assume a sewer residence time distribution ‚Äî residence_dist_assume","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/residence_dist_assume.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assume a sewer residence time distribution ‚Äî residence_dist_assume","text":"","code":"# Particles arrive within the same day residence_dist_assume(residence_dist = c(1)) #> sewage #>  |- residence_dist_assume  # Particles always arrive after one day residence_dist_assume(residence_dist = c(0, 1)) #> sewage #>  |- residence_dist_assume  # 1/4 of particles only arrives after one day residence_dist_assume(residence_dist = c(0.75, 0.25)) #> sewage #>  |- residence_dist_assume"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/run.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit an EpiSewer model. ‚Äî run","title":"Fit an EpiSewer model. ‚Äî run","text":"function allows (re-)run model fitting existing EpiSewerJob object. especially useful combined run_fit=FALSE option EpiSewer(). allows first create EpiSewerJob object run model fitting later different machine.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit an EpiSewer model. ‚Äî run","text":"","code":"run(job)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit an EpiSewer model. ‚Äî run","text":"job EpiSewerJob object returned EpiSewer().","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sample_effects_estimate_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate sample effects using a design matrix ‚Äî sample_effects_estimate_matrix","title":"Estimate sample effects using a design matrix ‚Äî sample_effects_estimate_matrix","text":"option uses log-linear regression model estimate effects sample covariates concentration. Concentrations can influenced sampling-related external factors, example time sampling shipping lab (age--sample effect), different sampling storage methods.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sample_effects_estimate_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate sample effects using a design matrix ‚Äî sample_effects_estimate_matrix","text":"","code":"sample_effects_estimate_matrix(   design_matrix,   effect_prior_mu = 0,   effect_prior_sigma = 1,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sample_effects_estimate_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate sample effects using a design matrix ‚Äî sample_effects_estimate_matrix","text":"design_matrix design matrix different covariates potentially influencing sample concentration. matrix must one row modeled day. See stats::model.matrix() construction design matrices. effect_prior_mu Prior (mean) regression coefficients. effect_prior_sigma Prior (standard deviation) regression coefficients. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sample_effects_estimate_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate sample effects using a design matrix ‚Äî sample_effects_estimate_matrix","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sample_effects_estimate_matrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate sample effects using a design matrix ‚Äî sample_effects_estimate_matrix","text":"EpiSewer fit fixed-effects log-linear model, random effects currently supported. priors component following functional form: regression coefficients: Normal","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sample_effects_estimate_weekday.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate weekday sample effects ‚Äî sample_effects_estimate_weekday","title":"Estimate weekday sample effects ‚Äî sample_effects_estimate_weekday","text":"option uses log-linear regression model estimate sample weekday effects concentration. Concentrations can influenced time sampling shipping lab (age--sample effect), shipment follows weekly batch scheme, sampling weekday good proxy age shipment.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sample_effects_estimate_weekday.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate weekday sample effects ‚Äî sample_effects_estimate_weekday","text":"","code":"sample_effects_estimate_weekday(   effect_prior_mu = 0,   effect_prior_sigma = 1,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sample_effects_estimate_weekday.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate weekday sample effects ‚Äî sample_effects_estimate_weekday","text":"effect_prior_mu Prior (mean) regression coefficients. effect_prior_sigma Prior (standard deviation) regression coefficients. modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sample_effects_estimate_weekday.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate weekday sample effects ‚Äî sample_effects_estimate_weekday","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sample_effects_estimate_weekday.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate weekday sample effects ‚Äî sample_effects_estimate_weekday","text":"Effects estimated weekdays Monday - Saturday, Sunday baseline. EpiSewer fit fixed-effects log-linear model, random effects currently supported. priors component following functional form: regression coefficients: Normal","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sample_effects_none.html","id":null,"dir":"Reference","previous_headings":"","what":"Do not model sample effects ‚Äî sample_effects_none","title":"Do not model sample effects ‚Äî sample_effects_none","text":"option model effects sample covariates concentrations.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sample_effects_none.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Do not model sample effects ‚Äî sample_effects_none","text":"","code":"sample_effects_none(modeldata = modeldata_init())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sample_effects_none.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Do not model sample effects ‚Äî sample_effects_none","text":"modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sample_effects_none.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Do not model sample effects ‚Äî sample_effects_none","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sampler_stan_mcmc.html","id":null,"dir":"Reference","previous_headings":"","what":"Use the stan MCMC sampler ‚Äî sampler_stan_mcmc","title":"Use the stan MCMC sampler ‚Äî sampler_stan_mcmc","text":"option use stan's NUTS sampler via cmdstanr Markov Chain Monte Carlo (MCMC) sampling EpiSewer model.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sampler_stan_mcmc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use the stan MCMC sampler ‚Äî sampler_stan_mcmc","text":"","code":"sampler_stan_mcmc(   chains = 4,   iter_warmup = 500,   iter_sampling = 500,   adapt_delta = 0.99,   max_treedepth = 15,   step_size = 0.01,   parallel_chains = NULL,   threads_per_chain = 1,   seed = 0,   refresh = 200,   show_messages = TRUE,   show_exceptions = FALSE,   ... )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sampler_stan_mcmc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use the stan MCMC sampler ‚Äî sampler_stan_mcmc","text":"chains (positive integer) number Markov chains run. default 4. iter_warmup (positive integer) number warmup iterations run per chain. Note: CmdStan User's Guide referred num_warmup. iter_sampling (positive integer) number post-warmup iterations run per chain. Note: CmdStan User's Guide referred num_samples. adapt_delta (real (0,1)) adaptation target acceptance statistic. max_treedepth (positive integer) maximum allowed tree depth NUTS engine. See Tree Depth section CmdStan User's Guide details. step_size (positive real) initial step size discrete approximation continuous Hamiltonian dynamics. tuned warmup. parallel_chains (positive integer) maximum number MCMC chains run parallel. parallel_chains specified default look option \"mc.cores\", can set entire R session options(mc.cores=value). \"mc.cores\" option set default 1. threads_per_chain (positive integer) model compiled threading support, number threads use parallelized sections within MCMC chain (e.g., using Stan functions reduce_sum() map_rect()). contrast parallel_chains, specifies number chains run parallel. actual number CPU cores used parallel_chains*threads_per_chain. example using threading see Stan case study Reduce Sum: Minimal Example. seed (positive integer(s)) seed (P)RNG pass CmdStan. case multi-chain sampling single seed automatically augmented run (chain) ID chain uses different seed. exception transformed data block, defaults using seed chains data generated chains RNG functions used. time seed specified vector (one element per chain) RNG functions used transformed data goal generate different data chain. refresh (non-negative integer) number iterations printed screen updates. refresh = 0, error messages printed. show_messages (logical) TRUE (default), prints output execution process, iteration numbers elapsed times. output silenced $output() method resulting fit object can used display silenced messages. show_exceptions (logical) TRUE (default), prints informational messages, example rejection current proposal. Disable wish silence messages, usually recommended unless confident model correct numerical error. messages silenced $output() method resulting fit object can used display silenced messages. ... arguments pass cmdstanr.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sampler_stan_mcmc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use the stan MCMC sampler ‚Äî sampler_stan_mcmc","text":"list settings MCMC sampler.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/seeding_estimate_constant.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate constant seeding infections ‚Äî seeding_estimate_constant","title":"Estimate constant seeding infections ‚Äî seeding_estimate_constant","text":"option estimates constant number infections start modeled time period.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/seeding_estimate_constant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate constant seeding infections ‚Äî seeding_estimate_constant","text":"","code":"seeding_estimate_constant(   intercept_prior_q5 = NULL,   intercept_prior_q95 = NULL,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/seeding_estimate_constant.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate constant seeding infections ‚Äî seeding_estimate_constant","text":"intercept_prior_q5 Prior (5% quantile) initial number infections. Can interpreted approximate lower bound. NULL (default), computed crude empirical estimate number cases (see details). intercept_prior_q95 Prior (95% quantile) initial number infections. Can interpreted approximate upper bound. NULL (default), computed crude empirical estimate number cases (see details). modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/seeding_estimate_constant.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate constant seeding infections ‚Äî seeding_estimate_constant","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/seeding_estimate_constant.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate constant seeding infections ‚Äî seeding_estimate_constant","text":"seeding phase length maximum generation time (time, renewal model applied). assumed expected number new infections stays constant time period. assumption can however violated: traditionally, seeding refers first (potentially imported) infections epidemic, depending time period model fitted , may also cover different phase stronger growth dynamics. Thus, data starts middle epidemic wave, recommended use seeding_estimate_rw() instead seeding_estimate_constant(). intercept_prior_q5 intercept_prior_q95 specified user, EpiSewer compute rough median empirical estimate number cases using supplied wastewater measurements shedding assumptions, infer missing quantiles based . none quantiles provided, set roughly 1/10 10 times empirical median estimate. note violation Bayesian principles (data must used inform priors) - neglectable one, since ensures seeding modeled right order magnitude relevant impacts later Rt estimates. priors component following functional form: initial number infections (log scale): Normal","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/seeding_estimate_rw.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate seeding infections using a random walk model ‚Äî seeding_estimate_rw","title":"Estimate seeding infections using a random walk model ‚Äî seeding_estimate_rw","text":"option estimates initial infections start modeled time period, renewal model applied yet. uses geometric random walk model seeding infections.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/seeding_estimate_rw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate seeding infections using a random walk model ‚Äî seeding_estimate_rw","text":"","code":"seeding_estimate_rw(   intercept_prior_q5 = NULL,   intercept_prior_q95 = NULL,   rel_change_prior_mu = 0.05,   rel_change_prior_sigma = 0.025,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/seeding_estimate_rw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate seeding infections using a random walk model ‚Äî seeding_estimate_rw","text":"intercept_prior_q5 Prior (5% quantile) initial number infections. Can interpreted approximate lower bound. NULL (default), computed crude empirical estimate number cases (see details). intercept_prior_q95 Prior (95% quantile) initial number infections. Can interpreted approximate upper bound. NULL (default), computed crude empirical estimate number cases (see details). rel_change_prior_mu Prior (mean) relative change rate geometric random walk seeding phase. default value (0.05) assumes daily changes +-5% expectation likely less +-10% per day. rel_change_prior_sigma Prior (standard deviation) relative change rate geometric random walk seeding phase. expresses uncertainty change rate. default value (0.025) assumes daily change rate 5% points higher lower prior mean. example, rel_change_prior_mu = 0.05 rel_change_prior_sigma = 0.025, means expect daily change rate 0 (0%) 0.1 (10%). modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/seeding_estimate_rw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate seeding infections using a random walk model ‚Äî seeding_estimate_rw","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/seeding_estimate_rw.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate seeding infections using a random walk model ‚Äî seeding_estimate_rw","text":"seeding phase length maximum generation time (time, renewal model applied). Traditionally, seeding refers first (potentially imported) infections epidemic, depending time period model fitted , may also cover different phase stronger growth dynamics. intercept_prior_q5 intercept_prior_q95 specified user, EpiSewer compute rough median empirical estimate number cases using supplied wastewater measurements shedding assumptions, infer missing quantiles based . none quantiles provided, set roughly 1/10 10 times empirical median estimate. note violation Bayesian principles (data must used inform priors) - neglectable one, since ensures seeding modeled right order magnitude relevant impacts later Rt estimates. priors component following functional form: intercept random walk (log scale): Normal standard deviation random walk (log scale): Truncated normal priors parameters determined based user-supplied arguments, using appropriate transformations two-sigma-rule thumb.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_fit_opts.html","id":null,"dir":"Reference","previous_headings":"","what":"Configure the model fitting ‚Äî set_fit_opts","title":"Configure the model fitting ‚Äî set_fit_opts","text":"Sets model fitting options EpiSewer.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_fit_opts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Configure the model fitting ‚Äî set_fit_opts","text":"","code":"set_fit_opts(sampler = sampler_stan_mcmc(), model = model_stan_opts())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_fit_opts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Configure the model fitting ‚Äî set_fit_opts","text":"sampler type sampler used model fitting? Currently, sampler_stan_mcmc() supported. model Details model file used, see model_stan_opts(). also makes possible users supply customized models. results Details results returned, see set_results_opts(). example, credible intervals use summarizing posterior distributions whether return fitted model object.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_fit_opts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Configure the model fitting ‚Äî set_fit_opts","text":"list model fitting options.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_fit_opts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Configure the model fitting ‚Äî set_fit_opts","text":"","code":"ww_data <- ww_data_SARS_CoV_2_Zurich ww_assumptions <- ww_assumptions_SARS_CoV_2_Zurich  ww_fit_opts <- set_fit_opts(   sampler = sampler_stan_mcmc(     chains = 2,     parallel_chains = 2,     iter_warmup = 400,     iter_sampling = 400,     seed = 42 # ensures reproducibility   ) )  ww_results_opts <- set_results_opts(   fitted = TRUE, # return full model fit   summary_intervals = c(0.5, 0.8, 0.95),   samples_ndraws = 100 )  if (FALSE) ww_result <- EpiSewer(   data = ww_data,   assumptions = ww_assumptions,   fit_opts = ww_fit_opts,   results_opts = ww_results_opts ) # \\dontrun{}"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Define a prior in modeldata ‚Äî set_prior","title":"Define a prior in modeldata ‚Äî set_prior","text":"Define prior modeldata","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define a prior in modeldata ‚Äî set_prior","text":"","code":"set_prior(param, dist = \"normal\", ...)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_prior_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"Define a normal prior in modeldata ‚Äî set_prior_normal","title":"Define a normal prior in modeldata ‚Äî set_prior_normal","text":"Define normal prior modeldata","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_prior_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define a normal prior in modeldata ‚Äî set_prior_normal","text":"","code":"set_prior_normal(param, mu, sigma = NULL, two_sigma = NULL)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_prior_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define a normal prior in modeldata ‚Äî set_prior_normal","text":"param Name parameter prior defined. mu Mean. sigma Standard deviation. two_sigma Two times standard deviation. Useful defining priors via two-sigma rule--thumb (approximately 95% probability mass).","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_prior_normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Define a normal prior in modeldata ‚Äî set_prior_normal","text":"Prior specification modeldata.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_prior_normal_log.html","id":null,"dir":"Reference","previous_headings":"","what":"Define a normal prior on the log scale in modeldata using median and factor ‚Äî set_prior_normal_log","title":"Define a normal prior on the log scale in modeldata using median and factor ‚Äî set_prior_normal_log","text":"parameterization useful define best guess value parameter (median), maximum factor expect deviate guess.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_prior_normal_log.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define a normal prior on the log scale in modeldata using median and factor ‚Äî set_prior_normal_log","text":"","code":"set_prior_normal_log(   param,   unit_median = NULL,   unit_q5 = NULL,   unit_q95 = NULL,   unit_factor = NULL,   paste_dist = \"\" )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_prior_normal_log.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define a normal prior on the log scale in modeldata using median and factor ‚Äî set_prior_normal_log","text":"param Name parameter prior defined. unit_median Median unit/natural scale. unit_q5 5% quantile distribution unit scale. unit_q95 95% quantile distribution unit scale. unit_factor factor expect true parameter value differ prior median? example, unit_factor = 2 mean expect true parameter twice prior median, least half prior median. uses two-sigma rule--thumb. Must specified together unit_median. paste_dist Additional information pasted dist description.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_prior_normal_log.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Define a normal prior on the log scale in modeldata using median and factor ‚Äî set_prior_normal_log","text":"Prior specification modeldata.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_prior_normal_log.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Define a normal prior on the log scale in modeldata using median and factor ‚Äî set_prior_normal_log","text":"normal prior log scale effectively log-normal prior unit/natural scale.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_results_opts.html","id":null,"dir":"Reference","previous_headings":"","what":"Configure results returned after model fitting ‚Äî set_results_opts","title":"Configure results returned after model fitting ‚Äî set_results_opts","text":"Configure results returned model fitting","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_results_opts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Configure results returned after model fitting ‚Äî set_results_opts","text":"","code":"set_results_opts(   fitted = TRUE,   summary_intervals = c(0.5, 0.95),   samples_ndraws = 50 )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_results_opts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Configure results returned after model fitting ‚Äî set_results_opts","text":"fitted TRUE (default), fitted model object also returned, summaries model fitting. Note makes results object substantially larger. summary_intervals credible intervals (CrIs) used summarize posterior distributions? Default c(0.5, 0.95), .e. 50% 95% CrI returned samples_ndraws Number exemplary posterior samples return. Note summaries always use available samples.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_results_opts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Configure results returned after model fitting ‚Äî set_results_opts","text":"list settings results.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/set_results_opts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Configure results returned after model fitting ‚Äî set_results_opts","text":"","code":"ww_data <- ww_data_SARS_CoV_2_Zurich ww_assumptions <- ww_assumptions_SARS_CoV_2_Zurich  ww_fit_opts <- set_fit_opts(   sampler = sampler_stan_mcmc(     chains = 2,     parallel_chains = 2,     iter_warmup = 400,     iter_sampling = 400,     seed = 42 # ensures reproducibility   ) )  ww_results_opts <- set_results_opts(   fitted = TRUE, # return full model fit   summary_intervals = c(0.5, 0.8, 0.95),   samples_ndraws = 100 )  if (FALSE) ww_result <- EpiSewer(   data = ww_data,   assumptions = ww_assumptions,   fit_opts = ww_fit_opts,   results_opts = ww_results_opts ) # \\dontrun{}"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sewer_assumptions.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify modeling assumptions ‚Äî sewer_assumptions","title":"Specify modeling assumptions ‚Äî sewer_assumptions","text":"Specify model assumptions generation time distribution shedding load distribution. convenience function collect assumptions one object.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sewer_assumptions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify modeling assumptions ‚Äî sewer_assumptions","text":"","code":"sewer_assumptions(   generation_dist = NULL,   shedding_dist = NULL,   shedding_reference = NULL,   incubation_dist = NULL,   min_cases = 10,   load_per_case = NULL,   residence_dist = c(1),   ... )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sewer_assumptions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify modeling assumptions ‚Äî sewer_assumptions","text":"generation_dist Generation time distribution. intrinsic distribution time infection primary case infection secondary cases. automatically passed generation_dist_assume(). shedding_dist Shedding load distribution. Describes total load shed individual distributed time (therefore sums 1). automatically passed shedding_dist_assume(). shedding_reference shedding load distribution relative day \"infection\" day \"symptom_onset\"? important shedding load distributions provided literature sometimes days since infection sometimes days since symptom onset. shedding_reference=\"symptom_onset\", EpiSewer also needs information incubation period distribution. automatically passed shedding_dist_assume(). incubation_dist Incubation period distribution. incubation period time infection symptom onset. assumption used shedding_reference=\"symptom_onset\", .e. support shedding load distributions referenced days since symptom onset. automatically passed incubation_dist_assume(). min_cases minimum incidence (new cases per day) modeled time period (default 10). assumption used calibrate load_per_case factor (scaling factor describes many pathogen particles shed average infected individual overall much detectable sampling site). min_cases specified, load_per_case chosen estimated time series infections go significantly min_cases. automatically passed load_per_case_calibrate(). load_per_case argument allows directly specify average total load per case, instead calibrating case data. Note load_per_case depends biological factors well specific sewage system laboratory quantification. Important: actually use assumption, model option load_per_case_assume() must specified EpiSewer() via model_shedding(). want use option manual calibration case data, helper function suggest_load_per_case() might also useful. residence_dist Sewer residence time distribution pathogen particles. default, EpiSewer assumes particles arrive sampling site within day shedding. However, larger sewage systems, particles may travel longer day depending shed wastewater. automatically passed residence_dist_assume(). ... assumptions passed EpiSewer().","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sewer_assumptions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify modeling assumptions ‚Äî sewer_assumptions","text":"list assumptions supplied. Can passed assumptions argument EpiSewer().","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sewer_assumptions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify modeling assumptions ‚Äî sewer_assumptions","text":"Note case data supplied via sewer_data, min_cases assumption overwritten supplied case data used accurate calibration instead.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sewer_compile.html","id":null,"dir":"Reference","previous_headings":"","what":"Compile EpiSewer models ‚Äî sewer_compile","title":"Compile EpiSewer models ‚Äî sewer_compile","text":"stan models used EpiSewer need compiled device. necessary , installing updating package. function compiles models package.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sewer_compile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compile EpiSewer models ‚Äî sewer_compile","text":"","code":"sewer_compile(model = NULL, force_recompile = FALSE, verbose = FALSE)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sewer_compile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compile EpiSewer models ‚Äî sewer_compile","text":"model character vector specific model compile. NULL (default), models compiled. force_recompile TRUE, models recompiled even already successfully compiled. verbose TRUE, warnings detailed errors compilation printed. can help diagnose compilation issues.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sewer_compile.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compile EpiSewer models ‚Äî sewer_compile","text":"one several models successfully compiled, please ensure cmdstan properly set try updating newer version using cmdstanr::install_cmdstan(). problem persists, please run sewer_compile(verbose = TRUE) post output new issue GitHub, along cmdstanr::cmdstan_version().","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sewer_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify observation data ‚Äî sewer_data","title":"Specify observation data ‚Äî sewer_data","text":"Specify wastewater observation data concentration measurements flows. convenience function collect observation data one object.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sewer_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify observation data ‚Äî sewer_data","text":"","code":"sewer_data(measurements = NULL, flows = NULL, cases = NULL, ...)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sewer_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify observation data ‚Äî sewer_data","text":"measurements data.frame measured concentrations pathogen interest. automatically passed concentrations_observe(). flows data.frame wastewater flow volumes sampling site day. automatically passed flows_observe(). cases data.frame case numbers row representing one day. Must least column dates column case numbers. data used model fitting, calibration load_per_case assumption. automatically passed load_per_case_calibrate(). ... observations passed EpiSewer().","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/sewer_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify observation data ‚Äî sewer_data","text":"list observations supplied. Can passed data argument EpiSewer().","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/shedding_dist_assume.html","id":null,"dir":"Reference","previous_headings":"","what":"Assume a shedding load distribution ‚Äî shedding_dist_assume","title":"Assume a shedding load distribution ‚Äî shedding_dist_assume","text":"option assumes fixed shedding load distribution shedding model EpiSewer.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/shedding_dist_assume.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assume a shedding load distribution ‚Äî shedding_dist_assume","text":"","code":"shedding_dist_assume(   shedding_dist = NULL,   shedding_reference = NULL,   modeldata = modeldata_init() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/shedding_dist_assume.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assume a shedding load distribution ‚Äî shedding_dist_assume","text":"shedding_dist numeric vector representing discrete shedding load distribution, elements describing share load shed 0 days, 1 day, 2 days, start shedding. shedding_reference shedding load distribution relative day \"infection\" day \"symptom_onset\"? important shedding load distributions provided literature sometimes days since infection sometimes days since symptom onset. shedding_reference=\"symptom_onset\", EpiSewer also needs information incubation period distribution (see incubation_dist_assume()). modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/shedding_dist_assume.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assume a shedding load distribution ‚Äî shedding_dist_assume","text":"modeldata object containing data specifications model fitted. Can passed EpiSewer modeling functions add data model specifications. modeldata object also includes information parameter initialization (init), meta data (.metainfo), checks performed model fitting (.checks).","code":""},{"path":[]},{"path":"https://adrian-lison.github.io/EpiSewer/reference/suggest_load_per_case.html","id":null,"dir":"Reference","previous_headings":"","what":"Suggest load per case assumption using wastewater data and case numbers ‚Äî suggest_load_per_case","title":"Suggest load per case assumption using wastewater data and case numbers ‚Äî suggest_load_per_case","text":"helper function uses crude heuristic infer load_per_case based relationship measured concentrations case counts. goal obtain load_per_case assumption right order magnitude - sufficient accurate prevalence estimation wastewater, fully sufficient monitoring trends estimating Rt.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/suggest_load_per_case.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Suggest load per case assumption using wastewater data and case numbers ‚Äî suggest_load_per_case","text":"","code":"suggest_load_per_case(   measurements,   cases,   flows = NULL,   flow_constant = NULL,   ascertainment_prop = 1,   measurement_shift = seq(-7, 7),   shift_weights = 1/(abs(measurement_shift) + 1),   date_col = \"date\",   concentration_col = \"concentration\",   flow_col = \"flow\",   case_col = \"cases\",   signif_fig = 2 )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/suggest_load_per_case.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Suggest load per case assumption using wastewater data and case numbers ‚Äî suggest_load_per_case","text":"measurements data.frame row representing one measurement. Must least column dates column concentration measurements. multiple measurements per date provided, arithmetic mean used. cases data.frame row representing one day. Must least column dates column case numbers. flows data.frame row representing one day. Must least column dates column flow measurements. flow_constant Fixed flow volume, alternative flows, regular flow measurements available. ascertainment_prop Proportion cases get detected / reported. Can used account underreporting infections. Default ascertainment_prop=1, meaning 100% infections become confirmed cases. measurement_shift specific timing wastewater concentrations case numbers depends reporting delays shedding profiles typically uncertain. argument allows shift concentration case number time series relative average several potential lags/leads, specified integer vector. default measurement_shift = seq(-7,7), .e. shift concentrations one week case numbers. shift_weights Weights shifted comparisons. Must numeric vector length measurement_shift. NULL (default), weights chosen approximately inversely proportional shift distance. date_col Name date column provided data frames. concentration_col Name column containing measured concentrations. flow_col Name column containing flows. case_col Name column containing case numbers. signif_fig Significant figures round . Since heuristic provides crude estimates overinterpreted, result gets rounded. Default rounding 2 significant figures.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/suggest_load_per_case.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Suggest load per case assumption using wastewater data and case numbers ‚Äî suggest_load_per_case","text":"suggested load_per_case can used assumption load_per_case_assume().","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/suggest_load_per_case.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Suggest load per case assumption using wastewater data and case numbers ‚Äî suggest_load_per_case","text":"EpiSewer model, load_per_case serves scaling factor describing many pathogen particles shed average infected individual overall much detectable sampling site. depends biological factors well specific sewage system. therefore almost always necessary assume load per case based comparison measured concentrations/loads case numbers. heuristic used fit linear regression model loads (computed using concentrations flows) dependent variable case numbers independent variable measurements. explicitly account shedding profiles reporting delays, measurement_shift argument allows average set relative shifts two time series. flow volume unit concentration measurements, e.g. concentrations measured gc/mL, flow mL well.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/summarize_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize parameters of interest ‚Äî summarize_fit","title":"Summarize parameters of interest ‚Äî summarize_fit","text":"function summarizes important parameters interest fitted EpiSewer model.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/summarize_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize parameters of interest ‚Äî summarize_fit","text":"","code":"summarize_fit(fit, data, .metainfo, intervals = c(0.5, 0.95), ndraws = 50)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/summarize_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize parameters of interest ‚Äî summarize_fit","text":"fit fitted EpiSewer model. data model data EpiSewer model fitted . .metainfo Meta information model data. intervals credible intervals (CrIs) calculated. default, 50% 95% CrIs. ndraws Number exemplary posterior samples extracted. Note summaries always use available samples.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/summarize_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize parameters of interest ‚Äî summarize_fit","text":"list following summaries (data.frame): R (posterior summary) R_samples (exemplary samples) expected_infections (posterior summary) infections (posterior summary) infections_samples (exemplary samples) expected_load (posterior summary) expected_concentration (posterior summary) concentration (posterior summary) sample_effects (posterior summary)","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/summarize_fit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarize parameters of interest ‚Äî summarize_fit","text":"Normally, function automatically called EpiSewer model fitting, may also run manually, example update summary intervals number exemplary samples. Note possible result contains full fitted model object (see set_results_opts()). summaries infections R include column seeding, indicates whether corresponding date still seeding phase . seeding phase defined 2xG days long, G maximum generation time. contrast model, G days long. reason decision G days, new infections still based seeded infections strongly informed data. using extended seeding criterion, ensure sufficiently data-driven estimates shown result plots.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/tbc.html","id":null,"dir":"Reference","previous_headings":"","what":"Lazy-execute a function once all necessary inputs are available ‚Äî tbc","title":"Lazy-execute a function once all necessary inputs are available ‚Äî tbc","text":"Lazy-execute function necessary inputs available","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/tbc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Lazy-execute a function once all necessary inputs are available ‚Äî tbc","text":"","code":"tbc(   f_name,   f_expr,   required = c(),   required_values = NULL,   advice = NULL,   modeldata = NULL,   calling_env = rlang::caller_env() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/tbc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Lazy-execute a function once all necessary inputs are available ‚Äî tbc","text":"f_name Name \"functions\" executed necessary inputs available. f_expr Expression arbitrary R code attributes assigned modeldata. required character vector names required inputs. modeldata Modeldata object calling function. calling_env Calling environment, rlang::caller_env().","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/tbc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Lazy-execute a function once all necessary inputs are available ‚Äî tbc","text":"difference tbp (provided) tbc (computed) tbp promises based data assumptions, tbc promises based internal modeldata variables (typically .metainfo). means can also cascades: tbp resolved, may lead update metainformation, tbc can resolved next update.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/tbe.html","id":null,"dir":"Reference","previous_headings":"","what":"To be evaluated ‚Äî tbe","title":"To be evaluated ‚Äî tbe","text":"evaluated","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/tbe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"To be evaluated ‚Äî tbe","text":"","code":"tbe(r_expr, required = c(), calling_env = rlang::caller_env())"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/tbp.html","id":null,"dir":"Reference","previous_headings":"","what":"Lazy-execute a function once all data and assumptions are provided ‚Äî tbp","title":"Lazy-execute a function once all data and assumptions are provided ‚Äî tbp","text":"Lazy-execute function data assumptions provided","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/tbp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Lazy-execute a function once all data and assumptions are provided ‚Äî tbp","text":"","code":"tbp(   f_name,   f_expr,   required_data = c(),   required_assumptions = c(),   modeldata = NULL,   calling_env = rlang::caller_env() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/tbp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Lazy-execute a function once all data and assumptions are provided ‚Äî tbp","text":"f_name Name \"functions\" executed everything provided. f_expr Expression arbitrary R code attributes assigned modeldata. required_data character vector names required data. Different options one item can provided using \"|\" separator. EpiSewer check least one options present. required_assumptions character vector names required assumptions. Different options one item can provided using \"|\" separator. EpiSewer check least one options present. modeldata Modeldata object calling function. calling_env Calling environment, rlang::caller_env().","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/tbp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Lazy-execute a function once all data and assumptions are provided ‚Äî tbp","text":"difference tbp (provided) tbc (computed) tbp promises based data assumptions, tbc promises based internal modeldata variables (typically .metainfo). means can also cascades: tbp resolved, may lead update metainformation, tbc can resolved next update.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/template_model_helpers.html","id":null,"dir":"Reference","previous_headings":"","what":"Template function ‚Äî template_model_helpers","title":"Template function ‚Äî template_model_helpers","text":"function actually anything. serves template documentation functions using inheritance params.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/template_model_helpers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Template function ‚Äî template_model_helpers","text":"","code":"template_model_helpers(modeldata)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/template_model_helpers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Template function ‚Äî template_model_helpers","text":"modeldata modeldata object model specifications added. Default empty model given modeldata_init(). Can also already partly specified model returned EpiSewer modeling functions.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/template_model_helpers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Template function ‚Äî template_model_helpers","text":"Nothing","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/update_env.html","id":null,"dir":"Reference","previous_headings":"","what":"Add required data and assumptions to an environment ‚Äî update_env","title":"Add required data and assumptions to an environment ‚Äî update_env","text":"Add required data assumptions environment","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/update_env.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add required data and assumptions to an environment ‚Äî update_env","text":"","code":"update_env(   f_env = list(),   data = list(),   assumptions = list(),   required_data = c(),   required_assumptions = c() )"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/update_env.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add required data and assumptions to an environment ‚Äî update_env","text":"f_env environment updated data list data assumptions list assumptions required_data character vector names required data. Different options one item can provided using \"|\" separator. EpiSewer check least one options present. required_assumptions character vector names required assumptions. Different options one item can provided using \"|\" separator. EpiSewer check least one options present.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/update_env.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add required data and assumptions to an environment ‚Äî update_env","text":"updated environment, required data assumptions provided data assumptions inserted missing.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/update_env.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Add required data and assumptions to an environment ‚Äî update_env","text":"Note data assumptions assigned environment corresponding attributes yet present. already present, overwritten.","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/verify_is_modeldata.html","id":null,"dir":"Reference","previous_headings":"","what":"Verification of modeldata objects ‚Äî verify_is_modeldata","title":"Verification of modeldata objects ‚Äî verify_is_modeldata","text":"Verification modeldata objects","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/verify_is_modeldata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Verification of modeldata objects ‚Äî verify_is_modeldata","text":"","code":"verify_is_modeldata(modeldata, arg_name)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/weighted.median.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute a weighted median of values ‚Äî weighted.median","title":"Compute a weighted median of values ‚Äî weighted.median","text":"Compute weighted median values","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/weighted.median.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute a weighted median of values ‚Äî weighted.median","text":"","code":"weighted.median(x, w)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/weighted.median.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute a weighted median of values ‚Äî weighted.median","text":"x vector values aggregated w Weights entry","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/weighted.median.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute a weighted median of values ‚Äî weighted.median","text":"Weighted median values x","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/withWarnings.html","id":null,"dir":"Reference","previous_headings":"","what":"Collect warnings arising during computation of a result ‚Äî withWarnings","title":"Collect warnings arising during computation of a result ‚Äî withWarnings","text":"Collect warnings arising computation result","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/withWarnings.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collect warnings arising during computation of a result ‚Äî withWarnings","text":"","code":"withWarnings(expr)"},{"path":"https://adrian-lison.github.io/EpiSewer/reference/withWarnings.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collect warnings arising during computation of a result ‚Äî withWarnings","text":"expr Expression computation run","code":""},{"path":"https://adrian-lison.github.io/EpiSewer/reference/withWarnings.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collect warnings arising during computation of a result ‚Äî withWarnings","text":"list, two elements: value warnings","code":""}]
