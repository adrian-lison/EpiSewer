<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate Rt via a random walk — R_estimate_rw • EpiSewer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Rt via a random walk — R_estimate_rw"><meta name="description" content="This option estimates the effective reproduction number over time
using a random walk."><meta property="og:description" content="This option estimates the effective reproduction number over time
using a random walk."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiSewer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/model-specification.html">Modeling in EpiSewer</a></li>
    <li><a class="dropdown-item" href="../articles/detailed-example.html">Detailed example</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modeling details</h6></li>
    <li><a class="dropdown-item" href="../articles/model-definition.html">Model definition</a></li>
    <li><a class="dropdown-item" href="../articles/load_per_case.html">The "shedding load per case" assumption</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adrian-lison/EpiSewer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate Rt via a random walk</h1>
      <small class="dont-index">Source: <a href="https://github.com/adrian-lison/EpiSewer/blob/v0.0.4/R/model_infections.R" class="external-link"><code>R/model_infections.R</code></a></small>
      <div class="d-none name"><code>R_estimate_rw.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This option estimates the effective reproduction number over time
using a random walk.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">R_estimate_rw</span><span class="op">(</span></span>
<span>  R_start_prior_mu <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  R_start_prior_sigma <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  sd_base_prior_mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sd_base_prior_sd <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  sd_change_prior_shape <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  sd_change_prior_scale <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  sd_change_distance <span class="op">=</span> <span class="fl">7</span> <span class="op">*</span> <span class="fl">26</span>,</span>
<span>  link <span class="op">=</span> <span class="st">"inv_softplus"</span>,</span>
<span>  R_max <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  differenced <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  noncentered <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  modeldata <span class="op">=</span> <span class="fu"><a href="modeldata_init.html">modeldata_init</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-r-start-prior-mu">R_start_prior_mu<a class="anchor" aria-label="anchor" href="#arg-r-start-prior-mu"></a></dt>
<dd><p>Prior (mean) on the initial value of Rt.</p></dd>


<dt id="arg-r-start-prior-sigma">R_start_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-r-start-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the initial value of
Rt.</p></dd>


<dt id="arg-sd-base-prior-mu">sd_base_prior_mu<a class="anchor" aria-label="anchor" href="#arg-sd-base-prior-mu"></a></dt>
<dd><p>Prior (mean) on the baseline standard deviation of the
innovations. Please note that for consistency, the overall standard
deviation of innovations will always be the baseline plus an additive
component from <code>sd_change_prior</code> even if no changepoints are modeled (see
below).</p></dd>


<dt id="arg-sd-base-prior-sd">sd_base_prior_sd<a class="anchor" aria-label="anchor" href="#arg-sd-base-prior-sd"></a></dt>
<dd><p>Prior (standard deviation) on the baseline standard
deviation of the innovations. See <code>sd_base_prior_mu</code> for details.</p></dd>


<dt id="arg-sd-change-prior-shape">sd_change_prior_shape<a class="anchor" aria-label="anchor" href="#arg-sd-change-prior-shape"></a></dt>
<dd><p>Exponential-Gamma prior (shape) on standard
deviation additional to baseline. This prior describes the distribution of
the standard deviation of Rt over time. EpiSewer will estimate a baseline
standard deviation (see <code>sd_base_prior_sd</code>), and model additional variation
on top of the baseline using a changepoint model. Please see the details for
more explanation.</p></dd>


<dt id="arg-sd-change-prior-scale">sd_change_prior_scale<a class="anchor" aria-label="anchor" href="#arg-sd-change-prior-scale"></a></dt>
<dd><p>Exponential-Gamma prior (scale) on standard
deviation additional to baseline. See <code>sd_change_prior_shape</code> and the
details for more explanation.</p></dd>


<dt id="arg-sd-change-distance">sd_change_distance<a class="anchor" aria-label="anchor" href="#arg-sd-change-distance"></a></dt>
<dd><p>Distance between changepoints used to model
additional variation in Rt. The default change point distance is 4 weeks.
Very short changepoint distances must be chosen with care, as they can make
the Rt time series too flexible. If set to zero, no change points are
modeled.</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>Link function. Currently supported are <code>inv_softplus</code> (default)
and <code>scaled_logit</code>. Both of these links are configured to behave
approximately like the identity function around R=1, but become increasingly
non-linear below (and in the case of <code>scaled_logit</code> also above) R=1.</p></dd>


<dt id="arg-r-max">R_max<a class="anchor" aria-label="anchor" href="#arg-r-max"></a></dt>
<dd><p>If <code>link=scaled_logit</code> is used, a maximum reproduction number
must be assumed. This should be higher than any realistic R value for the
modeled pathogen. Default is 6.</p></dd>


<dt id="arg-differenced">differenced<a class="anchor" aria-label="anchor" href="#arg-differenced"></a></dt>
<dd><p>If <code>FALSE</code> (default), the random walk is applied to the
absolute Rt time series. If <code>TRUE</code>, it is instead applied to the differenced
time series, i.e. now the trend is modeled as a random walk.</p></dd>


<dt id="arg-noncentered">noncentered<a class="anchor" aria-label="anchor" href="#arg-noncentered"></a></dt>
<dd><p>If <code>TRUE</code> (default), a non-centered parameterization is
used to model the innovations of the random walk (for better sampling
efficiency).</p></dd>


<dt id="arg-modeldata">modeldata<a class="anchor" aria-label="anchor" href="#arg-modeldata"></a></dt>
<dd><p>A <code>modeldata</code> object to which the above model specifications
should be added. Default is an empty model given by <code><a href="modeldata_init.html">modeldata_init()</a></code>. Can
also be an already partly specified model returned by other <code>EpiSewer</code>
modeling functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>modeldata</code> object containing data and specifications of the model
to be fitted. Can be passed on to other <code>EpiSewer</code> modeling functions to
add further data and model specifications.</p>
<p>The <code>modeldata</code> object also includes information about parameter
initialization (<code>.init</code>), meta data (<code>.metainfo</code>), and checks to be
performed before model fitting (<code>.checks</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The smoothness of Rt estimates is influenced by the prior on the
standard deviation of the random walk. It also influences the uncertainty of
Rt estimates towards the present / date of estimation, when limited data
signal is available. The prior on the intercept of the random walk should
reflect your expectation of Rt at the beginning of the time series. If
estimating from the start of an epidemic, you might want to use a prior with
mean &gt; 1 for the intercept.</p>
<p>The variability of Rt can change over time. For example, during the
height of an epidemic wave, countermeasures may lead to much faster changes
in Rt than observable at other times (baseline). This potential additional
variability is accounted for using change points placed at regular
intervals. The additional standard deviation of the state space model
innovations on top of the baseline then evolves linearly between the change
points. The additional variation defined at the changepoints is modeled as
independently distributed and following a Lomax distribution, also known as
Exponential-Gamma (EG) distribution. This is an exponential distribution
where the rate is Gamma distributed. The prior <code>sd_change_prior</code> defines the
shape and scale of this Gamma distribution. The distribution has a strong
peak towards zero and a long tail. This regularizes the estimated deviations
from the baseline standard deviation - most deviations are small, but during
special time periods, the deviation might also be larger.</p>
<p>The priors of this component have the following functional form:</p><ul><li><p>intercept of the random walk: <code>Normal</code></p></li>
<li><p>baseline standard deviation of the random walk: <code>Half-normal</code></p></li>
<li><p>additional standard deviation at changepoints: <code>Exponential-Gamma</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Rt models:
<code><a href="R_estimate_approx.html">R_estimate_approx()</a></code>,
<code><a href="R_estimate_changepoint_splines.html">R_estimate_changepoint_splines()</a></code>,
<code><a href="R_estimate_ets.html">R_estimate_ets()</a></code>,
<code><a href="R_estimate_gp.html">R_estimate_gp()</a></code>,
<code><a href="R_estimate_piecewise.html">R_estimate_piecewise()</a></code>,
<code><a href="R_estimate_smooth_derivative.html">R_estimate_smooth_derivative()</a></code>,
<code><a href="R_estimate_splines.html">R_estimate_splines()</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrian Lison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

