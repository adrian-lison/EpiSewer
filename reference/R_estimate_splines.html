<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate Rt via smoothing splines — R_estimate_splines • EpiSewer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Rt via smoothing splines — R_estimate_splines"><meta name="description" content="This option estimates the effective reproduction number using
penalized B-splines."><meta property="og:description" content="This option estimates the effective reproduction number using
penalized B-splines."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiSewer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/model-specification.html">Modeling in EpiSewer</a></li>
    <li><a class="dropdown-item" href="../articles/detailed-example.html">Detailed example</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modeling details</h6></li>
    <li><a class="dropdown-item" href="../articles/model-definition.html">Model definition</a></li>
    <li><a class="dropdown-item" href="../articles/load_per_case.html">The "shedding load per case" assumption</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adrian-lison/EpiSewer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate Rt via smoothing splines</h1>
      <small class="dont-index">Source: <a href="https://github.com/adrian-lison/EpiSewer/blob/main/R/model_infections.R" class="external-link"><code>R/model_infections.R</code></a></small>
      <div class="d-none name"><code>R_estimate_splines.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This option estimates the effective reproduction number using
penalized B-splines.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">R_estimate_splines</span><span class="op">(</span></span>
<span>  knot_distance <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  spline_degree <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  coef_intercept_prior_mu <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  coef_intercept_prior_sigma <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  coef_sd_prior_mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  coef_sd_prior_sigma <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  link <span class="op">=</span> <span class="st">"inv_softplus"</span>,</span>
<span>  R_max <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  modeldata <span class="op">=</span> <span class="fu"><a href="modeldata_init.html">modeldata_init</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-knot-distance">knot_distance<a class="anchor" aria-label="anchor" href="#arg-knot-distance"></a></dt>
<dd><p>Distance between spline breakpoints (knots) in days
(default is 7, i.e. one knot each week). Placing knots further apart
increases the smoothness of Rt estimates and can speed up model fitting.
The Rt time series remains surprisingly flexible even at larger knot
distances, but placing knots too far apart can lead to inaccurate
estimates.</p></dd>


<dt id="arg-spline-degree">spline_degree<a class="anchor" aria-label="anchor" href="#arg-spline-degree"></a></dt>
<dd><p>Degree of the spline polynomials (default is 3 for cubic
splines).</p></dd>


<dt id="arg-coef-intercept-prior-mu">coef_intercept_prior_mu<a class="anchor" aria-label="anchor" href="#arg-coef-intercept-prior-mu"></a></dt>
<dd><p>Prior (mean) on the intercept of the random
walk over spline coefficients.</p></dd>


<dt id="arg-coef-intercept-prior-sigma">coef_intercept_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-coef-intercept-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the intercept
of the random walk over spline coefficients.</p></dd>


<dt id="arg-coef-sd-prior-mu">coef_sd_prior_mu<a class="anchor" aria-label="anchor" href="#arg-coef-sd-prior-mu"></a></dt>
<dd><p>Prior (mean) on the daily standard deviation of the
random walk over spline coefficients.</p></dd>


<dt id="arg-coef-sd-prior-sigma">coef_sd_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-coef-sd-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the daily standard
deviation of the random walk over spline coefficients.</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>Link function. Currently supported are <code>inv_softplus</code> (default)
and <code>scaled_logit</code>. Both of these links are configured to behave
approximately like the identity function around R=1, but become
increasingly non-linear below (and in the case of <code>scaled_logit</code> also
above) R=1.</p></dd>


<dt id="arg-r-max">R_max<a class="anchor" aria-label="anchor" href="#arg-r-max"></a></dt>
<dd><p>If <code>link=scaled_logit</code> is used, a maximum reproduction number
must be assumed. This should be higher than any realistic R value for the
modeled pathogen. Default is 6.</p></dd>


<dt id="arg-modeldata">modeldata<a class="anchor" aria-label="anchor" href="#arg-modeldata"></a></dt>
<dd><p>A <code>modeldata</code> object to which the above model specifications
should be added. Default is an empty model given by <code><a href="modeldata_init.html">modeldata_init()</a></code>. Can
also be an already partly specified model returned by other <code>EpiSewer</code>
modeling functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>modeldata</code> object containing data and specifications of the model
to be fitted. Can be passed on to other <code>EpiSewer</code> modeling functions to
add further data and model specifications.</p>
<p>The <code>modeldata</code> object also includes information about parameter
initialization (<code>init</code>), meta data (<code>.metainfo</code>), and checks to be
performed before model fitting (<code>.checks</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>EpiSewer</code> uses a random walk on the B-spline coefficients for
regularization. This allows to use small knot distances without obtaining
extremely wiggly Rt estimates.</p><ul><li><p>The prior on the random walk intercept should reflect
your expectation of Rt at the beginning of the time series. If estimating
from the start of an epidemic, you might want to use a prior with mean
larger than 1 for the intercept.</p></li>
<li><p>The prior on the daily standard deviation should be interpreted in terms
of daily additive changes (this is at least true around Rt=1, and becomes
less true as Rt approaches 0 or its upper bound as defined by the <code>link</code>
function). For example, a standard deviation of 0.5 roughly allows the
spline coefficients to change by ±1 (using the 2 sigma rule) each day. The
daily standard deviation is multiplied by <code>sqrt(knot_distance)</code> to get the
actual standard deviation of the coefficients. This way, the prior is
independent of the chosen <code>knot_distance</code>. For example, if <code>knot_distance</code>
is 7 days, and a daily standard deviation of 0.5 is used, the coefficients
of two adjacent splines can differ by up to ±2.6. Note however that this
difference does not directly translate into a change of Rt by ±2.6, as Rt
is always the weighted sum of several basis functions at any given point.
It may therefore change much more gradually, depending on the distances
between knots.</p></li>
</ul><p>The smoothness of the Rt estimates is influenced both by the knot
distance and by the daily standard deviation of the random walk on
coefficients. The latter also influences the uncertainty of Rt estimates
towards the present / date of estimation, when limited data signal is
available. Absent sufficient data signal, Rt estimates will tend to stay at
the current level (which corresponds to assuming unchanged transmission
dynamics).</p>
<p>The priors of this component have the following functional form:</p><ul><li><p>intercept of the random walk over spline coefficients:
<code>Normal</code></p></li>
<li><p>standard deviation of the random walk over spline coefficients:
<code>Truncated normal</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Rt models:
<code><a href="R_estimate_approx.html">R_estimate_approx</a>()</code>,
<code><a href="R_estimate_ets.html">R_estimate_ets</a>()</code>,
<code><a href="R_estimate_rw.html">R_estimate_rw</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrian Lison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

