<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate measurement noise for digital PCR data — noise_estimate_dPCR • EpiSewer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate measurement noise for digital PCR data — noise_estimate_dPCR"><meta name="description" content="This option estimates the unexplained variation in wastewater
measurements using a coefficient of variation model specialized for digital
PCR (e.g. digital droplet PCR). Specifically, the coefficient of variation
is modeled as a function of the expected concentration according to the
statistical properties of dPCR.
This model predicts a higher coefficient of variation at smaller
concentrations, which often leads to a better model fit, even for
measurements from other quantification methods such as qPCR.
If multiple measurements (replicates) per sample are provided,
EpiSewer can also explicitly model variation before the replication
stage."><meta property="og:description" content="This option estimates the unexplained variation in wastewater
measurements using a coefficient of variation model specialized for digital
PCR (e.g. digital droplet PCR). Specifically, the coefficient of variation
is modeled as a function of the expected concentration according to the
statistical properties of dPCR.
This model predicts a higher coefficient of variation at smaller
concentrations, which often leads to a better model fit, even for
measurements from other quantification methods such as qPCR.
If multiple measurements (replicates) per sample are provided,
EpiSewer can also explicitly model variation before the replication
stage."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiSewer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/model-specification.html">Modeling in EpiSewer</a></li>
    <li><a class="dropdown-item" href="../articles/detailed-example.html">Detailed example</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modeling details</h6></li>
    <li><a class="dropdown-item" href="../articles/model-definition.html">Model definition</a></li>
    <li><a class="dropdown-item" href="../articles/load_per_case.html">The "shedding load per case" assumption</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adrian-lison/EpiSewer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate measurement noise for digital PCR data</h1>
      <small class="dont-index">Source: <a href="https://github.com/adrian-lison/EpiSewer/blob/main/R/model_measurements.R" class="external-link"><code>R/model_measurements.R</code></a></small>
      <div class="d-none name"><code>noise_estimate_dPCR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This option estimates the unexplained variation in wastewater
measurements using a coefficient of variation model specialized for digital
PCR (e.g. digital droplet PCR). Specifically, the coefficient of variation
is modeled as a function of the expected concentration according to the
statistical properties of dPCR.</p>
<p>This model predicts a higher coefficient of variation at smaller
concentrations, which often leads to a better model fit, even for
measurements from other quantification methods such as qPCR.</p>
<p>If multiple measurements (replicates) per sample are provided,
<code>EpiSewer</code> can also explicitly model variation before the replication
stage.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">noise_estimate_dPCR</span><span class="op">(</span></span>
<span>  replicates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cv_prior_mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cv_prior_sigma <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  total_partitions_prior_mu <span class="op">=</span> <span class="fl">20000</span>,</span>
<span>  total_partitions_prior_sigma <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  total_partitions_observe <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  partition_variation_prior_mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  partition_variation_prior_sigma <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  volume_scaled_prior_mu <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  volume_scaled_prior_sigma <span class="op">=</span> <span class="fl">4e-05</span>,</span>
<span>  pre_replicate_cv_prior_mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  pre_replicate_cv_prior_sigma <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  prePCR_noise_type <span class="op">=</span> <span class="st">"log-normal"</span>,</span>
<span>  use_taylor_approx <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  modeldata <span class="op">=</span> <span class="fu"><a href="modeldata_init.html">modeldata_init</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-replicates">replicates<a class="anchor" aria-label="anchor" href="#arg-replicates"></a></dt>
<dd><p>Should replicates be used to explicitly model variation
before the replication stage?</p></dd>


<dt id="arg-cv-prior-mu">cv_prior_mu<a class="anchor" aria-label="anchor" href="#arg-cv-prior-mu"></a></dt>
<dd><p>Prior (mean) on the coefficient of variation of
concentration measurements. Note that in contrast to using
<code><a href="noise_estimate.html">noise_estimate()</a></code>, this does <em>not</em> include the technical noise of the
digital PCR. This is because the dPCR noise is explicitly modeled (using
the number of partitions and conversion factor). Moreover, when
<code>replicates=TRUE</code>, this is only the CV after the replication stage (see
details for more explanation).</p></dd>


<dt id="arg-cv-prior-sigma">cv_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-cv-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the coefficient of
variation of concentration measurements.</p></dd>


<dt id="arg-total-partitions-prior-mu">total_partitions_prior_mu<a class="anchor" aria-label="anchor" href="#arg-total-partitions-prior-mu"></a></dt>
<dd><p>Prior (mean) on the total number of
partitions in the dPCR reaction.</p></dd>


<dt id="arg-total-partitions-prior-sigma">total_partitions_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-total-partitions-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the total
number of partitions in the dPCR reaction. If this is set to zero, the
total number of partitions will be fixed to the prior mean and not
estimated.</p></dd>


<dt id="arg-total-partitions-observe">total_partitions_observe<a class="anchor" aria-label="anchor" href="#arg-total-partitions-observe"></a></dt>
<dd><p>If TRUE, the total number of partitions is
taken from the supplied measurements <code>data.frame</code>. This requires that the
argument <code>total_partitions_col</code> is specified in <code><a href="concentrations_observe.html">concentrations_observe()</a></code>.</p></dd>


<dt id="arg-partition-variation-prior-mu">partition_variation_prior_mu<a class="anchor" aria-label="anchor" href="#arg-partition-variation-prior-mu"></a></dt>
<dd><p>Prior (mean) on the coefficient of
variation of the total number of partitions in the dPCR reaction. Usually,
the maximum number of partitions possible for a given dPCR chip is not
reached, i.e. a certain number of partitions is lost. This loss varies
between PCR runs, and is modeled as log-normal distributed in EpiSewer.</p></dd>


<dt id="arg-partition-variation-prior-sigma">partition_variation_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-partition-variation-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the
coefficient of variation of the total number of partitions in the dPCR
reaction. If this is set to zero, the partition variation will
be fixed to the prior mean and not estimated.</p></dd>


<dt id="arg-volume-scaled-prior-mu">volume_scaled_prior_mu<a class="anchor" aria-label="anchor" href="#arg-volume-scaled-prior-mu"></a></dt>
<dd><p>Prior (mean) on the conversion factor
(partition volume scaled by the dilution of wastewater in the assay) for
the dPCR reaction. See details for further explanation.</p></dd>


<dt id="arg-volume-scaled-prior-sigma">volume_scaled_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-volume-scaled-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the conversion
factor (partition volume scaled by the dilution of wastewater in the assay)
for the dPCR reaction. If this is set to zero, the conversion factor will
be fixed to the prior mean and not estimated.</p></dd>


<dt id="arg-pre-replicate-cv-prior-mu">pre_replicate_cv_prior_mu<a class="anchor" aria-label="anchor" href="#arg-pre-replicate-cv-prior-mu"></a></dt>
<dd><p>Prior (mean) on the coefficient of variation
of concentrations <em>before</em> the replication stage.</p></dd>


<dt id="arg-pre-replicate-cv-prior-sigma">pre_replicate_cv_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-pre-replicate-cv-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the
coefficient of variation of concentrations <em>before</em> the replication stage.</p></dd>


<dt id="arg-prepcr-noise-type">prePCR_noise_type<a class="anchor" aria-label="anchor" href="#arg-prepcr-noise-type"></a></dt>
<dd><p>The parametric distribution to assume for noise
before the PCR assay. Currently supported are "log-normal" and "gamma". The
choice of the parametric distribution typically makes no relevant
difference for the noise model, but can make a relevant difference for the
LOD model if <code><a href="LOD_estimate_dPCR.html">LOD_estimate_dPCR()</a></code> is used.</p></dd>


<dt id="arg-use-taylor-approx">use_taylor_approx<a class="anchor" aria-label="anchor" href="#arg-use-taylor-approx"></a></dt>
<dd><p>If TRUE (default), a Taylor expansion approximation
is used to estimate the CV of measurements under pre-PCR noise. The
approximation is very accurate, unless concentrations are extremely high
(so high that the quality of the measurements from dPCR would anyway be
questionable).</p></dd>


<dt id="arg-modeldata">modeldata<a class="anchor" aria-label="anchor" href="#arg-modeldata"></a></dt>
<dd><p>A <code>modeldata</code> object to which the above model specifications
should be added. Default is an empty model given by <code><a href="modeldata_init.html">modeldata_init()</a></code>. Can
also be an already partly specified model returned by other <code>EpiSewer</code>
modeling functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>modeldata</code> object containing data and specifications of the model
to be fitted. Can be passed on to other <code>EpiSewer</code> modeling functions to
add further data and model specifications.</p>
<p>The <code>modeldata</code> object also includes information about parameter
initialization (<code>init</code>), meta data (<code>.metainfo</code>), and checks to be
performed before model fitting (<code>.checks</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The conversion factor (see <code>volume_scaled_prior_mu</code>,
<code>volume_scaled_prior_sigma</code>) is the partition volume scaled by the dilution
of the wastewater in the assay. The dilution accounts for all
extraction and preparation steps. For example, if the partition volume is
4.5e-7 mL and the dilution of the wastewater is 100:3 (i.e. 100 gc/mL in
the original wastewater sample correspond to 3 gc/mL in the PCR reaction),
then the overall conversion factor is 4.5e-7 * 100 / 3 = 1.5e-5.</p>
<p>When <code>replicates=TRUE</code>, two coefficients of variation are estimated:</p><ul><li><p>the CV before the replication stage (see <code>pre_replicate_cv_prior_mu</code>)</p></li>
<li><p>the CV after the replication stage (see <code>cv_prior_mu</code>)</p>
<p>The meaning of these CV estimates depends on the type of replicates. If the
replicates are biological replicates (i.e. independently processed), then
<code>cv</code> estimates the noise in the preprocessing before the PCR, and
<code>pre_replicate_cv</code> estimates the noise from anything before preprocessing
(e.g. sampling noise and all other unexplained variation). In contrast, if
the replicates are technical replicates (i.e. several PCR runs of the same
preprocessed sample), then <code>cv</code> estimates only unexplained PCR noise
(should be close to zero), and <code>pre_replicate_cv</code> estimates all other noise
(including preprocessing noise.)</p></li>
</ul><p>The priors of this component have the following functional form:</p><ul><li><p>coefficient of variation of concentration measurements (<code>cv</code>): <code>Truncated normal</code></p></li>
<li><p>mean number of partitions in dPCR: <code>Truncated normal</code></p></li>
<li><p>coefficient of variation of number of partitions in dPCR: <code>Truncated normal</code></p></li>
<li><p>conversion factor for dPCR: <code>Truncated normal</code></p></li>
<li><p>coefficient of variation of concentration before the replication stage (<code>pre_replicate_cv</code>):
<code>Truncated normal</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="LOD_estimate_dPCR.html">LOD_estimate_dPCR</a> for a limit of detection model specialised for
dPCR.</p>
<p>Other noise models:
<code><a href="noise_estimate_constant_var.html">noise_estimate_constant_var</a>()</code>,
<code><a href="noise_estimate.html">noise_estimate</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrian Lison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

