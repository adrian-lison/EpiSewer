<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Suggest load per case assumption using wastewater data and case numbers — suggest_load_per_case • EpiSewer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Suggest load per case assumption using wastewater data and case numbers — suggest_load_per_case"><meta name="description" content="This helper function uses a crude heuristic to infer the
load_per_case based on the relationship between measured concentrations
and case counts. The goal is to obtain a load_per_case assumption that is
on the right order of magnitude - this will not be sufficient for accurate
prevalence estimation from wastewater, but fully sufficient for monitoring
trends and estimating Rt."><meta property="og:description" content="This helper function uses a crude heuristic to infer the
load_per_case based on the relationship between measured concentrations
and case counts. The goal is to obtain a load_per_case assumption that is
on the right order of magnitude - this will not be sufficient for accurate
prevalence estimation from wastewater, but fully sufficient for monitoring
trends and estimating Rt."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiSewer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/model-specification.html">Modeling in EpiSewer</a></li>
    <li><a class="dropdown-item" href="../articles/detailed-example.html">Detailed example</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modeling details</h6></li>
    <li><a class="dropdown-item" href="../articles/model-definition.html">Model definition</a></li>
    <li><a class="dropdown-item" href="../articles/load_per_case.html">The "shedding load per case" assumption</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adrian-lison/EpiSewer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Suggest load per case assumption using wastewater data and case numbers</h1>
      <small class="dont-index">Source: <a href="https://github.com/adrian-lison/EpiSewer/blob/extended_seeding/R/utils_preprocess.R" class="external-link"><code>R/utils_preprocess.R</code></a></small>
      <div class="d-none name"><code>suggest_load_per_case.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This helper function uses a crude heuristic to infer the
<code>load_per_case</code> based on the relationship between measured concentrations
and case counts. The goal is to obtain a <code>load_per_case</code> assumption that is
on the right order of magnitude - this will not be sufficient for accurate
prevalence estimation from wastewater, but fully sufficient for monitoring
trends and estimating Rt.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">suggest_load_per_case</span><span class="op">(</span></span>
<span>  <span class="va">measurements</span>,</span>
<span>  <span class="va">cases</span>,</span>
<span>  flows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  flow_constant <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ascertainment_prop <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  measurement_shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>  shift_weights <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">measurement_shift</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  date_col <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>  concentration_col <span class="op">=</span> <span class="st">"concentration"</span>,</span>
<span>  flow_col <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  case_col <span class="op">=</span> <span class="st">"cases"</span>,</span>
<span>  signif_fig <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-measurements">measurements<a class="anchor" aria-label="anchor" href="#arg-measurements"></a></dt>
<dd><p>A <code>data.frame</code> with each row representing one
measurement. Must have at least a column with dates and a column with
concentration measurements. If multiple measurements per date are provided,
their arithmetic mean is used.</p></dd>


<dt id="arg-cases">cases<a class="anchor" aria-label="anchor" href="#arg-cases"></a></dt>
<dd><p>A <code>data.frame</code> with each row representing one day. Must have at
least a column with dates and a column with case numbers.</p></dd>


<dt id="arg-flows">flows<a class="anchor" aria-label="anchor" href="#arg-flows"></a></dt>
<dd><p>A <code>data.frame</code> with each row representing one day. Must have at
least a column with dates and a column with flow measurements.</p></dd>


<dt id="arg-flow-constant">flow_constant<a class="anchor" aria-label="anchor" href="#arg-flow-constant"></a></dt>
<dd><p>Fixed flow volume, as an alternative to <code>flows</code>, if no
regular flow measurements are available.</p></dd>


<dt id="arg-ascertainment-prop">ascertainment_prop<a class="anchor" aria-label="anchor" href="#arg-ascertainment-prop"></a></dt>
<dd><p>Proportion of all cases that get detected /
reported. Can be used to account for underreporting of infections. Default
is <code>ascertainment_prop=1</code>, meaning that 100% of infections become confirmed
cases.</p></dd>


<dt id="arg-measurement-shift">measurement_shift<a class="anchor" aria-label="anchor" href="#arg-measurement-shift"></a></dt>
<dd><p>The specific timing between wastewater
concentrations and case numbers depends on reporting delays and shedding
profiles and is typically uncertain. This argument allows to shift the
concentration and case number time series relative to each other and to
average over several potential lags/leads, as specified by an integer
vector. The default is <code>measurement_shift = seq(-7,7)</code>, i.e. a shift of
concentrations between up to one week before and after case numbers.</p></dd>


<dt id="arg-shift-weights">shift_weights<a class="anchor" aria-label="anchor" href="#arg-shift-weights"></a></dt>
<dd><p>Weights for the shifted comparisons. Must be an numeric
vector of the same length as <code>measurement_shift</code>. If <code>NULL</code> (default), the
weights are chosen to be approximately inversely proportional to the shift
distance.</p></dd>


<dt id="arg-date-col">date_col<a class="anchor" aria-label="anchor" href="#arg-date-col"></a></dt>
<dd><p>Name of the date column in all provided data frames.</p></dd>


<dt id="arg-concentration-col">concentration_col<a class="anchor" aria-label="anchor" href="#arg-concentration-col"></a></dt>
<dd><p>Name of the column containing the measured
concentrations.</p></dd>


<dt id="arg-flow-col">flow_col<a class="anchor" aria-label="anchor" href="#arg-flow-col"></a></dt>
<dd><p>Name of the column containing the flows.</p></dd>


<dt id="arg-case-col">case_col<a class="anchor" aria-label="anchor" href="#arg-case-col"></a></dt>
<dd><p>Name of the column containing the case numbers.</p></dd>


<dt id="arg-signif-fig">signif_fig<a class="anchor" aria-label="anchor" href="#arg-signif-fig"></a></dt>
<dd><p>Significant figures to round to. Since this heuristic only
provides crude estimates which should not be overinterpreted, the result
gets rounded. Default is rounding to the 2 most significant figures.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A suggested <code>load_per_case</code> that can be used as an assumption in
<code><a href="load_per_case_assume.html">load_per_case_assume()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In the <code>EpiSewer</code> model, the <code>load_per_case</code> serves as a scaling
factor describing how many pathogen particles are shed by the average
infected individual overall and how much of this is detectable at the
sampling site. This depends both on biological factors as well as on the
specific sewage system. It is therefore almost always necessary to assume
the load per case based on a comparison of measured concentrations/loads
and case numbers.</p>
<p>The heuristic used here is to fit a linear regression model with
loads (computed using concentrations and flows) as dependent variable and
case numbers as independent variable over all measurements. This does not
explicitly account for shedding profiles or reporting delays, but the
<code>measurement_shift</code> argument allows to average over a set of relative
shifts between the two time series.</p>
<p>The flow volume unit should be the same as for the concentration
measurements, e.g. if concentrations are measured in gc/mL, then the flow
should be in mL as well.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrian Lison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

