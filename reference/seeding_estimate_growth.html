<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate seeding infections with a time-varying growth rate — seeding_estimate_growth • EpiSewer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate seeding infections with a time-varying growth rate — seeding_estimate_growth"><meta name="description" content="This option estimates an exponential growth of infections at the
start of the modeled time period, with the growth rate varying over time."><meta property="og:description" content="This option estimates an exponential growth of infections at the
start of the modeled time period, with the growth rate varying over time."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiSewer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/model-specification.html">Modeling in EpiSewer</a></li>
    <li><a class="dropdown-item" href="../articles/detailed-example.html">Detailed example</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modeling details</h6></li>
    <li><a class="dropdown-item" href="../articles/model-definition.html">Model definition</a></li>
    <li><a class="dropdown-item" href="../articles/load_per_case.html">The "shedding load per case" assumption</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adrian-lison/EpiSewer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate seeding infections with a time-varying growth rate</h1>
      <small class="dont-index">Source: <a href="https://github.com/adrian-lison/EpiSewer/blob/main/R/model_infections.R" class="external-link"><code>R/model_infections.R</code></a></small>
      <div class="d-none name"><code>seeding_estimate_growth.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This option estimates an exponential growth of infections at the
start of the modeled time period, with the growth rate varying over time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">seeding_estimate_growth</span><span class="op">(</span></span>
<span>  intercept_prior_q5 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  intercept_prior_q95 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  growth_change_prior_mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  growth_change_prior_sigma <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  extend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  modeldata <span class="op">=</span> <span class="fu"><a href="modeldata_init.html">modeldata_init</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-intercept-prior-q-">intercept_prior_q5<a class="anchor" aria-label="anchor" href="#arg-intercept-prior-q-"></a></dt>
<dd><p>Prior (5% quantile) on the initial number of
infections. Can be interpreted as an approximate lower bound. If NULL
(default), this is computed from a crude empirical estimate of the number
of cases (see details).</p></dd>


<dt id="arg-intercept-prior-q-">intercept_prior_q95<a class="anchor" aria-label="anchor" href="#arg-intercept-prior-q-"></a></dt>
<dd><p>Prior (95% quantile) on the initial number of
infections. Can be interpreted as an approximate upper bound. If NULL
(default), this is computed from a crude empirical estimate of the number
of cases (see details).</p></dd>


<dt id="arg-growth-change-prior-mu">growth_change_prior_mu<a class="anchor" aria-label="anchor" href="#arg-growth-change-prior-mu"></a></dt>
<dd><p>Prior (mean) on the daily standard deviation of
the random walk for the epidemic growth rate.</p></dd>


<dt id="arg-growth-change-prior-sigma">growth_change_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-growth-change-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the daily
standard deviation of the random walk for the epidemic growth rate.</p></dd>


<dt id="arg-extend">extend<a class="anchor" aria-label="anchor" href="#arg-extend"></a></dt>
<dd><p>Should the seeding phase be extended when concentrations are
very low at the start of the measurement time series? If <code>TRUE</code>, then the
seeding phase will be extended to the first date with three consecutive
detects (i.e. non-zero measurements). Before that date, the reproduction
number will be retrospectively computed based on the seeded infections.
Explicit modeling of the Rt time series will only begin after the seeding
phase. This option avoids sampling problems when estimating Rt from very
low infection numbers during a period with many non-detects. Note that
estimated reproduction numbers are not necessarily meaningful during
periods with very low infection numbers, as transmission dynamics may be
dominated by chance events and importations.</p></dd>


<dt id="arg-modeldata">modeldata<a class="anchor" aria-label="anchor" href="#arg-modeldata"></a></dt>
<dd><p>A <code>modeldata</code> object to which the above model specifications
should be added. Default is an empty model given by <code><a href="modeldata_init.html">modeldata_init()</a></code>. Can
also be an already partly specified model returned by other <code>EpiSewer</code>
modeling functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>modeldata</code> object containing data and specifications of the model
to be fitted. Can be passed on to other <code>EpiSewer</code> modeling functions to
add further data and model specifications.</p>
<p>The <code>modeldata</code> object also includes information about parameter
initialization (<code>.init</code>), meta data (<code>.metainfo</code>), and checks to be
performed before model fitting (<code>.checks</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The seeding phase has the length of the maximum generation time
(during this time, the renewal model cannot be applied). It is here assumed
that the expected number of new infections follows an exponential growth or
decline process during this time period. The exponential growth rate of the
seeding phase follows a random walk that ends with a growth rate
representing the first estimated reproduction number at the start of the
modeling phase. This means that the intercept of the seeding phase growth
rate depends on the <code>R_start_prior</code> provided in the <code>R_estimate_*</code>
component.</p>
<p>If the lower and upper intervals of the prior for the initial number
of infections, i.e. <code>intercept_prior_q5</code> or <code>intercept_prior_q95</code> are not
specified by the user, <code>EpiSewer</code> will compute a rough median empirical
estimate of the number of cases using the supplied wastewater measurements
and shedding assumptions, and then infer the missing quantiles based on
this. If none of the quantiles are provided, they are set to be roughly
1/10 and 10 times the empirical median estimate. We note that this is a
violation of Bayesian principles (data must not be used to inform priors) -
but a neglectable one, since it only ensures that the seeding is modeled on
the right order of magnitude and does not have relevant impacts on later Rt
estimates.</p>
<p>The priors of this component have the following functional form:</p><ul><li><p>initial number of infections (log scale): <code>Normal</code></p></li>
<li><p>standard deviation of the random walk on the growth rate: <code>Truncated normal</code></p>
<p>The priors for these parameters are determined based on the user-supplied
arguments, using appropriate transformations and the two-sigma-rule of
thumb.</p></li>
</ul><p>Credits to Samuel Brand and the authors of the EpiAware toolkit for
the idea to back-calculate the growth rate of the seeding phase from the
initial reproduction number.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrian Lison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

