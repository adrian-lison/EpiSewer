<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate Rt using an approximation of the generative renewal model — R_estimate_approx • EpiSewer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Rt using an approximation of the generative renewal model — R_estimate_approx"><meta name="description" content="This option estimates the effective reproduction number Rt using
an approximation of the generative renewal model. It can be considerably
faster than the fully generative options, but is often less exact. It is
recommended to check the results of this method against a fully generative
version like R_estimate_splines() before using it for real-time R
estimation. See the details for an explanation of the method and its
limitations."><meta property="og:description" content="This option estimates the effective reproduction number Rt using
an approximation of the generative renewal model. It can be considerably
faster than the fully generative options, but is often less exact. It is
recommended to check the results of this method against a fully generative
version like R_estimate_splines() before using it for real-time R
estimation. See the details for an explanation of the method and its
limitations."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiSewer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/model-specification.html">Modeling in EpiSewer</a></li>
    <li><a class="dropdown-item" href="../articles/detailed-example.html">Detailed example</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modeling details</h6></li>
    <li><a class="dropdown-item" href="../articles/model-definition.html">Model definition</a></li>
    <li><a class="dropdown-item" href="../articles/load_per_case.html">The "shedding load per case" assumption</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adrian-lison/EpiSewer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate Rt using an approximation of the generative renewal model</h1>
      <small class="dont-index">Source: <a href="https://github.com/adrian-lison/EpiSewer/blob/main/R/model_infections.R" class="external-link"><code>R/model_infections.R</code></a></small>
      <div class="d-none name"><code>R_estimate_approx.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This option estimates the effective reproduction number Rt using
an approximation of the generative renewal model. It can be considerably
faster than the fully generative options, but is often less exact. It is
recommended to check the results of this method against a fully generative
version like <code><a href="R_estimate_splines.html">R_estimate_splines()</a></code> before using it for real-time R
estimation. See the details for an explanation of the method and its
limitations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">R_estimate_approx</span><span class="op">(</span></span>
<span>  inf_sd_prior_mu <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  inf_sd_prior_sigma <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  inf_smooth <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  inf_trend_smooth <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  inf_trend_dampen <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  knot_distance <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  spline_degree <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  R_window <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  modeldata <span class="op">=</span> <span class="fu"><a href="modeldata_init.html">modeldata_init</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-inf-sd-prior-mu">inf_sd_prior_mu<a class="anchor" aria-label="anchor" href="#arg-inf-sd-prior-mu"></a></dt>
<dd><p>Prior (mean) on the standard deviation of daily
changes in infections. Infection numbers are modeled on the log scale, thus
the standard deviation can be roughly interpreted in terms of percentage
changes. A higher standard deviation will lead to more volatile infections
and more uncertainty in R estimates. The default (<code>inf_sd_prior_mu = 0.05</code>)
allows daily growth/decline rates of up +-10%. We suggest to only decrease
this if you are very certain that the modeled scenario has lower maximum
growth/decline rates, and to increase this if you expect a more extreme
scenario. Note that the smoothness of the infection curve is also
influenced by the exponential smoothing parameters (<code>inf_smooth</code>,
<code>inf_trend_smooth</code>). Still, <code>inf_sd_prior_mu</code> is the primary hyperparameter
to adjust if you think the estimated infection trajectory is too volatile /
not flexible enough.</p></dd>


<dt id="arg-inf-sd-prior-sigma">inf_sd_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-inf-sd-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on standard deviation of
daily changes of infections. This reflects uncertainty around
<code>inf_sd_prior_mu</code>. The default (<code>inf_sd_prior_mu=0.025</code>) allows the
standard deviation to be roughly 0.5 higher or lower than
<code>inf_sd_prior_mu</code>. For the default setting with <code>inf_sd_prior_mu = 0.05</code>,
this means that growth/decline rates of up to +-20% are still supported by
the prior.</p></dd>


<dt id="arg-inf-smooth">inf_smooth<a class="anchor" aria-label="anchor" href="#arg-inf-smooth"></a></dt>
<dd><p>Smoothing parameter (alpha) for infections. The infection
time series is smoothed based on earlier time steps, with exponentially
decaying weights, as controlled by the alpha parameter. The default is 0.5,
<em>smaller</em> values will lead to <em>stronger</em> smoothing, and <em>larger</em> values to
<em>less</em> smoothing.</p></dd>


<dt id="arg-inf-trend-smooth">inf_trend_smooth<a class="anchor" aria-label="anchor" href="#arg-inf-trend-smooth"></a></dt>
<dd><p>Trend smoothing parameter (beta) for infections. The
exponential trend in infections is also smoothed based on the trend over
earlier time steps, with exponentially decaying weights, as controlled by
the beta parameter. Default is 0.5, <em>smaller</em> values will lead to
<em>stronger</em> smoothing of the trend (useful for longer generation times),
and <em>larger</em> values to <em>less</em> smoothing of the trend (useful for shorter
generation times).</p></dd>


<dt id="arg-inf-trend-dampen">inf_trend_dampen<a class="anchor" aria-label="anchor" href="#arg-inf-trend-dampen"></a></dt>
<dd><p>Trend dampening parameter (phi) for infections. The
exponential trend in infections is dampened over time (exponential growth
will not continue for ever). This mainly influences the trend towards the
present. For the default value (0.9), the trend will only roughly half as
strong after two weeks. Note that increasing phi to close to 1 can reduce
sampling speed.</p></dd>


<dt id="arg-knot-distance">knot_distance<a class="anchor" aria-label="anchor" href="#arg-knot-distance"></a></dt>
<dd><p>The infection time series is smoothed using penalized
B-splines. The distance between spline breakpoints (knots) is 7 days by
default. Placing knots further apart increases the smoothness of the
infection time series and can speed up model fitting. Placing knots closer
to each other increases the volatility of the infections. Note however that
the uncertainty of R estimates produced by <code>R_estimate_approx()</code> is also
sensitive to the smoothness of the infection time series, i.e. changing the
knot distance can make the R estimates appear more or less uncertain. This
effect is however rather small since the regularization of the spline
coefficients adjusts for the knot distance.</p></dd>


<dt id="arg-spline-degree">spline_degree<a class="anchor" aria-label="anchor" href="#arg-spline-degree"></a></dt>
<dd><p>Degree of the spline polynomials (default is 3 for cubic
splines).</p></dd>


<dt id="arg-r-window">R_window<a class="anchor" aria-label="anchor" href="#arg-r-window"></a></dt>
<dd><p>Smoothing window size for R estimates. Default is 1 (i.e. no
smoothing). This is provided for compatibility with the EpiEstim method by
Cori et al., which assumes that R stays constant over a certain time
window. However, this can artificially reduce the uncertainty of the R
estimates and is therefore generally not recommended. It also means that R
cannot be estimated up to the present because the smoothing window must be
centered.</p></dd>


<dt id="arg-modeldata">modeldata<a class="anchor" aria-label="anchor" href="#arg-modeldata"></a></dt>
<dd><p>A <code>modeldata</code> object to which the above model specifications
should be added. Default is an empty model given by <code><a href="modeldata_init.html">modeldata_init()</a></code>. Can
also be an already partly specified model returned by other <code>EpiSewer</code>
modeling functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>modeldata</code> object containing data and specifications of the model
to be fitted. Can be passed on to other <code>EpiSewer</code> modeling functions to
add further data and model specifications.</p>
<p>The <code>modeldata</code> object also includes information about parameter
initialization (<code>init</code>), meta data (<code>.metainfo</code>), and checks to be
performed before model fitting (<code>.checks</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This method uses an approximation of the renewal model to estimate
the effective reproduction number. Instead of generating the infections
through a renewal process, the infection time series is estimated using a
non-parametric smoothing prior that mimics the characteristics of a renewal
process. Rt is then computed from the infection time series by applying the
classical renewal equation. This still gives Bayesian estimates of Rt and
the infection time series, but is less exact than a fully generative model.</p>
<p>To smooth the infection time series, penalized B-splines similar to
the ones in <code><a href="R_estimate_splines.html">R_estimate_splines()</a></code> are used, but they are applied to the
expected number of infections on the log scale, not Rt. The spline
coefficients are themselves smoothed using an exponential smoothing prior
with a trend component. The trend component is important as it reflects the
default assumption of constant transmission dynamics that leads to
exponential growth in infections. This ensures consistent results of
<code>R_estimate_approx()</code> also towards the present.</p>
<p>The method can also model infection noise as specified by
<code><a href="infection_noise_estimate.html">infection_noise_estimate()</a></code>. To account for the autocorrelation of
infection noise, a correction that applies the renewal model specifically
to the noise component is used. This correction is most accurate when R is
close to 1 and less accurate when it is far from 1.</p>
<p>The main limitation of <code>R_estimate_approx()</code> is that its priors and
hyperparameters are less interpretable and thus difficult to specify. In
particular the assumed generation time distribution is only used for R
estimation but does not inform the smoothness of the expected infection
time series. Instead, the smoothness is determined by the spline settings
and exponential smoothing parameters, which are difficult to translate into
a generation time assumption. The best approach is therefore to compare
estimates from <code>R_estimate_approx()</code> with those from another method like
<code><a href="R_estimate_splines.html">R_estimate_splines()</a></code> for a pathogen of interest and to carefully adjust
the smoothing hyperparameters if needed.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Rt models:
<code><a href="R_estimate_ets.html">R_estimate_ets</a>()</code>,
<code><a href="R_estimate_rw.html">R_estimate_rw</a>()</code>,
<code><a href="R_estimate_splines.html">R_estimate_splines</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrian Lison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

