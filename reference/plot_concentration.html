<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot predicted concentration — plot_concentration • EpiSewer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot predicted concentration — plot_concentration"><meta name="description" content="Plots measured and/or predicted concentrations over time. The
predicted concentrations are taken from a fitted EpiSewer model."><meta property="og:description" content="Plots measured and/or predicted concentrations over time. The
predicted concentrations are taken from a fitted EpiSewer model."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiSewer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/model-specification.html">Modeling in EpiSewer</a></li>
    <li><a class="dropdown-item" href="../articles/detailed-example.html">Detailed example</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modeling details</h6></li>
    <li><a class="dropdown-item" href="../articles/model-definition.html">Model definition</a></li>
    <li><a class="dropdown-item" href="../articles/load_per_case.html">The "shedding load per case" assumption</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adrian-lison/EpiSewer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot predicted concentration</h1>
      <small class="dont-index">Source: <a href="https://github.com/adrian-lison/EpiSewer/blob/main/R/sewer_plot.R" class="external-link"><code>R/sewer_plot.R</code></a></small>
      <div class="d-none name"><code>plot_concentration.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots measured and/or predicted concentrations over time. The
predicted concentrations are taken from a fitted <code>EpiSewer</code> model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_concentration</span><span class="op">(</span></span>
<span>  results <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  measurements <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  flows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  include_noise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  normalized <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  median <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mark_outliers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  forecast <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  forecast_horizon <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  date_margin_left <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  date_margin_right <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  facet_models <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  facet_direction <span class="op">=</span> <span class="st">"rows"</span>,</span>
<span>  base_model <span class="op">=</span> <span class="st">""</span>,</span>
<span>  model_levels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  concentration_col <span class="op">=</span> <span class="st">"concentration"</span>,</span>
<span>  flow_col <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  date_col <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>  outlier_col <span class="op">=</span> <span class="st">"is_outlier"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  intervals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  obs_size <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  obs_shape <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  obs_forecast_shape <span class="op">=</span> <span class="fl">8</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-results">results<a class="anchor" aria-label="anchor" href="#arg-results"></a></dt>
<dd><p>Results object returned by <code><a href="EpiSewer.html">EpiSewer()</a></code> after model fitting.
Can also be a named <code>list</code> with results from different model runs, in which
case all results are plotted together and distinguished by colors.</p></dd>


<dt id="arg-measurements">measurements<a class="anchor" aria-label="anchor" href="#arg-measurements"></a></dt>
<dd><p>A <code>data.frame</code> with observed measurements, which will be
plotted alongside the predicted values (useful to assess model fit). Can
also be used with <code>results = NULL</code>, in which case only the observed
measurements are plotted.</p></dd>


<dt id="arg-flows">flows<a class="anchor" aria-label="anchor" href="#arg-flows"></a></dt>
<dd><p>A <code>data.frame</code> with observed flows. If <code>normalized = TRUE</code>, this
will be used to normalize the estimated and observed concentrations to the
median flow.</p></dd>


<dt id="arg-include-noise">include_noise<a class="anchor" aria-label="anchor" href="#arg-include-noise"></a></dt>
<dd><p>If <code>TRUE</code> (default), concentrations including
measurement noise are shown. If <code>FALSE</code>, only the expected concentrations
are shown.</p></dd>


<dt id="arg-normalized">normalized<a class="anchor" aria-label="anchor" href="#arg-normalized"></a></dt>
<dd><p>If <code>TRUE</code>, the estimated and observed concentrations are
normalized to the median flow. Thereby, the noise in concentrations that is
due to variation in flow is essentially removed. This is especially useful
for assessing forecasting performance when the future flow values were not
known during model fitting.</p></dd>


<dt id="arg-median">median<a class="anchor" aria-label="anchor" href="#arg-median"></a></dt>
<dd><p>Should the estimated median be shown, or only the credible
intervals? Default is <code>FALSE</code> to avoid over-interpretation of the median.</p></dd>


<dt id="arg-mark-outliers">mark_outliers<a class="anchor" aria-label="anchor" href="#arg-mark-outliers"></a></dt>
<dd><p>If <code>TRUE</code>, outliers in the <code>measurements</code> are
highlighted in red. See also argument <code>outlier_col</code> below.</p></dd>


<dt id="arg-forecast">forecast<a class="anchor" aria-label="anchor" href="#arg-forecast"></a></dt>
<dd><p>Should forecasted concentrations be shown? Default is true.
This requires that the model was fitted with a forecast horizon, see
<code><a href="model_forecast.html">model_forecast()</a></code>. Because concentrations depend on the flow volume,
accurate concentration forecasts are only possible if flow values beyond
the estimation date are provided. This is typically only possible when
estimating retrospectively. If flow values beyond the estimation date are
not available, the forecasted concentrations will be based on the median
flow volume.</p></dd>


<dt id="arg-forecast-horizon">forecast_horizon<a class="anchor" aria-label="anchor" href="#arg-forecast-horizon"></a></dt>
<dd><p>How many days into the future should forecasts be
plotted? Note that this is restricted by the forecast horizon specified
during model fitting, see <code><a href="horizon_assume.html">horizon_assume()</a></code>.</p></dd>


<dt id="arg-date-margin-left">date_margin_left<a class="anchor" aria-label="anchor" href="#arg-date-margin-left"></a></dt>
<dd><p>By how many days into the past should the plot be
expanded? Can also be negative to cut off some of the earliest dates.</p></dd>


<dt id="arg-date-margin-right">date_margin_right<a class="anchor" aria-label="anchor" href="#arg-date-margin-right"></a></dt>
<dd><p>By how many days into the future should the plot be
expanded? Can also be negative to cut off some of the latest dates. By
default, this is 1 to improve the visibility of the latest date.</p></dd>


<dt id="arg-facet-models">facet_models<a class="anchor" aria-label="anchor" href="#arg-facet-models"></a></dt>
<dd><p>Should the plot be faceted by model? Default is <code>FALSE</code>.</p></dd>


<dt id="arg-facet-direction">facet_direction<a class="anchor" aria-label="anchor" href="#arg-facet-direction"></a></dt>
<dd><p>How should the facetting be done? Either in different
"rows" (default) or in different "columns".</p></dd>


<dt id="arg-base-model">base_model<a class="anchor" aria-label="anchor" href="#arg-base-model"></a></dt>
<dd><p>Name of the base model (in the named list provided to
<code>results</code>) which should be compared to the other models. This model will be
plotted in black and will not be part of the legend.</p></dd>


<dt id="arg-model-levels">model_levels<a class="anchor" aria-label="anchor" href="#arg-model-levels"></a></dt>
<dd><p>A <code>character</code> vector with the names of the models to be
included. The colors and legend will be ordered according to the order in
<code>model_levels</code>.</p></dd>


<dt id="arg-concentration-col">concentration_col<a class="anchor" aria-label="anchor" href="#arg-concentration-col"></a></dt>
<dd><p>Name of the column in the measurements <code>data.frame</code>
which contains the measured concentration that should be plotted.</p></dd>


<dt id="arg-date-col">date_col<a class="anchor" aria-label="anchor" href="#arg-date-col"></a></dt>
<dd><p>Name of the date column in the measurements <code>data.frame</code>.</p></dd>


<dt id="arg-outlier-col">outlier_col<a class="anchor" aria-label="anchor" href="#arg-outlier-col"></a></dt>
<dd><p>Name of a logical column in the measurements <code>data.frame</code>
which identifies outlier measurements (for example added by
<code><a href="mark_outlier_spikes_median.html">mark_outlier_spikes_median()</a></code>).</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>If "time" (default), the concentration time series is plotted. If
"pp_check", the observations are ordered by concentration and plotted
against the predicted concentration (useful for posterior predictive
checks).</p></dd>


<dt id="arg-obs-size">obs_size<a class="anchor" aria-label="anchor" href="#arg-obs-size"></a></dt>
<dd><p>Size of the observed concentration points. Default is 1.5.</p></dd>


<dt id="arg-obs-shape">obs_shape<a class="anchor" aria-label="anchor" href="#arg-obs-shape"></a></dt>
<dd><p>Shape of the observed concentration points. Default is 4.</p></dd>


<dt id="arg-obs-forecast-shape">obs_forecast_shape<a class="anchor" aria-label="anchor" href="#arg-obs-forecast-shape"></a></dt>
<dd><p>Shape of the observed concentration points for
forecasted values. Default is 8.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot object showing predicted and observed concentrations over
time. Can be further manipulated using <a href="https://ggplot2.tidyverse.org/reference/ggplot2-package.html" class="external-link">ggplot2</a> functions to adjust themes
and scales, and to add further geoms.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When plotting a posterior predictive check (<code>type="pp_check"</code>), each
observed concentration is shown together with the 95% Credible Interval of
the posterior predictive distribution for that observation. The
observations are ordered by concentration, which helps to visualize bias
and variance of the predictions as a function of the concentration.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrian Lison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

