<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate Rt via exponential smoothing — R_estimate_ets • EpiSewer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Rt via exponential smoothing — R_estimate_ets"><meta name="description" content="This option estimates the effective reproduction number over time
using exponential smoothing. It implements Holt's linear trend method with
dampening through an innovations state space model with a level, trend, and
dampening component."><meta property="og:description" content="This option estimates the effective reproduction number over time
using exponential smoothing. It implements Holt's linear trend method with
dampening through an innovations state space model with a level, trend, and
dampening component."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiSewer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/model-specification.html">Modeling in EpiSewer</a></li>
    <li><a class="dropdown-item" href="../articles/detailed-example.html">Detailed example</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modeling details</h6></li>
    <li><a class="dropdown-item" href="../articles/model-definition.html">Model definition</a></li>
    <li><a class="dropdown-item" href="../articles/load_per_case.html">The "shedding load per case" assumption</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adrian-lison/EpiSewer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate Rt via exponential smoothing</h1>
      <small class="dont-index">Source: <a href="https://github.com/adrian-lison/EpiSewer/blob/develop/R/model_infections.R" class="external-link"><code>R/model_infections.R</code></a></small>
      <div class="d-none name"><code>R_estimate_ets.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This option estimates the effective reproduction number over time
using exponential smoothing. It implements Holt's linear trend method with
dampening through an innovations state space model with a level, trend, and
dampening component.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">R_estimate_ets</span><span class="op">(</span></span>
<span>  level_prior_mu <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  level_prior_sigma <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  trend_prior_mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  trend_prior_sigma <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  sd_prior_mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sd_prior_sigma <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  sd_changepoint_dist <span class="op">=</span> <span class="fl">7</span> <span class="op">*</span> <span class="fl">26</span>,</span>
<span>  sd_changepoint_sd <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  link <span class="op">=</span> <span class="st">"inv_softplus"</span>,</span>
<span>  R_max <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  smooth_prior_mu <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  smooth_prior_sigma <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  trend_smooth_prior_mu <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  trend_smooth_prior_sigma <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  dampen_prior_mu <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  dampen_prior_sigma <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  differenced <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  noncentered <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  modeldata <span class="op">=</span> <span class="fu"><a href="modeldata_init.html">modeldata_init</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-level-prior-mu">level_prior_mu<a class="anchor" aria-label="anchor" href="#arg-level-prior-mu"></a></dt>
<dd><p>Prior (mean) on the initial level of Rt.</p></dd>


<dt id="arg-level-prior-sigma">level_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-level-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the initial level of
Rt.</p></dd>


<dt id="arg-trend-prior-mu">trend_prior_mu<a class="anchor" aria-label="anchor" href="#arg-trend-prior-mu"></a></dt>
<dd><p>Prior (mean) on the initial trend of Rt.</p></dd>


<dt id="arg-trend-prior-sigma">trend_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-trend-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the initial trend of
Rt.</p></dd>


<dt id="arg-sd-prior-mu">sd_prior_mu<a class="anchor" aria-label="anchor" href="#arg-sd-prior-mu"></a></dt>
<dd><p>Prior (mean) on the standard deviation of the innovations.</p></dd>


<dt id="arg-sd-prior-sigma">sd_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-sd-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the standard deviation of
the innovations. Please note that for consistency the overall prior on the
standard deviation of innovations will have a standard deviation of
<code>sd_prior_sigma + sd_changepoint_sd</code> even if no changepoints are modeled
(see below).</p></dd>


<dt id="arg-sd-changepoint-dist">sd_changepoint_dist<a class="anchor" aria-label="anchor" href="#arg-sd-changepoint-dist"></a></dt>
<dd><p>The variability of Rt can change over time, e.g.
during the height of an epidemic wave, countermeasures may lead to much
faster changes in Rt than observable at other times. This potential
variability is accounted for using change points placed at regular
intervals. The standard deviation of the state space model innovations then
evolves linearly between the change points. The default change point
distance is 26 weeks (182 days). Short changepoint distances (e.g. 4 weeks
or less) must be chosen with care, as they can make the Rt time series too
flexible. If set to zero, no change points are modeled.</p></dd>


<dt id="arg-sd-changepoint-sd">sd_changepoint_sd<a class="anchor" aria-label="anchor" href="#arg-sd-changepoint-sd"></a></dt>
<dd><p>This parameter controls the variability of the change
points. When change points are modeled, EpiSewer will estimate a baseline
standard deviation (see <code>sd_prior_mu</code> and <code>sd_prior_sigma</code>), and model
change point values as independently distributed with mean equal to this
baseline and standard deviation <code>sd_changepoint_sd</code>.</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>Link function. Currently supported are <code>inv_softplus</code> (default)
and <code>scaled_logit</code>. Both of these links are configured to behave
approximately like the identity function around R=1, but become increasingly
non-linear below (and in the case of <code>scaled_logit</code> also above) R=1.</p></dd>


<dt id="arg-r-max">R_max<a class="anchor" aria-label="anchor" href="#arg-r-max"></a></dt>
<dd><p>If <code>link=scaled_logit</code> is used, a maximum reproduction number
must be assumed. This should be higher than any realistic R value for the
modeled pathogen. Default is 6.</p></dd>


<dt id="arg-smooth-prior-mu">smooth_prior_mu<a class="anchor" aria-label="anchor" href="#arg-smooth-prior-mu"></a></dt>
<dd><p>Prior (mean) on the smoothing parameter. Must be
between 0 and 1.</p></dd>


<dt id="arg-smooth-prior-sigma">smooth_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-smooth-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the smoothing
parameter. If this is set to zero, the smoothing parameter will be fixed to
<code>smooth_prior_mu</code> and not estimated. If positive, a beta prior with the
corresponding mean and standard deviation is used.</p></dd>


<dt id="arg-trend-smooth-prior-mu">trend_smooth_prior_mu<a class="anchor" aria-label="anchor" href="#arg-trend-smooth-prior-mu"></a></dt>
<dd><p>Prior (mean) on the trend smoothing parameter.
Must be between 0 and 1.</p></dd>


<dt id="arg-trend-smooth-prior-sigma">trend_smooth_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-trend-smooth-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the trend
smoothing parameter. If this is set to zero, the trend smoothing parameter
will be fixed to <code>trend_smooth_prior_mu</code> and not estimated. If positive, a
beta prior with the corresponding mean and standard deviation is used.</p></dd>


<dt id="arg-dampen-prior-mu">dampen_prior_mu<a class="anchor" aria-label="anchor" href="#arg-dampen-prior-mu"></a></dt>
<dd><p>Prior (mean) on the dampening parameter. Must be
between 0 and 1.</p></dd>


<dt id="arg-dampen-prior-sigma">dampen_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-dampen-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the dampening
parameter. If this is set to zero, the dampening parameter will be fixed to
<code>dampen_prior_mu</code> and not estimated. If positive, a beta prior with the
corresponding mean and standard deviation is used.</p></dd>


<dt id="arg-differenced">differenced<a class="anchor" aria-label="anchor" href="#arg-differenced"></a></dt>
<dd><p>If <code>FALSE</code> (default), exponential smoothing is applied to
the absolute Rt time series. If <code>TRUE</code>, it is instead applied to the
differenced time series. This makes the level become the trend, and the
trend become the curvature.</p></dd>


<dt id="arg-noncentered">noncentered<a class="anchor" aria-label="anchor" href="#arg-noncentered"></a></dt>
<dd><p>If <code>TRUE</code> (default), a non-centered parameterization is
used to model the innovations in the state space process (for better
sampling efficiency).</p></dd>


<dt id="arg-modeldata">modeldata<a class="anchor" aria-label="anchor" href="#arg-modeldata"></a></dt>
<dd><p>A <code>modeldata</code> object to which the above model specifications
should be added. Default is an empty model given by <code><a href="modeldata_init.html">modeldata_init()</a></code>. Can
also be an already partly specified model returned by other <code>EpiSewer</code>
modeling functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>modeldata</code> object containing data and specifications of the model
to be fitted. Can be passed on to other <code>EpiSewer</code> modeling functions to
add further data and model specifications.</p>
<p>The <code>modeldata</code> object also includes information about parameter
initialization (<code>init</code>), meta data (<code>.metainfo</code>), and checks to be
performed before model fitting (<code>.checks</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The innovations state space model consists of three components: a
level, a trend, and a dampening component.</p><ul><li><p>The level is smoothed based on the levels from earlier time steps,
with exponentially decaying weights, as controlled by a smoothing parameter
(often called alpha). Note that <em>smaller</em> values of <code>alpha</code> indicate
<em>stronger</em> smoothing. In particular, <code>alpha = 1</code> means that only the last
level is used.</p></li>
<li><p>The trend is smoothed based on the trends from earlier time steps,
with exponentially decaying weights, as controlled by a trend smoothing
parameter (often called beta). Note that <em>smaller</em> values of <code>beta</code> indicate
<em>stronger</em> smoothing. In particular, <code>beta = 1</code> means that only the last
trend is used.</p></li>
<li><p>The dampening determines how long a previous trend continues into the
future before it levels of to a stationary time series. The strength of
dampening is controlled by a dampening parameter (often called phi). Note
that <em>smaller</em> values of <code>phi</code> indicate <em>stronger</em> dampening. In particular,
<code>phi = 1</code> means no dampening. Values below <code>phi = 0.8</code> are seldom in
practice as the dampening becomes very strong.</p></li>
</ul><p>Often, <code>alpha</code>, <code>beta</code>, and <code>phi</code> are jointly unidentifiable. It may
therefore be necessary to fix at least one of the parameters (typically
<code>phi</code>) or supply strong priors.</p>
<p>Note that the smoothness of retrospective Rt estimates is often more
influenced by the prior on the standard deviation of innovations than the
smoothing and trend smoothing parameters. The smoothing parameters mostly
have an influence on estimates close to the present / date of estimation,
when limited data signal is available. Here, the standard deviation of the
innovations influences how uncertain Rt estimates are close to the present.</p>
<p>The priors of this component have the following functional form:</p><ul><li><p>initial level of Rt: <code>Normal</code></p></li>
<li><p>initial trend of Rt: <code>Normal</code></p></li>
<li><p>standard deviation of innovations: <code>Truncated normal</code></p></li>
<li><p>smoothing parameter: <code>Beta</code></p></li>
<li><p>trend smoothing parameter: <code>Beta</code></p></li>
<li><p>dampening parameter: <code>Beta</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Rt models:
<code><a href="R_estimate_approx.html">R_estimate_approx</a>()</code>,
<code><a href="R_estimate_rw.html">R_estimate_rw</a>()</code>,
<code><a href="R_estimate_splines.html">R_estimate_splines</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrian Lison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

