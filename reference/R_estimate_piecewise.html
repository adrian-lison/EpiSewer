<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate Rt via piecewise constant changepoint model — R_estimate_piecewise • EpiSewer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Rt via piecewise constant changepoint model — R_estimate_piecewise"><meta name="description" content="This option models the effective reproduction number Rt over
time as a piecewise constant function. The changepoints of the constant
pieces are estimated from the data using an approximate changepoint model.
This option is suitable when Rt follows a step-like trajectory with
occasional large jumps, e.g. due to strong interventions. It is less
suitable for modeling gradual changes in Rt over time."><meta property="og:description" content="This option models the effective reproduction number Rt over
time as a piecewise constant function. The changepoints of the constant
pieces are estimated from the data using an approximate changepoint model.
This option is suitable when Rt follows a step-like trajectory with
occasional large jumps, e.g. due to strong interventions. It is less
suitable for modeling gradual changes in Rt over time."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiSewer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/model-specification.html">Modeling in EpiSewer</a></li>
    <li><a class="dropdown-item" href="../articles/detailed-example.html">Detailed example</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modeling details</h6></li>
    <li><a class="dropdown-item" href="../articles/model-definition.html">Model definition</a></li>
    <li><a class="dropdown-item" href="../articles/load_per_case.html">The "shedding load per case" assumption</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adrian-lison/EpiSewer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate Rt via piecewise constant changepoint model</h1>
      <small class="dont-index">Source: <a href="https://github.com/adrian-lison/EpiSewer/blob/v0.0.4/R/model_infections.R" class="external-link"><code>R/model_infections.R</code></a></small>
      <div class="d-none name"><code>R_estimate_piecewise.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This option models the effective reproduction number Rt over
time as a piecewise constant function. The changepoints of the constant
pieces are estimated from the data using an approximate changepoint model.
This option is suitable when Rt follows a step-like trajectory with
occasional large jumps, e.g. due to strong interventions. It is less
suitable for modeling gradual changes in Rt over time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">R_estimate_piecewise</span><span class="op">(</span></span>
<span>  R_start_prior_mu <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  R_start_prior_sigma <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  changepoint_max_distance <span class="op">=</span> <span class="fl">14</span>,</span>
<span>  changepoint_min_distance <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  change_prior_shape <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  change_prior_scale <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  change_tolerance <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  link <span class="op">=</span> <span class="st">"inv_softplus"</span>,</span>
<span>  R_max <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  strictness_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  modeldata <span class="op">=</span> <span class="fu"><a href="modeldata_init.html">modeldata_init</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-r-start-prior-mu">R_start_prior_mu<a class="anchor" aria-label="anchor" href="#arg-r-start-prior-mu"></a></dt>
<dd><p>Prior (mean) on the initial reproduction number
(intercept).</p></dd>


<dt id="arg-r-start-prior-sigma">R_start_prior_sigma<a class="anchor" aria-label="anchor" href="#arg-r-start-prior-sigma"></a></dt>
<dd><p>Prior (standard deviation) on the initial
reproduction number (intercept).</p></dd>


<dt id="arg-changepoint-max-distance">changepoint_max_distance<a class="anchor" aria-label="anchor" href="#arg-changepoint-max-distance"></a></dt>
<dd><p>Maximum distance between changepoints in
days. This setting guarantees that two consecutive changes in Rt can be
captured if they are <code>changepoint_max_distance</code> days or more apart. Faster
changes are not guaranteed to be captured.</p></dd>


<dt id="arg-changepoint-min-distance">changepoint_min_distance<a class="anchor" aria-label="anchor" href="#arg-changepoint-min-distance"></a></dt>
<dd><p>Minimum distance between changepoints in
days. This setting guarantees that two consecutive changes in Rt are at
least <code>changepoint_min_distance</code> days apart. This avoids Rt trajectories
that are unrealistically volatile. For example, a minimum distance of 7
implies that you don't expect Rt to make more than one large jump within a
week.</p></dd>


<dt id="arg-change-prior-shape">change_prior_shape<a class="anchor" aria-label="anchor" href="#arg-change-prior-shape"></a></dt>
<dd><p>Exponential-Gamma (EG) prior (shape) for the
strength of changes between the pieces. At each estimated changepoint, the
change in Rt is sampled from a normal distribution with standard deviation
given by the EG prior. This prior has a strong peak towards zero and a long
tail. In other words, while most changes are expected to be small, the
prior allows for occasional large jumps in Rt. Smaller shape parameters
will lead to more sparseness, i.e. a longer tail. Note that when adjusting
the shape, you will likely also have to adjust the scale. See details for
more advice on choosing a suitable prior.</p></dd>


<dt id="arg-change-prior-scale">change_prior_scale<a class="anchor" aria-label="anchor" href="#arg-change-prior-scale"></a></dt>
<dd><p>Exponential-Gamma (EG) prior (scale) for the
strength of changes between the pieces. See <code>change_prior_shape</code> above for
an explanation. Larger scales will lead to more variability: a doubling of
the scale roughly corresponds to a doubling of all quantiles of the prior.</p></dd>


<dt id="arg-change-tolerance">change_tolerance<a class="anchor" aria-label="anchor" href="#arg-change-tolerance"></a></dt>
<dd><p>Tolerance for "negligible" changes in Rt. Changes
smaller than <code>change_tolerance</code> are ignored by <code>changepoint_min_distance</code>,
i.e. they can also occur closer to each other. This tolerance gives the
model more flexibility in placing changepoints with large jumps.</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>Link function. Currently supported are <code>inv_softplus</code> (default)
and <code>scaled_logit</code>. Both of these links are configured to behave
approximately like the identity function around R=1, but become increasingly
non-linear below (and in the case of <code>scaled_logit</code> also above) R=1.</p></dd>


<dt id="arg-r-max">R_max<a class="anchor" aria-label="anchor" href="#arg-r-max"></a></dt>
<dd><p>If <code>link=scaled_logit</code> is used, a maximum reproduction number
must be assumed. This should be higher than any realistic R value for the
modeled pathogen. Default is 6.</p></dd>


<dt id="arg-strictness-alpha">strictness_alpha<a class="anchor" aria-label="anchor" href="#arg-strictness-alpha"></a></dt>
<dd><p>The concentration parameter of the Dirichlet prior
for the changepoint positions. Choosing smaller values of
<code>strictness_alpha</code> will lead to more discrete changepoints. Note that
choosing small values of <code>strictness_alpha</code> can impede MCMC sampling.</p></dd>


<dt id="arg-modeldata">modeldata<a class="anchor" aria-label="anchor" href="#arg-modeldata"></a></dt>
<dd><p>A <code>modeldata</code> object to which the above model specifications
should be added. Default is an empty model given by <code><a href="modeldata_init.html">modeldata_init()</a></code>. Can
also be an already partly specified model returned by other <code>EpiSewer</code>
modeling functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>modeldata</code> object containing data and specifications of the model
to be fitted. Can be passed on to other <code>EpiSewer</code> modeling functions to
add further data and model specifications.</p>
<p>The <code>modeldata</code> object also includes information about parameter
initialization (<code>.init</code>), meta data (<code>.metainfo</code>), and checks to be
performed before model fitting (<code>.checks</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Exponential-Gamma (EG) prior on the strength of changes is
parameterized via the arguments <code>change_prior_shape</code> and
<code>change_prior_scale</code>. It has a long tail to support large changes while
keeping the variation low most of the time. The default configuration
should work well in most contexts except for really extreme changes in Rt
over a short time window. To check the quantiles of your prior, you can use
the function <code><a href="qexpgamma.html">qexpgamma()</a></code> with corresponding shape and scale parameters.</p>
<p>If you need to adjust the overall variation, you can adjust the
<code>change_prior_scale</code> parameter. A doubling of the scale roughly corresponds
to a doubling of the quantiles. For example, when the 95% quantile is 0.2
for a given scale and you double that scale, the 95% quantile will be at
0.4.</p>
<p>If you need to support more extreme changes, you can decrease the
<code>change_prior_shape</code> parameter, which will emphasize the long-tail behavior
of the prior. Note however that this will substantially increase all
quantiles of the prior, so you will also have to decrease the scale
parameter to achieve a similar level of day-to-day variation.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Rt models:
<code><a href="R_estimate_approx.html">R_estimate_approx()</a></code>,
<code><a href="R_estimate_changepoint_splines.html">R_estimate_changepoint_splines()</a></code>,
<code><a href="R_estimate_ets.html">R_estimate_ets()</a></code>,
<code><a href="R_estimate_gp.html">R_estimate_gp()</a></code>,
<code><a href="R_estimate_rw.html">R_estimate_rw()</a></code>,
<code><a href="R_estimate_smooth_derivative.html">R_estimate_smooth_derivative()</a></code>,
<code><a href="R_estimate_splines.html">R_estimate_splines()</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrian Lison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer></div>





  </body></html>

